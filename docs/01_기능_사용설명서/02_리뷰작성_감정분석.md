# 📝 리뷰작성 기능 가이드

<<<<<<< HEAD
> 최종 업데이트: 2025년 11월 2일  
=======
> 최종 업데이트: 2025년 11월 18일  
>>>>>>> 2a567e81215913201059f9d99e44f40781f95bd2
> 기능명: 리뷰작성 (AI 리뷰 답글 자동 생성)

---

## 📋 기능 개요

**리뷰작성**은 고객 리뷰를 AI가 자동으로 분석하고 전문적인 답글을 생성하는 기능입니다.

### 🎯 핵심 기능
- 고객 리뷰 자동 분석
- 감정 분석 (긍정/부정/중립)
- AI 답글 자동 생성
- 브랜드 이미지 관리
- 리뷰 응답 시간 단축

### 👥 대상 사용자
- 음식점 대표/직원
- 온라인 스토어 운영자
- 카페/바/호스텔 운영자

---

## 🔧 기술 스택

### 프론트엔드
- `review.html` - 사용자 인터페이스
- React/Vue 상태 관리
- 차트 라이브러리 (리뷰 통계)

### 백엔드
- Express.js 서버
- OpenAI GPT API (감정 분석 및 답글 생성)
- Supabase (리뷰 데이터 저장)

### AI/ML
- GPT-4 - 답글 생성
- 감정분석 모델 - 긍정/부정 판별

---

## 📁 파일 구조

```
프로젝트루트/
├── review.html (메인 페이지)
├── server.js (백엔드 라우팅)
├── api/
│   └── review-handler.js (리뷰 처리 API)
└── assets/
    ├── common-header.js
    └── common-styles.css
```

---

## 🔌 API 엔드포인트

### 1. 리뷰 분석 및 답글 생성
**POST** `/api/review/analyze-and-respond`

#### 요청
```json
{
  "review": "음식이 정말 맛있었어요! 강추합니다.",
  "storeName": "홍콩반점",
  "reviewSource": "naver",
  "reviewDate": "2025-11-02"
}
```

#### 응답
```json
{
  "success": true,
  "data": {
    "sentiment": "positive",
    "score": 0.95,
    "generatedResponse": "소중한 후기 감사합니다! 저희 음식이 맛있다니...",
    "keywords": ["맛있음", "강추"],
    "suggestedTone": "친근하고 고마운"
  }
}
```

### 2. 리뷰 목록 조회
**GET** `/api/review/list?status=pending`

#### 응답
```json
{
  "success": true,
  "data": [
    {
      "id": "review_001",
      "review": "음식 좀 짜네요",
      "sentiment": "negative",
      "status": "pending",
      "createdAt": "2025-11-02"
    }
  ]
}
```

---

## 💻 사용 방법

### 1. 페이지 접속
```
http://localhost:3003/review.html
```

### 2. 리뷰 입력
- 고객 리뷰 복사/붙여넣기
- 또는 직접 타이핑
- 가게명 입력

### 3. AI 분석 요청
- "AI 답글 생성" 버튼 클릭
- 감정 분석 및 답글 생성 시작

### 4. 결과 확인
- 감정 분석 결과 (긍정/부정/중립)
- 신뢰도 점수 확인
- 생성된 답글 검토

### 5. 답글 발행
- 필요시 답글 수정
- "발행하기" 버튼 클릭
- 플랫폼별로 자동 등록 (추후)

---

## 📊 감정분석 결과

### 감정 유형
```
POSITIVE  (긍정)  - "좋아요", "맛있어요", "강추"
NEGATIVE  (부정)  - "별로", "별로예요", "실망"
NEUTRAL   (중립)  - "평범해요", "일반적"
```

### 신뢰도 점수
```
0.9 ~ 1.0  - 매우 높음 (95% 이상 확신)
0.7 ~ 0.9  - 높음 (70% 이상 확신)
0.5 ~ 0.7  - 보통 (50% 이상 확신)
```

---

## 🤖 AI 답글 생성 프롬프트

### 긍정 리뷰 (POSITIVE)
```
소중한 후기 감사합니다! 
저희 [메뉴명]이 맛있다니 기쁩니다.
다음에도 더 맛있는 음식으로 보답하겠습니다.
감사합니다!
```

### 부정 리뷰 (NEGATIVE)
```
소중한 의견 감사합니다.
저희 음식이 기대 이하였다니 정말 죄송합니다.
말씀하신 부분을 개선하기 위해 노력하겠습니다.
다음 방문시 더 나은 경험을 드리겠습니다.
```

---

## 💡 활용 팁

### 🍽️ 식당 운영
1. **매일 아침 체크**
   - 전날 리뷰 확인
   - AI 답글 생성 및 발행
   - 고객 피드백 수집

2. **부정 리뷰 대응**
   - 빠른 응답 (3시간 내)
   - 진지한 태도 표현
   - 개선 약속 명시

3. **긍정 리뷰 활용**
   - 감사 인사
   - 재방문 유도
   - 입소문 활용

### 📈 평판 관리
- 리뷰 응답률 ↑
- 평점 상향
- 신뢰도 증가

---

## 🔐 환경변수 설정

```env
OPENAI_API_KEY=sk-xxxxx
NEXT_PUBLIC_SUPABASE_URL=https://xxxxx.supabase.co
SUPABASE_SERVICE_ROLE_KEY=xxxxx
```

---

## 📋 리뷰 처리 프로세스

```
고객 리뷰 입력
    ↓
감정분석 (Sentiment Analysis)
    ↓
키워드 추출
    ↓
AI 답글 생성 (GPT-4)
    ↓
신뢰도 점수 계산
    ↓
사용자 검수
    ↓
답글 발행
```

---

## ⚠️ 주의사항

1. **AI 생성 답글 검증**
   - 항상 최종 검수 필요
   - 과도한 약속 금지
   - 사실 정보만 제공

2. **개인정보 보호**
   - 고객명 익명 처리
   - 민감한 정보 제거
   - GDPR 준수

3. **톤앤매너**
   - 브랜드 톤 유지
   - 과도한 감정 표현 금지
   - 전문성 유지

---

## 🔄 향후 개선 계획

- [ ] 플랫폼별 자동 발행 (네이버, 쿠팡, 당근마켓)
- [ ] 리뷰 트렌드 분석
- [ ] 자동 응답 스케줄링
- [ ] 다국어 지원 (영어, 중국어)
- [ ] 리뷰 평점 트렌드 그래프

---

## 📞 트러블슈팅

### Q: 감정분석이 잘못되었어요
**A**: 맥락 확인
- 반어/비유 확인
- AI 재분석 시도
- 수동 수정 가능

### Q: 답글이 이상해요
**A**: 다시 생성 시도
- "답글 재생성" 버튼 클릭
- 수정 기능 활용
- 매뉴얼 작성 권장

---

<<<<<<< HEAD
=======
## 📝 업데이트 내역

### v1.1.0 (2025년 11월 18일) ✨

#### 🎯 추천 포인트 저장/불러오기 기능 개선

**1. UI/UX 개선**
- ✅ 알림 문구 변경: "가게 정보" → "추천 포인트"
- ✅ 버튼 텍스트 변경:
  - "저장된 정보 불러오기" → "저장된 포인트 불러오기"
  - "가게 정보 저장하기" → "추천 포인트 저장하기"
- ✅ AI 홍보 포인트 자동 추천 버튼 제거 (단순화)

**2. 저장 기능 강화**
- ✅ 로그인 체크 활성화 (비로그인 시 안내 메시지)
- ✅ 빈 내용 저장 방지 (validation 추가)
- ✅ 저장 중 로딩 상태 표시
- ✅ 저장 성공 시 버튼 시각적 피드백 (2초간 초록색)
- ✅ 상세한 성공/실패 메시지 제공

**3. 불러오기 기능 강화**
- ✅ 불러오는 중 로딩 상태 표시
- ✅ 불러온 항목 상세 안내 (URL, 추천 포인트 목록)
- ✅ 불러오기 성공 시 버튼 시각적 피드백 (2초간 초록색)
- ✅ 저장된 정보 없을 때 친절한 안내 메시지

**4. 백엔드 API 개선**
- ✅ `/api/store-info-all` 엔드포인트 추가
- ✅ profiles + store_promotions 통합 조회 기능
- ✅ 상세한 서버 로그 추가 (디버깅 용이)

**5. 데이터 구조**
```javascript
// 저장 데이터 구조
{
  userId: "user-id",
  storeInfo: {
    placeUrl: "네이버 플레이스 URL",
    keywords: "사장님 추천 포인트"
  }
}

// 응답 데이터 구조
{
  success: true,
  data: {
    basic: {
      store_place_url: "...",
      store_keywords: "..."
    },
    promotion: {...}
  },
  hasPromotion: boolean,
  filledCount: number
}
```

**6. 사용자 경험 개선**
| 항목 | 기존 | 개선 후 |
|------|------|---------|
| 로그인 체크 | ❌ | ✅ |
| 저장 중 표시 | ❌ | ✅ 로딩 스피너 |
| 빈 내용 저장 | ✅ 가능 | ❌ 방지 |
| 버튼 피드백 | ❌ | ✅ 초록색 깜빡임 |
| 에러 메시지 | ❌ 단순 | ✅ 상세 안내 |
| 성공 메시지 | ❌ 단순 | ✅ 불러온 항목 표시 |

---

### 주요 파일 변경사항

**프론트엔드**
- `AI-Review.html`: 저장/불러오기 UI 및 로직 개선

**백엔드**
- `server.js`: `/api/store-info-all` 엔드포인트 추가

---

### 테스트 방법

1. https://sajangpick.co.kr/AI-Review.html 접속
2. 로그인
3. "사장님 추천 포인트" 입력
4. "📌 추천 포인트 저장하기" 클릭 → 버튼이 2초간 초록색으로 변경
5. 홈으로 이동 후 다시 리뷰 탭으로 이동
6. "📥 저장된 포인트 불러오기" 클릭
7. ✅ 저장한 내용이 자동으로 입력되는지 확인

---

>>>>>>> 2a567e81215913201059f9d99e44f40781f95bd2
> 💡 좋은 리뷰 관리는 고객 만족도 향상과 평판 관리의 핵심입니다!
