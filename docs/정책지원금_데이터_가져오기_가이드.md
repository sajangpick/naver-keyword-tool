# 정책지원금 실제 데이터 가져오기 가이드

## 🎯 현재 상황

관리자 페이지에서 정책 데이터가 0개로 표시되고 있습니다. 실제 정부 데이터를 가져와서 데이터베이스에 저장해야 합니다.

## 📋 단계별 가이드

### 1단계: 서버 실행 확인

터미널에서 서버가 실행 중인지 확인하세요:

```bash
# 서버 실행 중인지 확인
# 포트 5000 또는 3003에서 실행되어야 합니다
```

서버가 실행되지 않았다면:
```bash
node server.js
```

### 2단계: 관리자 로그인 확인

1. 관리자 계정으로 로그인되어 있는지 확인
2. 콘솔에 "Supabase client not ready" 경고가 있어도 데이터 가져오기는 작동합니다

### 3단계: 실제 데이터 가져오기

1. 관리자 페이지에서 **빨간색 "실제 데이터 가져오기"** 버튼 클릭
2. 확인 메시지에서 "확인" 클릭
3. 진행 상황 확인:
   - "API에서 데이터 수집 중..."
   - "데이터 저장 중... (1/15)"
   - "데이터 수집 완료!"

### 4단계: 결과 확인

1. 통계 카드가 업데이트되는지 확인
2. 정책 목록에 데이터가 표시되는지 확인
3. 사용자 페이지(`/policy-support.html`)에서도 확인

## 🔍 문제 해결

### 문제 1: "데이터 수집 실패"

**원인:**
- 서버가 실행되지 않음
- API 키 문제
- 네트워크 오류

**해결:**
1. 서버 콘솔에서 에러 메시지 확인
2. 브라우저 개발자 도구 → Network 탭에서 API 호출 확인
3. API 응답 상태 코드 확인

### 문제 2: "수집된 정책 데이터가 없습니다"

**원인:**
- API에서 데이터를 가져오지 못함
- 필터링 조건에 맞는 데이터가 없음

**해결:**
1. 서버 콘솔에서 로그 확인:
   ```
   🔑 API 키 사용: e45b26951...
   ✅ XML 응답 파싱 완료: X개 항목
   ✅ 총 X개의 실제 정책 데이터를 가져왔습니다.
   ```
2. API 키가 올바른지 확인
3. 공공데이터포털 API 상태 확인

### 문제 3: "저장 실패"

**원인:**
- 인증 토큰 만료
- 데이터베이스 연결 오류
- 필수 필드 누락

**해결:**
1. 관리자 로그아웃 후 다시 로그인
2. Supabase 연결 확인
3. 콘솔에서 상세 에러 확인

## 📊 예상 결과

정상 작동 시:
- **수집된 정책**: 15~120개 (실시간 변동)
- **새로 추가**: 10~50개 (중복 제외)
- **건너뜀**: 중복 또는 오류 항목

## 🚀 빠른 테스트

브라우저 콘솔에서 직접 테스트:

```javascript
// 1. API 호출 테스트
fetch('http://localhost:5000/api/fetch-real-policies', {
  method: 'POST',
  headers: {'Content-Type': 'application/json'},
  body: JSON.stringify({ save: false })
})
.then(res => res.json())
.then(data => {
  console.log('수집된 정책 수:', data.count);
  console.log('정책 목록:', data.data);
});
```

## ✅ 체크리스트

데이터 가져오기 전 확인:
- [ ] 서버가 실행 중인가? (`node server.js`)
- [ ] 관리자 계정으로 로그인했는가?
- [ ] 브라우저 콘솔에 에러가 없는가?
- [ ] 네트워크 연결이 정상인가?

## 💡 팁

1. **첫 실행 시**: 내장된 6개 샘플 데이터가 백업으로 사용됩니다
2. **재실행 시**: 중복 체크로 이미 있는 데이터는 건너뜁니다
3. **로그 확인**: 서버 콘솔에서 상세한 진행 상황을 확인할 수 있습니다

## 📞 다음 단계

데이터를 성공적으로 가져왔다면:
1. 사용자 페이지(`/policy-support.html`)에서 확인
2. 정책 상세 정보 확인
3. 검색 및 필터 기능 테스트

