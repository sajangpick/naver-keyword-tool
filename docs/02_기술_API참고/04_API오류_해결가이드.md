# 🚨 API 연결 오류 해결 가이드

> 404 오류 및 API 연결 문제 해결  
> 최종 업데이트: 2025년 11월 8일

---

## 🔴 문제: 404 오류 발생

### 원인 분석

**404 오류는 서버가 실행되지 않아서 발생합니다.**

프론트엔드(`127.0.0.1:5501`)는 `http://localhost:3003/api/related-keywords`로 API를 호출하지만,
서버가 실행되지 않으면 연결할 수 없어 404 오류가 발생합니다.

```
사용자가 naver_search.html 접속
    ↓
"연관키워드 검색" 버튼 클릭
    ↓
프론트엔드가 /api/related-keywords 호출
    ↓
localhost:3003으로 요청
    ↓
❌ 서버 미실행 → 404 오류!
```

---

## ✅ 해결 방법 (단계별)

### **1단계: 서버 실행하기**

#### 방법 1: 배치 파일 사용 (가장 쉬움) ⭐

1. 프로젝트 폴더에서 **`서버시작.bat`** 파일을 찾으세요
2. **더블클릭**하여 실행하세요
3. 검은색 터미널 창이 열립니다
4. 다음과 같은 메시지가 보이면 성공입니다:
   ```
   🚀 통합 API 서버가 시작되었습니다!
   🌐 서버 주소: http://0.0.0.0:3003
   ```

#### 방법 2: 터미널에서 직접 실행

1. **Windows 키 + R**을 누르세요
2. `cmd`를 입력하고 Enter를 누르세요
3. 프로젝트 폴더로 이동:
   ```
   cd "C:\Users\사용자이름\Desktop\sajangpick"
   ```
4. 서버 실행:
   ```
   node server.js
   ```

#### 방법 3: VS Code에서 실행

1. VS Code에서 프로젝트 폴더 열기
2. 터미널 열기: `Ctrl + `` ` (백틱)
3. 명령어 입력:
   ```bash
   node server.js
   ```

---

### **2단계: 서버 실행 확인**

브라우저에서 다음 URL을 열어보세요:
```
http://localhost:3003/health
```

**✅ 성공 시:**
```json
{
  "status": "OK",
  "message": "통합 API 서버가 정상 작동 중입니다."
}
```

**❌ 실패 시:**
```
사이트에 연결할 수 없습니다
또는
ERR_CONNECTION_REFUSED
```
→ 서버가 실행되지 않은 것입니다. 1단계를 다시 확인하세요.

---

### **3단계: API 테스트**

브라우저에서 다음 URL을 열어보세요:
```
http://localhost:3003/api/related-keywords?seed=테스트
```

**✅ 성공 시:**
- JSON 응답이 보입니다
- (네이버 API 키가 설정되어 있어야 함)

**❌ 실패 시:**
- **404 오류** → 서버가 실행되지 않았거나 API 엔드포인트가 등록되지 않음
- **500 오류** → 네이버 API 키가 설정되지 않았을 가능성
- **연결 거부** → 서버가 종료됨

---

### **4단계: 프론트엔드에서 테스트**

서버가 실행된 상태에서:

1. `naver_search.html` 페이지를 **새로고침**하세요 (F5)
2. **"연관키워드"** 탭을 클릭하세요
3. 키워드를 입력하고 **"연관 키워드 검색"** 버튼을 클릭하세요
4. 이제 정상 작동해야 합니다! ✅

---

## ⚠️ 중요 사항

### 서버 실행 중 유지

**❌ 절대 하면 안 됨:**
- 서버를 실행한 터미널 창을 닫지 마세요!
- 터미널 창을 닫으면 서버가 즉시 종료됩니다
- 서버가 종료되면 다시 404 오류가 발생합니다

**✅ 올바른 방법:**
- 서버를 사용하는 동안은 **반드시 터미널을 열어둬야** 합니다
- 다른 작업을 할 때도 터미널은 백그라운드에서 실행 유지

---

### 서버 종료 방법

서버를 완전히 종료하고 싶을 때만:
```bash
터미널 창에서 Ctrl + C
```

---

### 여러 개의 서버 실행 방지

**❌ 절대 하면 안 됨:**
- 서버는 한 번에 하나만 실행해야 합니다
- 이미 실행 중인 서버가 있으면 새로 실행하지 마세요
- 포트 충돌이 발생할 수 있습니다

**✅ 올바른 방법:**
1. 기존 서버 확인 (터미널 창 검색)
2. 없으면 새로 시작
3. 있으면 그 창을 사용

---

## 🔍 문제 해결 체크리스트

### 기본 확인
- [ ] **서버가 실행 중인가요?**
  - `http://localhost:3003/health`에서 "OK" 응답이 오는지 확인
  
- [ ] **포트 3003이 다른 프로그램에 사용되고 있지 않은가요?**
  - 다른 Node.js 서버가 실행 중이 아닌지 확인
  
- [ ] **`.env` 파일에 네이버 API 키가 설정되어 있나요?**
  - 프로젝트 폴더에 `.env` 파일이 있는지 확인
  - 파일 내용에 다음이 있는지 확인:
    - `NAVER_CUSTOMER_ID=...`
    - `NAVER_API_KEY=...`
    - `NAVER_SECRET_KEY=...`
  
- [ ] **`node_modules` 폴더가 있고 패키지가 설치되어 있나요?**
  - 프로젝트 폴더에 `node_modules` 폴더가 있는지 확인
  - 없으면 `pnpm install` 명령어 실행

---

## 🔧 상세 문제 해결

### 문제 1: Node.js가 설치되지 않음

**증상:** "node를 찾을 수 없습니다" 오류

**해결:**
1. [Node.js 공식 사이트](https://nodejs.org/) 방문
2. LTS 버전 (18.x 이상) 다운로드
3. 설치 마법사 실행 (모든 기본값 선택)
4. 컴퓨터 재시작
5. 터미널 다시 열고 시도

---

### 문제 2: 포트가 이미 사용 중

**증상:** "포트 3003이 이미 사용 중입니다" 오류

**확인 방법:**
```bash
netstat -ano | findstr :3003
```

**해결 방법 1: 기존 프로세스 종료**
1. 모든 터미널 창 확인
2. 검은색 명령 프롬프트 창이 있으면 찾기
3. 그 창에서 `Ctrl + C` 입력하여 종료
4. 다시 시도

**해결 방법 2: 다른 포트 사용**
1. 프로젝트 폴더의 `.env` 파일 열기 (없으면 생성)
2. 다음 줄 추가:
```
PORT=3004
```
3. 서버 재시작
4. 브라우저에서 `http://localhost:3004/...` 사용

---

### 문제 3: 패키지 설치 오류

**증상:** "모듈을 찾을 수 없습니다" 오류

**해결:**
```bash
# 패키지 설치
pnpm install
```

또는 npm 사용 시:
```bash
npm install
```

설치 완료 후 다시 시도

---

### 문제 4: API 키 미설정

**증상:** API 호출 시 "401 Unauthorized" 또는 "400 Bad Request" 오류

**확인:**
1. 프로젝트 폴더에 `.env` 파일이 있는지 확인
2. 파일을 텍스트 에디터로 열어서 API 키가 있는지 확인

**해결:**
1. `.env` 파일 생성 또는 수정
2. 다음 내용 추가:
```
OPENAI_API_KEY=your_key_here
NAVER_CUSTOMER_ID=your_id_here
NAVER_API_KEY=your_key_here
NAVER_SECRET_KEY=your_secret_here
```
3. 파일 저장
4. 서버 재시작

---

### 문제 5: 연결은 되지만 응답이 없음

**증상:** 요청을 보냈는데 응답이 오지 않음 (타임아웃)

**확인 사항:**
1. 서버 터미널에 오류 메시지가 있는지 확인
2. 브라우저 콘솔(F12)에서 오류 확인
3. 네이버 API 상태 확인

**해결:**
1. 서버 재시작: `Ctrl + C` 후 `node server.js`
2. 브라우저 캐시 삭제: `Ctrl + Shift + Delete`
3. 다시 시도

---

## 📝 빠른 참조

### 자주 사용하는 명령어

| 작업 | 명령어 |
|------|--------|
| 서버 시작 | `node server.js` |
| 서버 종료 | `Ctrl + C` |
| 패키지 설치 | `pnpm install` |
| 서버 상태 확인 | 브라우저: `http://localhost:3003/health` |
| API 테스트 | 브라우저: `http://localhost:3003/api/related-keywords?seed=테스트` |
| 포트 사용 확인 | `netstat -ano | findstr :3003` |

---

## 💡 팁

### 1. 브라우저 콘솔 활용
- F12를 눌러 개발자 도구 열기
- "Console" 탭에서 오류 메시지 확인
- "Network" 탭에서 요청/응답 상태 확인

### 2. 서버 로그 확인
- 터미널에 나타나는 로그 메시지 읽기
- API 호출 시 어떤 요청이 들어오는지 확인

### 3. 스크린샷 기록
- 오류가 발생하면 스크린샷 찍기
- 터미널 메시지, 브라우저 콘솔 모두 기록
- 나중에 참고할 자료가 됨

---

## 🆘 더 이상 해결 안 될 때

1. 다음 정보 수집:
   - 오류 메시지 (전체)
   - 터미널의 로그 메시지
   - 브라우저 콘솔 오류
   - 사용하는 OS (Windows/Mac/Linux)

2. 스크린샷 3-4장 촬영:
   - 터미널 전체
   - 브라우저 콘솔
   - 오류 메시지

3. 관리자에게 보고

---

**마지막 업데이트**: 2025년 11월 8일  
**관련 문서**: 
- `docs/04_관리_운영문서/03_서버시작종료_완벽가이드.md`
- `docs/03_개발_진행현황/02_로컬개발환경_테스트.md`

