# ğŸ“Š ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ ì„¤ì • ê°€ì´ë“œ

## ğŸ“ ìŠ¤í‚¤ë§ˆ íŒŒì¼ ìœ„ì¹˜

```
database/schemas/features/platform-connections/platform-connections-schema.sql
```

ì´ íŒŒì¼ì— ëª¨ë“  í…Œì´ë¸” ìƒì„± SQLì´ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤.

---

## ğŸš€ Supabaseì—ì„œ ì‹¤í–‰í•˜ëŠ” ë°©ë²•

### ë°©ë²• 1: Supabase SQL Editor ì‚¬ìš© (ê¶Œì¥)

1. **Supabase ëŒ€ì‹œë³´ë“œ ì ‘ì†**
   - https://supabase.com/dashboard ì ‘ì†
   - í”„ë¡œì íŠ¸ ì„ íƒ

2. **SQL Editor ì—´ê¸°**
   - ì™¼ìª½ ë©”ë‰´ì—ì„œ **"SQL Editor"** í´ë¦­
   - **"New query"** ë²„íŠ¼ í´ë¦­

3. **SQL íŒŒì¼ ë‚´ìš© ë³µì‚¬**
   - `database/schemas/features/platform-connections/platform-connections-schema.sql` íŒŒì¼ ì—´ê¸°
   - ì „ì²´ ë‚´ìš© ë³µì‚¬ (Ctrl+A â†’ Ctrl+C)

4. **SQL Editorì— ë¶™ì—¬ë„£ê¸°**
   - Supabase SQL Editorì— ë¶™ì—¬ë„£ê¸° (Ctrl+V)

5. **ì‹¤í–‰**
   - **"Run"** ë²„íŠ¼ í´ë¦­ (ë˜ëŠ” Ctrl+Enter)
   - ì„±ê³µ ë©”ì‹œì§€ í™•ì¸

### ë°©ë²• 2: íŒŒì¼ ì§ì ‘ ì—…ë¡œë“œ (ì„ íƒì‚¬í•­)

1. Supabase SQL Editorì—ì„œ
2. **"Upload SQL file"** ë²„íŠ¼ í´ë¦­
3. `platform-connections-schema.sql` íŒŒì¼ ì„ íƒ
4. ì‹¤í–‰

---

## âœ… ì‹¤í–‰ í›„ í™•ì¸ ì‚¬í•­

### 1. í…Œì´ë¸” ìƒì„± í™•ì¸

SQL Editorì—ì„œ ë‹¤ìŒ ì¿¼ë¦¬ ì‹¤í–‰:

```sql
-- ìƒì„±ëœ í…Œì´ë¸” ëª©ë¡ í™•ì¸
SELECT table_name 
FROM information_schema.tables 
WHERE table_schema = 'public' 
  AND table_name IN (
    'platform_connections',
    'platform_reviews',
    'rpa_job_logs',
    'session_refresh_logs'
  )
ORDER BY table_name;
```

**ì˜ˆìƒ ê²°ê³¼:**
- `platform_connections`
- `platform_reviews`
- `rpa_job_logs`
- `session_refresh_logs`

### 2. ì¸ë±ìŠ¤ í™•ì¸

```sql
-- ì¸ë±ìŠ¤ í™•ì¸
SELECT 
    tablename,
    indexname,
    indexdef
FROM pg_indexes
WHERE schemaname = 'public'
  AND tablename IN ('platform_connections', 'platform_reviews')
ORDER BY tablename, indexname;
```

### 3. í•¨ìˆ˜ ë° íŠ¸ë¦¬ê±° í™•ì¸

```sql
-- íŠ¸ë¦¬ê±° í•¨ìˆ˜ í™•ì¸
SELECT 
    trigger_name,
    event_object_table,
    action_statement
FROM information_schema.triggers
WHERE trigger_schema = 'public'
  AND event_object_table IN ('platform_connections', 'platform_reviews');
```

---

## ğŸ” ë¬¸ì œ í•´ê²°

### ì—ëŸ¬: "relation already exists"

í…Œì´ë¸”ì´ ì´ë¯¸ ì¡´ì¬í•˜ëŠ” ê²½ìš°:
- `CREATE TABLE IF NOT EXISTS`ë¥¼ ì‚¬ìš©í–ˆìœ¼ë¯€ë¡œ ì•ˆì „í•˜ê²Œ ì¬ì‹¤í–‰ ê°€ëŠ¥
- ë˜ëŠ” ê¸°ì¡´ í…Œì´ë¸” ì‚­ì œ í›„ ì¬ìƒì„±

```sql
-- ê¸°ì¡´ í…Œì´ë¸” ì‚­ì œ (ì£¼ì˜: ë°ì´í„° ëª¨ë‘ ì‚­ì œë¨)
DROP TABLE IF EXISTS session_refresh_logs CASCADE;
DROP TABLE IF EXISTS rpa_job_logs CASCADE;
DROP TABLE IF EXISTS platform_reviews CASCADE;
DROP TABLE IF EXISTS platform_connections CASCADE;
```

### ì—ëŸ¬: "permission denied"

- Supabase Service Role Keyë¥¼ ì‚¬ìš©í•˜ëŠ”ì§€ í™•ì¸
- ë˜ëŠ” í”„ë¡œì íŠ¸ ì†Œìœ ì ê¶Œí•œ í™•ì¸

### ì—ëŸ¬: "column does not exist"

- í…Œì´ë¸”ì´ ì œëŒ€ë¡œ ìƒì„±ë˜ì§€ ì•Šì•˜ì„ ìˆ˜ ìˆìŒ
- ì „ì²´ ìŠ¤í‚¤ë§ˆë¥¼ ë‹¤ì‹œ ì‹¤í–‰

---

## ğŸ“ ë‹¤ìŒ ë‹¨ê³„

ìŠ¤í‚¤ë§ˆ ìƒì„± ì™„ë£Œ í›„:

1. âœ… **í™˜ê²½ ë³€ìˆ˜ ì„¤ì •**
   ```env
   PLATFORM_ENCRYPTION_KEY=your-32-character-random-string-here
   ```

2. âœ… **íŒ¨í‚¤ì§€ ì„¤ì¹˜**
   ```bash
   pnpm add puppeteer @sparticuz/chromium crypto-js
   ```

3. âœ… **ì„œë²„ ì¬ì‹œì‘**
   ```bash
   # ë¡œì»¬
   node server.js
   
   # Render (ìë™ ë°°í¬)
   git push
   ```

---

## ğŸ“š ì°¸ê³ 

- **ìŠ¤í‚¤ë§ˆ íŒŒì¼**: `database/schemas/features/platform-connections/platform-connections-schema.sql`
- **êµ¬ì¶• ê³„íšì„œ**: `docs/10_í”Œë«í¼ì—°ë™_RPA/01_ì¥ì‚¬ë‹¥í„°ë°©ì‹_RPA_êµ¬ì¶•ê³„íš.md`
- **êµ¬í˜„ ì²´í¬ë¦¬ìŠ¤íŠ¸**: `docs/10_í”Œë«í¼ì—°ë™_RPA/02_êµ¬í˜„_ì²´í¬ë¦¬ìŠ¤íŠ¸.md`

