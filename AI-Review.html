<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"
    />
    <meta
      http-equiv="Content-Security-Policy"
      content="default-src 'self'; connect-src 'self' https://*.supabase.co https://naver-keyword-tool.onrender.com https://connect.facebook.net https://www.facebook.com wss://*.supabase.co; img-src 'self' data: https://www.facebook.com https:; script-src 'self' 'unsafe-inline' https://cdn.jsdelivr.net https://connect.facebook.net; style-src 'self' 'unsafe-inline' https://cdn.jsdelivr.net https://cdnjs.cloudflare.com; font-src 'self' https://cdn.jsdelivr.net https://cdnjs.cloudflare.com data:; frame-ancestors 'self'; base-uri 'self'; form-action 'self'"
    />
    <meta name="referrer" content="no-referrer" />
    <meta http-equiv="X-Content-Type-Options" content="nosniff" />
    <!-- ì‚¬ì´íŠ¸ ì„¤ëª… (SEO) -->
    <meta name="description" content="AIê°€ ê³ ê° ë¦¬ë·°ì— ìë™ìœ¼ë¡œ ë‹µê¸€ì„ ì‘ì„±í•´ë“œë¦½ë‹ˆë‹¤. ê¸ì •/ë¶€ì • ë¦¬ë·° ë¶„ì„, ê°ì • ë¶„ì„, ë§ì¶¤í˜• ë‹µê¸€ ìƒì„±ê¹Œì§€!" />
    <meta name="keywords" content="AI ë¦¬ë·° ë‹µê¸€, ë¦¬ë·° ê´€ë¦¬, ìë™ ë‹µê¸€, ë¦¬ë·° ë¶„ì„, ê³ ê° ì‘ëŒ€" />
    <!-- Open Graph -->
    <meta property="og:type" content="website" />
    <meta property="og:title" content="AI ë¦¬ë·° ê´€ë¦¬ - ì‚¬ì¥í”½" />
    <meta property="og:description" content="AIê°€ ê³ ê° ë¦¬ë·°ì— ê°ì„±ì ì´ê³  ì „ë¬¸ì ì¸ ë‹µê¸€ì„ ìë™ìœ¼ë¡œ ì‘ì„±í•´ë“œë¦½ë‹ˆë‹¤" />
    <meta property="og:site_name" content="ì‚¬ì¥í”½" />
    <title>AI ë¦¬ë·° ê´€ë¦¬ - ì‚¬ì¥í”½</title>
    <link
      rel="icon"
      href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'%3E%3Ccircle cx='32' cy='32' r='30' fill='%2303c75a'/%3E%3Ctext x='32' y='40' text-anchor='middle' font-size='28' font-family='Arial' fill='white'%3ESP%3C/text%3E%3C/svg%3E"
    />
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
      rel="stylesheet"
      integrity="sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy7tcenmpD1ypASozpmT/E0iPtmFIB46ZmdtAc9eNBvH0H/ZpiBw=="
      crossorigin="anonymous"
    />
    <link
      rel="stylesheet"
      as="style"
      crossorigin
      href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.9/dist/web/variable/pretendardvariable.min.css"
    />
    <style>
      :root {
        --accent-color: #ff7b54;
        --bg-color: #fff7f0;
        --text-primary: #201a17;
        --text-secondary: #7a6a60;
      }

      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: "Pretendard Variable", Pretendard, -apple-system,
          BlinkMacSystemFont, system-ui, Roboto, "Helvetica Neue", "Segoe UI",
          "Apple SD Gothic Neo", "Noto Sans KR", "Malgun Gothic",
          "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", sans-serif;
        background: var(--bg-color);
        color: var(--text-primary);
        display: flex;
        flex-direction: column;
        min-height: 100vh;
      }

      a {
        color: inherit;
        text-decoration: none;
      }

      .is-hidden {
        display: none !important;
      }

      .header {
        position: sticky;
        top: 0;
        z-index: 50;
        background: var(--bg-color);
        border-bottom: 1px solid rgba(0, 0, 0, 0.05);
        box-shadow: none;
        transition: transform 0.3s ease, box-shadow 0.3s ease;
      }

      @media (max-width: 992px) {
        .header {
          display: none;
        }
      }

      .header.header-hidden {
        transform: translateY(-100%);
      }

      .header-inner {
        max-width: 100%;
        margin: 0;
        padding: 12px 20px;
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 20px;
        position: relative;
      }

      .logo-container {
        display: flex;
        align-items: center;
        gap: 10px;
        font-weight: 800;
        font-size: 12px;
        color: var(--text-primary);
        cursor: pointer;
        flex: 0 0 auto;
      }

      .logo-icon {
        width: 28px;
        height: 28px;
        border-radius: 12px;
        background: var(--accent-color);
        color: #fff;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 14px;
      }

      .logo-text {
        letter-spacing: -0.03em;
        text-transform: lowercase;
        font-size: 12px;
      }

      .header-slogan {
        font-size: 16px;
        font-weight: 600;
        color: var(--text-secondary);
        margin: 0;
        white-space: nowrap;
        position: absolute;
        left: 50%;
        transform: translateX(-50%);
        z-index: 1;
      }

      .header-auth {
        display: flex;
        align-items: center;
        flex: 0 0 auto;
      }

      @media (max-width: 768px) {
        .header-inner {
          padding: 12px 16px;
          flex-wrap: wrap;
        }

        .header-slogan {
          font-size: 12px;
          position: static;
          transform: none;
          order: 3;
          width: 100%;
          text-align: center;
          margin-top: 8px;
        }

        .logo-container {
          order: 1;
          gap: 8px;
        }

        .header-auth {
          order: 2;
        }

        .logo-icon {
          width: 26px;
          height: 26px;
          font-size: 13px;
        }

        .logo-text {
          font-size: 12px;
        }
      }

      @media (max-width: 480px) {
        .header-inner {
          padding: 10px 12px;
          gap: 12px;
        }

        .header-slogan {
          display: none;
        }

        .logo-container {
          gap: 6px;
        }
      }

      @media (max-width: 360px) {
        .header-inner {
          padding: 8px 6px 8px 8px;
          gap: 0;
          min-height: auto;
          flex-wrap: nowrap;
          justify-content: space-between;
          align-items: center;
        }

        .logo-container {
          gap: 4px;
          flex: 0 1 auto;
          min-width: 0;
          margin-right: auto;
        }

        .logo-icon {
          width: 19px;
          height: 19px;
          font-size: 10px;
          flex-shrink: 0;
        }

        .logo-text {
          font-size: 11px;
          white-space: nowrap;
          overflow: hidden;
          text-overflow: ellipsis;
          max-width: 120px;
        }

        .header-slogan {
          display: none;
        }

        .header-auth {
          flex-shrink: 0;
          margin-left: auto;
          margin-right: 0;
        }

        .auth-buttons {
          gap: 2px;
          flex-wrap: nowrap;
          justify-content: flex-end;
        }

        .auth-btn {
          height: 28px;
          padding: 0 6px;
          font-size: 9px;
          min-width: auto;
          flex-shrink: 0;
        }

        .auth-btn i {
          font-size: 9px;
          margin-right: 2px;
        }

        .auth-btn span {
          font-size: 9px;
          white-space: nowrap;
        }

        .auth-btn--ghost {
          display: none;
        }
      }

      .header-left {
        display: flex;
        align-items: center;
        gap: 16px;
      }

      .header-menu-btn {
        width: 40px;
        height: 40px;
        border-radius: 12px;
        border: none;
        background: rgba(255, 126, 70, 0.15);
        color: var(--accent-color);
        font-size: 18px;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        transition: transform 0.2s ease, background 0.2s ease;
      }

      .header-menu-btn:hover {
        transform: translateY(-2px);
        background: rgba(255, 126, 70, 0.25);
      }

      .logo-container {
        display: flex;
        align-items: center;
        gap: 10px;
        font-weight: 800;
        font-size: 12px;
        color: var(--text-primary);
        cursor: pointer;
      }

      .logo-icon {
        width: 28px;
        height: 28px;
        border-radius: 12px;
        background: var(--accent-color);
        color: #fff;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 14px;
      }

      .logo-text {
        letter-spacing: -0.03em;
        text-transform: lowercase;
        font-size: 12px;
      }

      @media (max-width: 768px) {
        .logo-icon {
          width: 26px;
          height: 26px;
          font-size: 13px;
        }

        .logo-text {
          font-size: 12px;
        }
      }

      /* ì‚¬ì´ë“œë°” ìŠ¤íƒ€ì¼ - ìƒˆë¡œìš´ ë””ìì¸ */
      .side-nav {
        background: #ffe8d9;
        border-radius: 18px;
        padding: 18px 11px;
        display: flex;
        flex-direction: column;
        gap: 14px;
        align-items: center;
        position: fixed;
        left: 20px;
        top: 120px;
        width: 66px;
        height: auto;
        max-height: calc(100vh - 160px);
        overflow-y: auto;
        z-index: 40;
        box-shadow: 0 12px 32px rgba(0, 0, 0, 0.12);
      }

      .side-nav .menu-item {
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 3px;
        padding: 9px 6px;
        color: #5a5a5a;
        text-decoration: none;
        font-weight: 500;
        font-size: 9px;
        border-radius: 11px;
        transition: all 0.3s ease;
        width: 43px;
        position: relative;
        background: transparent;
      }

      .side-nav .menu-item:hover {
        background: #ffffff;
        color: #ff7e46;
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(255, 126, 70, 0.3);
      }

      .side-nav .menu-item:hover .ico {
        color: #ff7e46;
        background: rgba(255, 126, 70, 0.1);
      }

      .side-nav .menu-item.active {
        background: #ffffff;
        color: #ff7e46;
      }

      .side-nav .menu-item.active .ico {
        color: #ff7e46;
        background: rgba(255, 126, 70, 0.1);
      }

      .side-nav .ico {
        width: 29px;
        height: 29px;
        border-radius: 7px;
        display: grid;
        place-items: center;
        background: transparent;
        color: #5a5a5a;
        font-size: 13px;
        transition: all 0.3s ease;
      }

      /* ê¸°ì¡´ ì‚¬ì´ë“œë°” ìˆ¨ê¹€ */
      .sidebar {
        display: none;
      }

      .sidebar-header {
        padding: 20px 16px;
        border-bottom: 1px solid rgba(0, 0, 0, 0.06);
      }

      .sidebar-logo {
        display: flex;
        align-items: center;
        gap: 16px;
      }

      .sidebar-logo-icon {
        width: 36px;
        height: 36px;
        background: var(--accent-color);
        color: white;
        border-radius: 10px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 18px;
      }

      .sidebar-logo-text {
        font-size: 18px;
        font-weight: 800;
        color: var(--text-primary);
      }

      .sidebar-menu {
        padding: 16px 0;
      }

      .sidebar-item {
        display: flex;
        align-items: center;
        gap: 12px;
        padding: 12px 20px;
        color: var(--text-secondary);
        text-decoration: none;
        font-size: 14px;
        font-weight: 600;
        transition: all 0.3s ease;
        border-left: 3px solid transparent;
      }

      .sidebar-item:hover {
        background: rgba(255, 126, 70, 0.1);
        color: var(--accent-color);
        border-left-color: var(--accent-color);
      }

      .sidebar-item.active {
        background: rgba(255, 126, 70, 0.15);
        color: var(--accent-color);
        border-left-color: var(--accent-color);
        font-weight: 700;
      }

      .sidebar-item i {
        font-size: 16px;
        width: 20px;
        text-align: center;
      }

      /* ë©”ì¸ ì»¨í…ì¸  ì˜ì—­ */
      .main-content {
        margin-left: 0;
        padding-left: 100px;
        min-height: 100vh;
      }

      @media (max-width: 768px) {
        .container {
          padding: 16px 12px;
        }
      }

      @media (max-width: 360px) {
        .container {
          padding: 16px 12px;
        }
      }

      @media (max-width: 992px) {
        .side-nav {
          position: fixed !important;
          bottom: 20px !important;
          left: 50%;
          transform: translateX(-50%);
          top: auto !important;
          flex-direction: row;
          width: calc(100vw - 40px);
          max-width: calc(100vw - 40px);
          padding: 6px 10px;
          overflow-x: auto;
          overflow-y: hidden;
          gap: 8px;
          border-radius: 18px;
          box-shadow: 0 8px 24px rgba(0, 0, 0, 0.15);
          z-index: 100;
          justify-content: flex-start;
          -webkit-overflow-scrolling: touch;
          touch-action: pan-x;
          scrollbar-width: thin;
          scroll-snap-type: x mandatory;
        }

        /* ì˜¤ë¥¸ìª½ í˜ì´ë“œì•„ì›ƒ íš¨ê³¼ */
        .side-nav::after {
          content: "";
          position: absolute;
          top: 0;
          right: 0;
          width: 50px;
          height: 100%;
          background: linear-gradient(to right, transparent, #ffe8d9);
          pointer-events: none;
          z-index: 1;
          opacity: 1;
          transition: opacity 0.3s ease;
        }

        /* ì˜¤ë¥¸ìª½ í™”ì‚´í‘œ ì¸ë””ì¼€ì´í„° */
        .side-nav::before {
          content: "â†’";
          position: absolute;
          top: 50%;
          right: 8px;
          transform: translateY(-50%);
          font-size: 18px;
          color: rgba(255, 126, 70, 0.6);
          pointer-events: none;
          z-index: 2;
          opacity: 1;
          transition: opacity 0.3s ease;
          animation: slideHintSide 2s ease-in-out infinite;
        }

        @keyframes slideHintSide {
          0%,
          100% {
            transform: translateY(-50%) translateX(0);
          }
          50% {
            transform: translateY(-50%) translateX(5px);
          }
        }

        /* ì¸ë””ì¼€ì´í„°ê°€ ìˆ¨ê²¨ì§„ ê²½ìš° */
        .side-nav.hide-indicator::before,
        .side-nav.hide-indicator::after {
          opacity: 0 !important;
          animation: none !important;
        }

        .side-nav::-webkit-scrollbar {
          height: 4px;
        }

        .side-nav::-webkit-scrollbar-track {
          background: rgba(0, 0, 0, 0.05);
          border-radius: 2px;
        }

        .side-nav::-webkit-scrollbar-thumb {
          background: rgba(255, 126, 70, 0.4);
          border-radius: 2px;
        }

        .side-nav::-webkit-scrollbar-thumb:hover {
          background: rgba(255, 126, 70, 0.6);
        }

        .side-nav .menu-item {
          flex-direction: column;
          min-width: 50px;
          padding: 4px 5px;
          font-size: 8px;
          flex: 0 0 50px;
          flex-shrink: 0;
          scroll-snap-align: start;
          gap: 3px;
        }

        .side-nav .menu-item .ico {
          width: 32px;
          height: 32px;
          font-size: 14px;
        }

        .side-nav .menu-item.active {
          background: #ffffff;
          color: #ff7e46;
        }

        .side-nav .menu-item.active .ico {
          color: #ff7e46;
          background: rgba(255, 126, 70, 0.1);
        }

        .main-content {
          padding-left: 0;
          padding-bottom: 65px;
        }
      }

      @media (max-width: 360px) {
        .side-nav {
          position: fixed !important;
          bottom: 12px !important;
          top: auto !important;
          width: calc(100vw - 16px);
          max-width: calc(100vw - 16px);
          padding: 5px 8px;
          gap: 6px;
          border-radius: 14px;
          overflow-x: auto;
          overflow-y: hidden;
          justify-content: flex-start;
          -webkit-overflow-scrolling: touch;
          touch-action: pan-x;
          scrollbar-width: thin;
          scroll-snap-type: x mandatory;
        }

        /* ì˜¤ë¥¸ìª½ í˜ì´ë“œì•„ì›ƒ íš¨ê³¼ */
        .side-nav::after {
          content: "";
          position: absolute;
          top: 0;
          right: 0;
          width: 40px;
          height: 100%;
          background: linear-gradient(to right, transparent, #ffe8d9);
          pointer-events: none;
          z-index: 1;
          opacity: 1;
          transition: opacity 0.3s ease;
        }

        /* ì˜¤ë¥¸ìª½ í™”ì‚´í‘œ ì¸ë””ì¼€ì´í„° */
        .side-nav::before {
          content: "â†’";
          position: absolute;
          top: 50%;
          right: 6px;
          transform: translateY(-50%);
          font-size: 16px;
          color: rgba(255, 126, 70, 0.6);
          pointer-events: none;
          z-index: 2;
          animation: slideHintSide 2s ease-in-out infinite;
          opacity: 1;
          transition: opacity 0.3s ease;
        }

        /* ì¸ë””ì¼€ì´í„°ê°€ ìˆ¨ê²¨ì§„ ê²½ìš° (360px ì´í•˜) */
        .side-nav.hide-indicator::before,
        .side-nav.hide-indicator::after {
          opacity: 0 !important;
          animation: none !important;
        }

        .side-nav::-webkit-scrollbar {
          height: 3px;
        }

        .side-nav::-webkit-scrollbar-track {
          background: rgba(0, 0, 0, 0.05);
          border-radius: 2px;
        }

        .side-nav::-webkit-scrollbar-thumb {
          background: rgba(255, 126, 70, 0.4);
          border-radius: 2px;
        }

        .side-nav .menu-item {
          min-width: 45px;
          padding: 3px 4px;
          font-size: 7px;
          flex: 0 0 45px;
          flex-shrink: 0;
          gap: 2px;
          scroll-snap-align: start;
        }

        .side-nav .menu-item .ico {
          width: 28px;
          height: 28px;
          font-size: 12px;
        }

        .side-nav .menu-item span:not(.ico) {
          font-size: 7px;
          word-break: keep-all;
          line-height: 1.2;
          text-align: center;
        }

        .side-nav .menu-item:hover .ico {
          background: #ffffff;
        }

        .side-nav .menu-item.active {
          background: #ffffff;
          color: #ff7e46;
        }

        .side-nav .menu-item.active .ico {
          color: #ff7e46;
          background: rgba(255, 126, 70, 0.1);
        }

        .main-content {
          padding-bottom: 55px;
        }
      }

      .header-right {
        display: flex;
        align-items: center;
        gap: 20px;
      }

      .header-auth {
        display: flex;
        align-items: center;
      }

      .auth-buttons {
        display: flex;
        align-items: center;
        gap: 16px;
      }

      .auth-btn {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        height: 44px;
        padding: 0 22px;
        border-radius: 12px;
        font-weight: 700;
        font-size: 14px;
        border: 1px solid rgba(0, 0, 0, 0.05);
        background: #fff;
        color: var(--text-primary);
        cursor: pointer;
        transition: transform 0.2s ease, box-shadow 0.2s ease, border 0.2s ease;
      }

      .auth-btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 8px 18px rgba(0, 0, 0, 0.08);
      }

      .auth-btn--primary {
        background: transparent;
        color: var(--accent-color);
        border: 1px solid var(--accent-color);
      }

      .auth-btn--primary:hover {
        background: var(--accent-color);
        color: #fff;
        box-shadow: 0 8px 18px rgba(255, 126, 70, 0.3);
        transform: translateY(-1px);
      }

      .auth-btn--ghost {
        background: transparent;
        color: var(--text-secondary);
      }

      .auth-btn--ghost:hover {
        border-color: var(--accent-color);
        color: var(--accent-color);
      }

      .auth-user {
        display: none;
        align-items: center;
        gap: 14px;
        padding: 10px 16px;
        border-radius: 16px;
        background: rgba(255, 123, 84, 0.12);
        color: var(--text-primary);
      }

      .auth-user__avatar {
        width: 40px;
        height: 40px;
        border-radius: 12px;
        background: var(--accent-color);
        color: #fff;
        font-weight: 700;
        display: flex;
        align-items: center;
        justify-content: center;
        letter-spacing: -0.02em;
        text-transform: uppercase;
      }

      .auth-user__meta {
        display: flex;
        flex-direction: column;
        line-height: 1.2;
      }

      .auth-user__label {
        font-size: 11px;
        font-weight: 600;
        color: var(--text-secondary);
        letter-spacing: 0.08em;
        text-transform: uppercase;
        text-decoration: none;
      }

      .auth-user__email {
        font-size: 14px;
        font-weight: 600;
        color: var(--text-primary);
        cursor: pointer;
        transition: color 0.2s ease;
        text-decoration: none;
      }

      .auth-user__email:hover {
        color: var(--accent-color);
      }

      .auth-token-info-inline {
        display: none !important;
        align-items: center;
        gap: 4px;
        padding: 4px 8px;
        border-radius: 8px;
        background: rgba(255, 123, 84, 0.1);
        border: 1px solid rgba(255, 123, 84, 0.25);
        font-size: 11px;
        font-weight: 700;
        color: var(--text-primary);
      }

      .auth-token-info-inline.show {
        display: flex !important;
      }

      .auth-token-info-inline i {
        font-size: 12px;
        color: var(--accent-color);
      }

      .auth-token-text {
        display: flex;
        align-items: center;
        gap: 3px;
        font-weight: 700;
      }

      .auth-token-text span:first-child {
        color: var(--accent-color);
        font-size: 11px;
        font-weight: 800;
      }

      .auth-token-text span:last-child {
        color: var(--text-secondary);
        font-size: 10px;
        opacity: 0.7;
      }

      .auth-user__logout {
        height: 36px;
        padding: 0 16px;
        border-radius: 12px;
        border: 1px solid rgba(0, 0, 0, 0.08);
        background: #fff;
        color: var(--text-primary);
        font-weight: 600;
        cursor: pointer;
        transition: all 0.2s ease;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        gap: 6px;
      }

      .auth-user__logout:hover {
        background: rgba(255, 126, 70, 0.12);
        transform: translateY(-2px);
      }

      .container {
        max-width: 1400px;
        margin: 0 auto;
        padding: 32px;
        background: transparent;
        flex: 1;
      }

      @media (max-width: 768px) {
        .main-content {
          margin-left: 0;
        }

        .container {
          padding: 16px 12px;
        }

        .sidebar {
          display: none;
        }
      }

      @media (max-width: 360px) {
        .container {
          padding: 16px 12px;
        }
      }

      /* í˜ì´ì§€ í—¤ë” ì„¹ì…˜ - í†µì¼ëœ ìŠ¤íƒ€ì¼ */
      .header-section {
        background: #ffe8d9;
        border-radius: 20px 20px 0 0;
        padding: 8px 20px 8px 20px;
        margin-bottom: 0;
        min-height: 56px;
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .page-header {
        margin-bottom: 0;
        text-align: center;
        width: 100%;
      }

      .page-header h1 {
        font-size: 12pt;
        font-weight: 800;
        color: var(--text-primary);
        margin-bottom: 2px;
        line-height: 1.2;
      }

      .page-header p {
        font-size: 8pt;
        color: var(--text-secondary);
        line-height: 1.3;
        margin: 0;
      }

      @media (max-width: 768px) {
        .header-section {
          padding: 8px 12px 8px 12px;
          border-radius: 16px 16px 0 0;
          min-height: 56px;
        }

        .page-header {
          margin-bottom: 0;
        }

        .page-header h1 {
          font-size: 12pt;
          margin-bottom: 2px;
          line-height: 1.2;
        }

        .page-header p {
          font-size: 8pt;
          white-space: nowrap;
          overflow: hidden;
          text-overflow: ellipsis;
          line-height: 1.3;
        }
      }

      @media (max-width: 360px) {
        .header-section {
          padding: 8px 8px 8px 8px;
          border-radius: 12px 12px 0 0;
          min-height: 56px;
        }

        .page-header {
          margin-bottom: 0;
        }

        .page-header h1 {
          font-size: 12pt;
          margin-bottom: 2px;
          line-height: 1.2;
        }

        .page-header p {
          font-size: 8pt;
          white-space: nowrap;
          overflow: hidden;
          text-overflow: ellipsis;
          line-height: 1.3;
        }
      }

      /* AI ë¦¬ë·° í¼ ìŠ¤íƒ€ì¼ */
      .review-container {
        background: white;
        border-radius: 0 0 20px 20px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.08);
        overflow: hidden;
        margin-bottom: 40px;
        margin-top: 0;
      }

      .review-content {
        padding: 36px;
      }

      @media (max-width: 768px) {
        .review-content {
          padding: 24px 16px;
        }
      }

      @media (max-width: 360px) {
        .review-content {
          padding: 20px 12px;
        }
      }

      .form-group {
        margin-bottom: 24px;
      }

      .form-group label {
        display: block;
        margin-bottom: 8px;
        color: var(--text-primary);
        font-weight: 600;
        font-size: 14px;
      }

      .form-group label i {
        margin-right: 8px;
        color: var(--accent-color);
      }

      .input-field,
      .form-group input[type="text"],
      .form-group textarea {
        width: 100%;
        padding: 12px 16px;
        border: 2px solid #e2e8f0;
        border-radius: 12px;
        font-size: 14px;
        transition: all 0.3s ease;
        font-family: inherit;
        background: #fff;
      }

      .input-field:focus,
      .form-group input[type="text"]:focus,
      .form-group textarea:focus {
        outline: none;
        border-color: var(--accent-color);
        box-shadow: 0 0 0 3px rgba(255, 126, 70, 0.15);
      }

      .textarea-field {
        min-height: 120px;
        resize: vertical;
      }

      /* ë²„íŠ¼ ê·¸ë£¹ */
      .button-group {
        display: flex;
        gap: 12px;
        flex-wrap: wrap;
        margin-bottom: 24px;
      }

      .btn {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        gap: 8px;
        padding: 12px 24px;
        border-radius: 12px;
        font-weight: 600;
        font-size: 14px;
        border: 2px solid var(--accent-color);
        background: white;
        color: var(--accent-color);
        cursor: pointer;
        transition: all 0.3s ease;
        text-decoration: none;
      }

      .btn:hover {
        background: var(--accent-color);
        color: white;
        transform: translateY(-2px);
        box-shadow: 0 8px 20px rgba(255, 126, 70, 0.25);
      }

      .btn.btn-primary {
        background: var(--accent-color);
        color: white;
      }

      .btn.btn-primary:hover {
        background: #e66a42;
        box-shadow: 0 8px 20px rgba(255, 126, 70, 0.35);
      }

      .btn:disabled {
        opacity: 0.6;
        cursor: not-allowed;
        transform: none;
        box-shadow: none;
      }

      .btn.loading {
        position: relative;
        color: transparent;
      }

      .btn.loading::after {
        content: "";
        position: absolute;
        top: 50%;
        left: 50%;
        width: 16px;
        height: 16px;
        margin: -8px 0 0 -8px;
        border: 2px solid currentColor;
        border-radius: 50%;
        border-top-color: transparent;
        animation: spin 0.8s linear infinite;
      }

      @keyframes spin {
        to {
          transform: rotate(360deg);
        }
      }

      /* ê²°ê³¼ ì˜ì—­ */
      .result-section {
        background: #f8fafc;
        padding: 24px;
        border-radius: 12px;
        border: 1px solid #e2e8f0;
        min-height: 200px;
      }

      .result-section h3 {
        color: var(--text-primary);
        margin-bottom: 16px;
        font-size: 18px;
        display: flex;
        align-items: center;
        gap: 8px;
      }

      .copy-btn {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        gap: 6px;
        padding: 8px 16px;
        border-radius: 8px;
        border: 2px solid var(--accent-color);
        background: white;
        color: var(--accent-color);
        font-weight: 600;
        font-size: 13px;
        cursor: pointer;
        transition: all 0.3s ease;
        font-family: inherit;
        opacity: 0.6;
        pointer-events: none;
      }

      .copy-btn:hover:not(:disabled) {
        background: var(--accent-color);
        color: white;
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(255, 126, 70, 0.3);
      }

      .copy-btn:active:not(:disabled) {
        transform: translateY(0);
      }

      .copy-btn:disabled {
        opacity: 0.6;
        cursor: not-allowed;
        pointer-events: none;
      }

      .copy-btn.active {
        opacity: 1;
        pointer-events: auto;
      }

      .copy-btn.copied {
        background: #22c55e;
        border-color: #22c55e;
        color: white;
      }

      .copy-btn.copied:hover {
        background: #16a34a;
        border-color: #16a34a;
      }

      /* í† í° í™•ì¸ íŒì—… */
      .token-modal {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(0, 0, 0, 0.6);
        z-index: 2000;
        align-items: center;
        justify-content: center;
      }

      .token-modal.active {
        display: flex;
      }

      .token-modal-content {
        background: white;
        border-radius: 24px;
        padding: 40px;
        max-width: 480px;
        width: 90%;
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        animation: modalSlideIn 0.3s ease-out;
        max-height: 90vh;
        overflow-y: auto;
        box-sizing: border-box;
      }

      @keyframes modalSlideIn {
        from {
          opacity: 0;
          transform: translateY(-20px) scale(0.95);
        }
        to {
          opacity: 1;
          transform: translateY(0) scale(1);
        }
      }

      .token-modal-header {
        text-align: center;
        margin-bottom: 32px;
      }

      .token-modal-icon {
        width: 64px;
        height: 64px;
        background: rgba(255, 123, 84, 0.1);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        margin: 0 auto 20px;
        font-size: 32px;
        color: var(--accent-color);
      }

      .token-modal-title {
        font-size: 24px;
        font-weight: 800;
        color: var(--text-primary);
        margin-bottom: 8px;
      }

      .token-modal-subtitle {
        font-size: 16px;
        color: var(--text-secondary);
      }

      .token-info-box {
        background: #f8fafc;
        border-radius: 16px;
        padding: 24px;
        margin-bottom: 32px;
      }

      .token-info-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 12px 0;
        border-bottom: 1px solid #e2e8f0;
      }

      .token-info-item:last-child {
        border-bottom: none;
      }

      .token-info-label {
        font-size: 15px;
        color: var(--text-secondary);
      }

      .token-info-value {
        font-size: 18px;
        font-weight: 700;
        color: var(--text-primary);
      }

      .token-info-value.warning {
        color: #ef4444;
      }

      .token-info-value.success {
        color: #22c55e;
      }

      .token-modal-actions {
        display: flex;
        gap: 12px;
      }

      .token-modal-actions .btn {
        flex: 1;
        min-width: 0;
      }

      .token-warning-box {
        background: linear-gradient(135deg, rgba(255, 152, 0, 0.1) 0%, rgba(255, 123, 84, 0.1) 100%);
        border: 2px solid #f59e0b;
        border-radius: 16px;
        padding: 20px;
        margin-bottom: 24px;
        text-align: center;
      }

      .token-warning-box.hidden {
        display: none;
      }

      .token-warning-icon {
        width: 48px;
        height: 48px;
        background: #f59e0b;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        margin: 0 auto 16px;
        font-size: 24px;
        color: white;
        animation: pulse 2s ease-in-out infinite;
      }

      @keyframes pulse {
        0%, 100% {
          transform: scale(1);
        }
        50% {
          transform: scale(1.05);
        }
      }

      .token-warning-title {
        font-size: 18px;
        font-weight: 700;
        color: #f59e0b;
        margin-bottom: 8px;
      }

      .token-warning-message {
        font-size: 14px;
        color: var(--text-secondary);
        line-height: 1.6;
      }

      .token-modal-icon.warning {
        background: rgba(255, 152, 0, 0.15);
        color: #f59e0b;
      }

      @media (max-width: 768px) {
        .token-modal {
          padding: 16px;
          align-items: flex-end;
        }

        .token-modal-content {
          width: 100%;
          max-width: 100%;
          border-radius: 24px 24px 0 0;
          padding: 24px 20px;
          max-height: 85vh;
          margin-bottom: 0;
        }

        .token-modal-header {
          margin-bottom: 24px;
        }

        .token-modal-icon {
          width: 56px;
          height: 56px;
          font-size: 28px;
          margin-bottom: 16px;
        }

        .token-modal-title {
          font-size: 20px;
        }

        .token-modal-subtitle {
          font-size: 14px;
        }

        .token-info-box {
          padding: 20px;
          margin-bottom: 24px;
        }

        .token-info-item {
          padding: 10px 0;
        }

        .token-info-label {
          font-size: 14px;
        }

        .token-info-value {
          font-size: 16px;
        }

        .token-modal-actions {
          gap: 8px;
        }

        .token-modal-actions .btn {
          min-width: 0;
          padding: 0 16px;
          font-size: 14px;
        }
      }

      .result-content {
        background: white;
        padding: 20px;
        border-radius: 8px;
        border: 1px solid #e2e8f0;
        white-space: pre-wrap;
        line-height: 1.6;
        color: var(--text-primary);
        font-size: 14px;
      }

      .result-content:empty::before {
        content: "ìƒì„±ëœ ë‹µê¸€ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤...";
        color: var(--text-secondary);
        font-style: italic;
      }

      /* í”Œë ˆì´ìŠ¤ ì •ë³´ ìƒíƒœ í´ë˜ìŠ¤ë“¤ */
      .place-info-status {
        display: flex;
        align-items: center;
        gap: 8px;
        padding: 12px 16px;
        border-radius: 8px;
        margin: 15px 0;
        font-size: 14px;
        font-weight: 500;
        transition: all 0.3s ease;
      }

      .place-info-status.hidden {
        display: none !important;
      }

      .place-info-status.loading {
        background: #fef3c7;
        border: 1px solid #f59e0b;
        color: #92400e;
      }

      .place-info-status.warning {
        background: #fef2f2;
        border: 1px solid #ef4444;
        color: #dc2626;
      }

      .result-content.error {
        background: #fef2f2;
        border-color: #ef4444;
        color: #dc2626;
      }

      /* í‘¸í„° ìŠ¤íƒ€ì¼ */
      .site-footer {
        background: rgba(255, 255, 255, 0.95);
        border-top: 1px solid rgba(0, 0, 0, 0.08);
        padding: 40px 20px;
        margin-top: auto;
        color: var(--text-secondary);
        width: 100%;
      }

      .footer-content {
        max-width: 1400px;
        margin: 0 auto;
        display: flex;
        flex-direction: row;
        flex-wrap: wrap;
        justify-content: center;
        gap: 24px;
        font-size: 14px;
        line-height: 1.8;
        align-items: center;
      }

      .footer-item {
        display: flex;
        flex-direction: row;
        align-items: center;
        gap: 12px;
      }

      .footer-label {
        font-weight: 700;
        color: var(--text-primary);
        font-size: 13px;
        margin-bottom: 4px;
      }

      .footer-value {
        color: var(--text-secondary);
        font-size: 13px;
      }

      .footer-value a {
        color: var(--accent-color);
        text-decoration: none;
        transition: opacity 0.2s ease;
      }

      .footer-value a:hover {
        opacity: 0.8;
        text-decoration: underline;
      }

      @media (max-width: 768px) {
        .site-footer {
          padding: 10px 8px;
          position: fixed;
          bottom: 0;
          left: 0;
          right: 0;
          z-index: 30;
          margin-top: 0;
        }

        .footer-content {
          gap: 5px;
          font-size: 8px;
          flex-direction: row;
          flex-wrap: wrap;
          line-height: 1.4;
        }

        .footer-item {
          flex-direction: row;
          align-items: center;
          gap: 3px;
        }

        .footer-label {
          font-size: 8px;
        }

        .footer-value {
          font-size: 8px;
        }
      }
    </style>
    <!-- ì¸ì¦ ê°€ë“œ: ë¡œê·¸ì¸ í•„ìˆ˜ ê¸°ëŠ¥ ë³´í˜¸ -->
    <script src="./assets/auth-guard.js" defer></script>
    <!-- Meta Pixel Code -->
    <script>
      !function(f,b,e,v,n,t,s)
      {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
      n.callMethod.apply(n,arguments):n.queue.push(arguments)};
      if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
      n.queue=[];t=b.createElement(e);t.async=!0;
      t.src=v;s=b.getElementsByTagName(e)[0];
      s.parentNode.insertBefore(t,s)}(window, document,'script',
      'https://connect.facebook.net/en_US/fbevents.js');
      fbq('init', '823098897158597');
      fbq('track', 'PageView');
    </script>
    <noscript><img height="1" width="1" style="display:none"
      src="https://www.facebook.com/tr?id=823098897158597&ev=PageView&noscript=1"
    /></noscript>
    <!-- End Meta Pixel Code -->
  </head>
  <body>
    <header class="header">
      <div class="header-inner">
        <a href="/" class="logo-container">
          <div class="logo-icon">
            <i class="fa-solid fa-thumbtack"></i>
          </div>
          <span class="logo-text">sajang pick</span>
        </a>

        <h1 class="header-slogan">ì„¼ìŠ¤ìˆëŠ” ì‚¬ì¥ë‹˜ë“¤ì˜ ì„ íƒ</h1>

        <div class="header-auth">
          <div class="auth-buttons" id="authButtons">
            <div class="auth-token-info" id="authTokenInfo" style="display: none;" onclick="location.href='/mypage.html'" title="ë§ˆì´í˜ì´ì§€ì—ì„œ í† í° ì •ë³´ í™•ì¸">
              <i class="fa-solid fa-coins"></i>
              <span class="auth-token-text">
                <span id="tokenRemaining">-</span>
                <span style="color: var(--text-secondary); font-weight: 400;">/</span>
                <span id="tokenLimit">-</span>
              </span>
            </div>
            <div class="auth-user" id="authUser" style="display: none">
              <div class="auth-user__avatar" id="userAvatar">U</div>
              <div class="auth-user__meta">
                <div style="display: flex; align-items: center; gap: 8px;">
                  <a
                    href="/mypage.html"
                    class="auth-user__label"
                    style="cursor: pointer; text-decoration: none; display: flex; align-items: center; gap: 6px;"
                    ><i class="fa-solid fa-door-open" style="font-size: 14px;"></i>ë‚˜ì˜ í˜ì´ì§€</a
                  >
                  <div class="auth-token-info-inline" id="authTokenInfo" style="display: none;">
                    <i class="fa-solid fa-coins"></i>
                    <span class="auth-token-text">
                      <span id="tokenRemaining">-</span>
                      <span style="color: var(--text-secondary); font-weight: 400;">/</span>
                      <span id="tokenLimit">-</span>
                    </span>
                  </div>
                </div>
                <a
                  href="/mypage.html"
                  class="auth-user__email"
                  id="userEmail"
                  style="cursor: pointer; text-decoration: none"
                ></a>
              </div>
              <button class="auth-user__logout" id="logoutBtn" type="button">
                ë¡œê·¸ì•„ì›ƒ
              </button>
            </div>
            <a
              href="/login.html"
              class="auth-btn auth-btn--primary"
              id="loginBtn"
            >
              <i class="fa-solid fa-sign-in-alt" style="margin-right: 8px"></i>
              <span>ë¡œê·¸ì¸</span>
            </a>
            <a
              href="/join.html"
              class="auth-btn auth-btn--ghost"
              id="signupBtn"
            >
              <i class="fa-solid fa-user-plus" style="margin-right: 8px"></i>
              <span>íšŒì›ê°€ì…</span>
            </a>
          </div>
        </div>
      </div>
    </header>

    <aside class="side-nav" aria-label="ì‚¬ì´ë“œ ë„¤ë¹„ê²Œì´ì…˜">
      <a class="menu-item" href="./index.html">
        <span class="ico"><i class="fa-solid fa-house"></i></span>
        <span>í™ˆ</span>
      </a>
      <a class="menu-item" href="./naver_search.html">
        <span class="ico"><i class="fa-solid fa-key"></i></span>
        <span>í‚¤ì›Œë“œ</span>
      </a>
      <a class="menu-item active" href="./AI-Review.html">
        <span class="ico"><i class="fa-solid fa-pen-nib"></i></span>
        <span>ë¦¬ë·°</span>
      </a>
      <a class="menu-item" href="./Blog-Editor.html">
        <span class="ico"><i class="fa-solid fa-blog"></i></span>
        <span>ë¸”ë¡œê·¸</span>
      </a>
      <a class="menu-item" href="./recipe-manager.html">
        <span class="ico"><i class="fa-solid fa-utensils"></i></span>
        <span>ë ˆì‹œí”¼</span>
      </a>
      <a class="menu-item" href="./shorts-editor.html">
        <span class="ico"><i class="fa-solid fa-film"></i></span>
        <span>ì˜ìƒ</span>
      </a>
      <a class="menu-item" href="./sajangpick-book.html">
        <span class="ico"><i class="fa-solid fa-book-open"></i></span>
        <span>ì „ìì±…</span>
      </a>
      <a class="menu-item" href="./news-board.html">
        <span class="ico"><i class="fa-solid fa-newspaper"></i></span>
        <span>ë‰´ìŠ¤</span>
      </a>
      <a class="menu-item" href="./policy-support.html">
        <span class="ico"><i class="fa-solid fa-coins"></i></span>
        <span>ì •ì±…</span>
      </a>
    </aside>

    <!-- ë©”ì¸ ì»¨í…ì¸  -->
    <div class="main-content">
      <div class="container">
        <!-- í—¤ë” ì„¹ì…˜ -->
        <div class="header-section">
          <div class="page-header">
            <h1>AI ë¦¬ë·° ê´€ë¦¬</h1>
            <p>AIë¥¼ í™œìš©í•˜ì—¬ ê³ ê° ë¦¬ë·°ì— ëŒ€í•œ ìŠ¤ë§ˆíŠ¸í•œ ë‹µê¸€ì„ ìƒì„±í•´ë³´ì„¸ìš”.</p>
          </div>
        </div>

        <div class="review-container">
          <div class="review-content">
            <div class="form-group">
              <label for="reviewText">
                <i class="fas fa-comment"></i>
                ê³ ê° ë¦¬ë·° ë‚´ìš©
              </label>
              <textarea
                id="reviewText"
                class="textarea-field"
                placeholder="ê³ ê°ì´ ì‘ì„±í•œ ë¦¬ë·° ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”..."
              ></textarea>
            </div>

            <!-- ê°€ê²Œ ì •ë³´ ì €ì¥/ë¶ˆëŸ¬ì˜¤ê¸° ì•ˆë‚´ -->
            <div
              style="
                background: var(--accent-color);
                border-radius: 10px;
                padding: 15px;
                margin-bottom: 20px;
                color: white;
              "
            >
              <p style="margin: 0; font-size: 14px; margin-bottom: 10px">
                ğŸ’¡ <strong>ì•Œë¦¼:</strong> ì…ë ¥í•œ ì •ë³´ë¥¼ ì €ì¥í•˜ë©´ ë‹¤ìŒì—ë„ ì‚¬ìš©í• 
                ìˆ˜ ìˆìŠµë‹ˆë‹¤!
              </p>
              <div style="display: flex; gap: 10px">
                <button
                  type="button"
                  id="loadStoreInfoBtn"
                  class="btn"
                  style="
                    flex: 1;
                    background: white;
                    color: var(--accent-color);
                    border: 2px solid white;
                    font-size: 12px;
                  "
                >
                  ğŸ“¥ ì €ì¥ëœ ì •ë³´<br />ë¶ˆëŸ¬ì˜¤ê¸°
                </button>
                <button
                  type="button"
                  id="saveStoreInfoBtn"
                  class="btn"
                  style="
                    flex: 1;
                    background: transparent;
                    color: white;
                    border: 2px solid white;
                    font-size: 12px;
                  "
                >
                  ğŸ“Œ í¬ì¸íŠ¸<br />ì €ì¥í•˜ê¸°
                </button>
              </div>
            </div>

            <div class="form-group">
              <label for="ownerTips">
                <i class="fas fa-lightbulb"></i>
                ì‚¬ì¥ë‹˜ ì¶”ì²œ í¬ì¸íŠ¸ (ì„ íƒì‚¬í•­)
              </label>
              <textarea
                id="ownerTips"
                class="textarea-field"
                placeholder="ê°•ì¡°í•˜ê³  ì‹¶ì€ ë©”ë‰´, ë¶„ìœ„ê¸°, íŠ¹ì§• ë“±ì„ ììœ ë¡­ê²Œ ì‘ì„±í•´ì£¼ì„¸ìš”.&#10;&#10;ì˜ˆì‹œ:&#10;- ì‹œê·¸ë‹ˆì²˜ ë©”ë‰´: ëƒ‰ë©´, ê°ˆë¹„íƒ•&#10;- ë¶„ìœ„ê¸°: ê°€ì¡± ëª¨ì„ì— ì¢‹ì€ ë„“ì€ í™€&#10;- íŠ¹ì§•: ì§ì ‘ ë§Œë“  ìœ¡ìˆ˜, ì£¼ì°¨ ê°€ëŠ¥&#10;- ì¶”ì²œ: ê³ ê¸°ì™€ ëƒ‰ë©´ì˜ ì¡°í•©ì´ ì¼í’ˆ"
              ></textarea>
              <small
                style="
                  color: var(--text-secondary);
                  display: block;
                  margin-top: 8px;
                "
              >
                <strong>ğŸ’¡ Tip:</strong> ì…ë ¥í•œ ì •ë³´ëŠ” ì•„ë˜ "ì €ì¥í•˜ê¸°" ë²„íŠ¼ìœ¼ë¡œ
                ì €ì¥í•˜ë©´ ë‹¤ìŒì—ë„ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤!
              </small>
            </div>

            <!-- ë‹µê¸€ ìŠ¤íƒ€ì¼ ì„ íƒ ì•ˆë‚´ -->
            <div
              style="
                background: white;
                border: 2px solid var(--accent-color);
                border-radius: 10px;
                padding: 15px;
                margin-bottom: 20px;
              "
            >
              <p
                style="
                  margin: 0 0 10px 0;
                  color: var(--accent-color);
                  font-weight: 600;
                "
              >
                <i class="fas fa-palette"></i> ë‹µê¸€ ìŠ¤íƒ€ì¼ì„ ì„ íƒí•˜ì„¸ìš” (ì ì¬
                ê³ ê°ì—ê²Œ ë³´ì´ëŠ” í™ë³´ íš¨ê³¼ë¥¼ ê³ ë ¤)
              </p>
              <p
                style="
                  margin: 0;
                  color: var(--accent-color);
                  font-size: 14px;
                  opacity: 0.8;
                "
              >
                ğŸ’¡ ë¦¬ë·° ë‹µê¸€ì€ ì²˜ìŒ ë°©ë¬¸ì„ ê³ ë ¤í•˜ëŠ” ë‹¤ë¥¸ ì‚¬ëŒë“¤ì´ ì½ìŠµë‹ˆë‹¤!
              </p>
            </div>

            <div
              class="button-group"
              style="
                display: grid;
                grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
                gap: 15px;
              "
            >
              <button class="btn" id="replyPromoBtn" style="background: white; color: var(--accent-color); border: 2px solid var(--accent-color);">
                í™ë³´í˜• (ì¶”ì²œ)
              </button>
              <button class="btn" id="replyProfessionalBtn">ì „ë¬¸ê°€í˜•</button>
              <button class="btn" id="replyFriendlyBtn">ì¹œê·¼í˜•</button>
            </div>

            <div
              style="
                background: white;
                border: 2px solid var(--accent-color);
                border-radius: 8px;
                padding: 12px;
                margin-top: 15px;
                margin-bottom: 30px;
              "
            >
              <p
                style="
                  margin: 0;
                  color: var(--accent-color);
                  font-size: 13px;
                  line-height: 1.6;
                "
              >
                <strong> í™ë³´í˜•:</strong> ë‹¤ë¥¸ ë©”ë‰´, ì£¼ì°¨, ì˜ˆì•½ ë“± ì¶”ê°€ ì •ë³´ë¥¼
                ì ê·¹ ì–¸ê¸‰ (ë°©ë¬¸ ìœ ë„ ìµœëŒ€í™”)<br />
                <strong> ì „ë¬¸ê°€í˜•:</strong> ì¬ë£Œ, ì¡°ë¦¬ë²• ì„¤ëª…ìœ¼ë¡œ ì „ë¬¸ì„±ê³¼
                ì‹ ë¢°ê° ê°•ì¡°<br />
                <strong> ì¹œê·¼í˜•:</strong> ë”°ëœ»í•˜ê³  ë¶€ë“œëŸ¬ìš´ í†¤ìœ¼ë¡œ ë‹¨ê³¨ ê³ ê°
                ë§Œë“¤ê¸°
              </p>
            </div>

            <!-- ë‹µê¸€ ìƒì„± ìƒíƒœ í‘œì‹œ ì˜ì—­ -->
            <div
              id="placeInfoStatus"
              class="place-info-status hidden"
              style="
                display: none;
                background: #f0fdf4;
                border: 1px solid #22c55e;
                border-radius: 8px;
                padding: 12px;
                margin: 15px 0;
                color: #15803d;
              "
            >
              <i class="fas fa-check-circle"></i>
              <span id="placeInfoText">ë‹µê¸€ ìƒì„± ì¤‘...</span>
            </div>

            <div class="result-section">
              <h3 style="display: flex; align-items: center; justify-content: space-between; gap: 12px;">
                <span style="display: flex; align-items: center; gap: 8px;">
                  <i class="fas fa-comment-dots"></i>
                  ìƒì„±ëœ ë‹µê¸€
                </span>
                <button
                  id="copyReplyBtn"
                  class="copy-btn"
                  title="ë‹µê¸€ ë³µì‚¬í•˜ê¸°"
                >
                  <i class="fas fa-copy"></i>
                  ë³µì‚¬
                </button>
              </h3>
              <div id="reviewOutput" class="result-content"></div>
            </div>

            <div
              style="
                background: #f8fafc;
                padding: 20px;
                border-radius: 12px;
                border: 1px solid #e2e8f0;
                margin-top: 24px;
              "
            >
              <h4 style="color: var(--text-primary); margin-bottom: 12px">
                <i class="fas fa-info-circle"></i>
                ê¸°ëŠ¥ ì•ˆë‚´
              </h4>
              <ul
                style="
                  color: var(--text-secondary);
                  font-size: 14px;
                  line-height: 1.6;
                  padding-left: 24px;
                  list-style-position: outside;
                "
              >
                <li style="margin-bottom: 8px">
                  <strong> ì‚¬ì¥ë‹˜ ì¶”ì²œ í¬ì¸íŠ¸ (ì„ íƒ):</strong> ê°•ì¡°í•˜ê³  ì‹¶ì€
                  ë©”ë‰´, ë¶„ìœ„ê¸°, íŠ¹ì§•ì„ ì§ì ‘ ì…ë ¥í•˜ë©´ AIê°€ ì´ë¥¼ ìš°ì„  ë°˜ì˜í•˜ì—¬
                  ë‹µê¸€ì„ ì‘ì„±í•©ë‹ˆë‹¤.
                </li>
                <li style="margin-bottom: 8px">
                  <strong> ë‹µê¸€ ìƒì„±í•˜ê¸°:</strong> ì‹ë‹¹ ì •ë³´ì™€ ì‚¬ì¥ë‹˜ ì¶”ì²œ
                  ì •ë³´ë¥¼ ë°˜ì˜í•˜ì—¬ ì „ë¬¸ì ì´ê³  ê³µì†í•œ ë‹µê¸€ì„ ìë™ìœ¼ë¡œ ì‘ì„±í•©ë‹ˆë‹¤.
                  ìƒˆë¡œìš´ ê³ ê°ë“¤ì´ ë³´ëŠ” ë‹µê¸€ì´ë¯€ë¡œ ìì—°ìŠ¤ëŸ¬ìš´ í™ë³´ íš¨ê³¼ë„
                  ìˆìŠµë‹ˆë‹¤!
                </li>
                <li style="margin-bottom: 8px">
                  <strong>Tip:</strong> ë¦¬ë·°ì—ì„œ ê³ ê°ì´ ê¶ê¸ˆí•´í•˜ëŠ” ë‹¤ë¥¸ ë©”ë‰´ê°€
                  ìˆë‹¤ë©´, AIê°€ ì‹ë‹¹ ì •ë³´ë¥¼ ë°”íƒ•ìœ¼ë¡œ ìë™ìœ¼ë¡œ ì¶”ì²œí•´ë“œë¦½ë‹ˆë‹¤.
                </li>
                <li>ìƒì„±ëœ ë‹µê¸€ì€ ììœ ë¡­ê²Œ ìˆ˜ì •í•˜ì—¬ ì‚¬ìš©í•˜ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</li>
              </ul>
            </div>
          </div>
        </div>
      </div>

      <script>
        // ë°±ì—”ë“œ ì„œë²„ ì„¤ì •: ìƒëŒ€ ê²½ë¡œ(`/api`) ì‚¬ìš©
        console.log("Using backend URL:", "/api");

        // DOM ìš”ì†Œ
        const ownerTips = document.getElementById("ownerTips");
        const reviewText = document.getElementById("reviewText");
        const replyPromoBtn = document.getElementById("replyPromoBtn");
        const replyProfessionalBtn = document.getElementById(
          "replyProfessionalBtn"
        );
        const replyFriendlyBtn = document.getElementById("replyFriendlyBtn");
        const reviewOutput = document.getElementById("reviewOutput");
        const placeInfoStatus = document.getElementById("placeInfoStatus");
        const placeInfoText = document.getElementById("placeInfoText");
        const loadStoreInfoBtn = document.getElementById("loadStoreInfoBtn");
        const saveStoreInfoBtn = document.getElementById("saveStoreInfoBtn");
        const copyReplyBtn = document.getElementById("copyReplyBtn");

        // í”„ë¡œëª¨ì…˜ ë°ì´í„° ì „ì—­ ë³€ìˆ˜
        let globalPromotionData = null;
        let globalHasPromotion = false;
        
        // ê°€ê²Œ ì •ë³´ ì „ì—­ ë³€ìˆ˜
        let globalPlaceInfo = null;
        
        // ë‹µê¸€ ìƒì„± ëŒ€ê¸° ë³€ìˆ˜
        let pendingReplyGeneration = null;

        // ê³µí†µ ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜
        function setLoading(el, isLoading, textWhenLoading = "ì²˜ë¦¬ ì¤‘...") {
          if (!el) return;
          el.dataset._originalText = el.dataset._originalText || el.textContent;
          el.disabled = !!isLoading;
          if (isLoading) {
            el.innerHTML = `<i class="fas fa-spinner fa-spin"></i> ${textWhenLoading}`;
          } else {
            el.textContent = el.dataset._originalText;
          }
        }

        // ì‹ë‹¹ ì •ë³´ ìƒíƒœ í‘œì‹œ í•¨ìˆ˜
        function showPlaceInfoStatus(message, status = "success") {
          // status: "loading", "success", "warning"
          placeInfoStatus.classList.remove("hidden", "loading", "warning");
          placeInfoStatus.style.display = "block";
          placeInfoText.textContent = message;

          const icon = placeInfoStatus.querySelector("i");

          if (status === "loading") {
            placeInfoStatus.classList.add("loading");
            placeInfoStatus.style.background = "#fef3c7";
            placeInfoStatus.style.borderColor = "#f59e0b";
            placeInfoStatus.style.color = "#92400e";
            icon.className = "fas fa-spinner fa-spin";
          } else if (status === "warning") {
            placeInfoStatus.classList.add("warning");
            placeInfoStatus.style.background = "#fef2f2";
            placeInfoStatus.style.borderColor = "#ef4444";
            placeInfoStatus.style.color = "#dc2626";
            icon.className = "fas fa-exclamation-triangle";
          } else {
            placeInfoStatus.style.background = "#f0fdf4";
            placeInfoStatus.style.borderColor = "#22c55e";
            placeInfoStatus.style.color = "#15803d";
            icon.className = "fas fa-check-circle";
          }
        }

        function hidePlaceInfoStatus() {
          placeInfoStatus.style.display = "none";
        }

        async function readJsonSafely(res) {
          const contentType = res.headers.get("content-type") || "";
          if (contentType.includes("application/json")) {
            try {
              return await res.json();
            } catch (_) {
              return { error: "JSON íŒŒì‹± ì‹¤íŒ¨", status: res.status };
            }
          }
          try {
            const text = await res.text();
            return text
              ? { error: text, status: res.status }
              : { status: res.status };
          } catch (_) {
            return {
              error: "ì‘ë‹µ ë³¸ë¬¸ì„ ì½ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.",
              status: res.status,
            };
          }
        }

        function showOutput(data) {
          reviewOutput.classList.remove("error");
          try {
            if (typeof data === "string") {
              reviewOutput.textContent = data.trim();
            } else {
              reviewOutput.textContent = JSON.stringify(data, null, 2);
            }
            
            // ë‹µê¸€ì´ ìƒì„±ë˜ë©´ ë³µì‚¬ ë²„íŠ¼ í™œì„±í™”
            if (copyReplyBtn && reviewOutput.textContent.trim()) {
              copyReplyBtn.classList.add("active");
              copyReplyBtn.style.opacity = "1";
              copyReplyBtn.style.pointerEvents = "auto";
            }
          } catch (e) {
            reviewOutput.textContent = String(data);
            
            // ë‹µê¸€ì´ ìƒì„±ë˜ë©´ ë³µì‚¬ ë²„íŠ¼ í™œì„±í™”
            if (copyReplyBtn && reviewOutput.textContent.trim()) {
              copyReplyBtn.classList.add("active");
              copyReplyBtn.style.opacity = "1";
              copyReplyBtn.style.pointerEvents = "auto";
            }
          }
        }

        function showError(err) {
          reviewOutput.classList.add("error");

          // ì—ëŸ¬ ìƒì„¸ ì •ë³´ë¥¼ ì½˜ì†”ì— ì¶œë ¥
          console.error("ìƒì„¸ ì—ëŸ¬ ì •ë³´:", err);

          let errorMessage = "ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.";

          // ë‹¤ì–‘í•œ ì—ëŸ¬ í˜•ì‹ì—ì„œ ë©”ì‹œì§€ ì¶”ì¶œ
          if (err?.error) {
            errorMessage = err.error;
          } else if (err?.message) {
            errorMessage = err.message;
          } else if (err?.raw) {
            errorMessage = err.raw;
          } else if (err?.errorText) {
            errorMessage = err.errorText;
          } else if (typeof err === "string") {
            errorMessage = err;
          }

          // TypeError: Failed to fetch ë“±ì˜ ë„¤íŠ¸ì›Œí¬ ì—ëŸ¬ ì²˜ë¦¬
          if (
            errorMessage.includes("Failed to fetch") ||
            errorMessage.includes("NetworkError")
          ) {
            errorMessage =
              "ì„œë²„ì— ì—°ê²°í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ì„œë²„ê°€ ì‹¤í–‰ ì¤‘ì¸ì§€ í™•ì¸í•´ì£¼ì„¸ìš”.";
          }

          reviewOutput.textContent = errorMessage;
          
          // ì—ëŸ¬ ë°œìƒ ì‹œ ë³µì‚¬ ë²„íŠ¼ ë¹„í™œì„±í™”
          if (copyReplyBtn) {
            copyReplyBtn.classList.remove("active");
            copyReplyBtn.style.opacity = "0.6";
            copyReplyBtn.style.pointerEvents = "none";
          }
        }

        // ë‹µê¸€ ë³µì‚¬ í•¨ìˆ˜
        async function copyReplyToClipboard() {
          if (!copyReplyBtn || !reviewOutput) return;
          
          const textToCopy = reviewOutput.textContent.trim();
          
          if (!textToCopy || textToCopy === "ìƒì„±ëœ ë‹µê¸€ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤...") {
            alert("ë³µì‚¬í•  ë‹µê¸€ì´ ì—†ìŠµë‹ˆë‹¤.");
            return;
          }

          try {
            // í´ë¦½ë³´ë“œ API ì‚¬ìš©
            await navigator.clipboard.writeText(textToCopy);
            
            // ë³µì‚¬ ì„±ê³µ í”¼ë“œë°±
            const originalText = copyReplyBtn.innerHTML;
            copyReplyBtn.classList.add("copied");
            copyReplyBtn.innerHTML = '<i class="fas fa-check"></i> ë³µì‚¬ë¨!';
            
            // 2ì´ˆ í›„ ì›ë˜ ìƒíƒœë¡œ ë³µêµ¬
            setTimeout(() => {
              copyReplyBtn.classList.remove("copied");
              copyReplyBtn.innerHTML = originalText;
            }, 2000);
            
          } catch (err) {
            console.error("ë³µì‚¬ ì‹¤íŒ¨:", err);
            
            // í´ë¦½ë³´ë“œ API ì‹¤íŒ¨ ì‹œ fallback ë°©ë²• ì‚¬ìš©
            try {
              const textArea = document.createElement("textarea");
              textArea.value = textToCopy;
              textArea.style.position = "fixed";
              textArea.style.left = "-999999px";
              textArea.style.top = "-999999px";
              document.body.appendChild(textArea);
              textArea.focus();
              textArea.select();
              
              const successful = document.execCommand("copy");
              document.body.removeChild(textArea);
              
              if (successful) {
                const originalText = copyReplyBtn.innerHTML;
                copyReplyBtn.classList.add("copied");
                copyReplyBtn.innerHTML = '<i class="fas fa-check"></i> ë³µì‚¬ë¨!';
                
                setTimeout(() => {
                  copyReplyBtn.classList.remove("copied");
                  copyReplyBtn.innerHTML = originalText;
                }, 2000);
              } else {
                alert("ë³µì‚¬ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ë‹µê¸€ì„ ì§ì ‘ ì„ íƒí•˜ì—¬ ë³µì‚¬í•´ì£¼ì„¸ìš”.");
              }
            } catch (fallbackErr) {
              console.error("Fallback ë³µì‚¬ë„ ì‹¤íŒ¨:", fallbackErr);
              alert("ë³µì‚¬ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ë‹µê¸€ì„ ì§ì ‘ ì„ íƒí•˜ì—¬ ë³µì‚¬í•´ì£¼ì„¸ìš”.");
            }
          }
        }

        // ê°€ê²Œ ì •ë³´ ì €ì¥ ê¸°ëŠ¥ (localStorage ê¸°ë°˜)
        async function saveStoreInfo() {
          try {
            const storeInfo = {
              ownerTips: ownerTips.value.trim(),
            };

            // localStorageì— ì €ì¥
            localStorage.setItem(
              "aiReviewStoreInfo",
              JSON.stringify(storeInfo)
            );

            alert("âœ… í¬ì¸íŠ¸ê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!");
          } catch (error) {
            console.error("ì €ì¥ ì˜¤ë¥˜:", error);
            alert("âŒ ì €ì¥ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.\n" + error.message);
          }
        }

        // ê°€ê²Œ ì •ë³´ ë¶ˆëŸ¬ì˜¤ê¸° ê¸°ëŠ¥ (localStorage ê¸°ë°˜)
        async function loadStoreInfo() {
          try {
            const saved = localStorage.getItem("aiReviewStoreInfo");

            if (!saved) {
              alert("ì €ì¥ëœ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.");
              return;
            }

            const storeInfo = JSON.parse(saved);

            if (storeInfo.ownerTips) {
              ownerTips.value = storeInfo.ownerTips;
            }

            alert("âœ… ì €ì¥ëœ ì •ë³´ë¥¼ ë¶ˆëŸ¬ì™”ìŠµë‹ˆë‹¤!");
          } catch (error) {
            console.error("ë¶ˆëŸ¬ì˜¤ê¸° ì˜¤ë¥˜:", error);
            alert("âŒ ì •ë³´ ë¶ˆëŸ¬ì˜¤ê¸°ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.\n" + error.message);
          }
        }

        // í˜„ì¬ ì‚¬ìš©ì ID ê°€ì ¸ì˜¤ê¸° (profiles í…Œì´ë¸”ì˜ id)
        async function getUserId() {
          try {
            // Supabase í´ë¼ì´ì–¸íŠ¸ ì´ˆê¸°í™”
            if (!window.authState?.supabase) {
              console.warn("[userId] Supabase í´ë¼ì´ì–¸íŠ¸ê°€ ì—†ìŠµë‹ˆë‹¤.");
              // localStorageì—ì„œ ê°€ì ¸ì˜¤ê¸° (fallback)
              const userData = getCurrentUser();
              return userData?.id || null;
            }

            const supabase = window.authState.supabase;
            
            // 1. Supabase ì„¸ì…˜ì—ì„œ auth user ê°€ì ¸ì˜¤ê¸°
            const { data: sessionData } = await supabase.auth.getSession();
            if (!sessionData?.session?.user) {
              console.warn("[userId] ì„¸ì…˜ì´ ì—†ìŠµë‹ˆë‹¤.");
              // localStorageì—ì„œ ê°€ì ¸ì˜¤ê¸° (fallback)
              const userData = getCurrentUser();
              return userData?.id || null;
            }

            const authUser = sessionData.session.user;
            
            // 2. profiles í…Œì´ë¸”ì—ì„œ profiles.id ê°€ì ¸ì˜¤ê¸°
            const { data: profile, error: profileError } = await supabase
              .from('profiles')
              .select('id')
              .eq('kakao_id', authUser.user_metadata?.kakao_id || authUser.id)
              .single();

            if (profileError || !profile) {
              console.warn("[userId] profilesë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤:", profileError);
              // profilesë¥¼ ì°¾ì§€ ëª»í•˜ë©´ auth user id ë°˜í™˜ (APIì—ì„œ ë³€í™˜ ì‹œë„)
              return authUser.id;
            }

            console.log("[userId] profiles.id ì°¾ìŒ:", profile.id);
            return profile.id; // profiles í…Œì´ë¸”ì˜ id ë°˜í™˜

          } catch (error) {
            console.warn("[userId] ì‚¬ìš©ì IDë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤:", error);
            // ì—ëŸ¬ ë°œìƒ ì‹œ localStorageì—ì„œ ê°€ì ¸ì˜¤ê¸° (fallback)
            const userData = getCurrentUser();
            return userData?.id || null;
          }
        }

        // ë“±ê¸‰ ì •ê·œí™” í•¨ìˆ˜ (mypage.htmlê³¼ ë™ì¼)
        function normalizeMembershipLevel(level) {
          if (!level) {
            return 'seed';
          }
          const normalized = level.toLowerCase();
          // FREE ë˜ëŠ” freeë¥¼ seedë¡œ ë³€í™˜
          if (normalized === 'free') {
            return 'seed';
          }
          // big_powerë¥¼ bigpowerë¡œ ë³€í™˜
          if (normalized === 'big_power') {
            return 'bigpower';
          }
          return normalized;
        }

        // í† í° ì •ë³´ ì¡°íšŒ í•¨ìˆ˜ (mypage.htmlê³¼ ë™ì¼í•œ ë¡œì§)
        async function fetchTokenInfo() {
          try {
            // ë°ëª¨ ëª¨ë“œì¼ ë•ŒëŠ” ë¬´ì œí•œ í† í° ë°˜í™˜
            if (window.isDemoMode && window.isDemoMode()) {
              console.log('âœ… [ë°ëª¨ ëª¨ë“œ] í† í° ì¡°íšŒ ìš°íšŒ - ë¬´ì œí•œ í† í° ë°˜í™˜');
              return {
                remaining: 999999,
                used: 0,
                limit: 999999,
                isUnlimited: true
              };
            }
            
            // Supabase ì„¸ì…˜ í† í° ê°€ì ¸ì˜¤ê¸°
            if (!window.authState?.supabase) {
              console.warn('âš ï¸ [í† í° ì¡°íšŒ] Supabase í´ë¼ì´ì–¸íŠ¸ê°€ ì—†ìŠµë‹ˆë‹¤.');
              return null;
            }

            const supabase = window.authState.supabase;
            const { data: { session } } = await supabase.auth.getSession();
            
            if (!session?.access_token) {
              console.error('âŒ [í† í° ì¡°íšŒ] ì„¸ì…˜ í† í°ì´ ì—†ìŠµë‹ˆë‹¤');
              return null;
            }

            // ì„œë²„ APIë¥¼ í†µí•´ í† í° ì •ë³´ ê°€ì ¸ì˜¤ê¸° (mypage.htmlê³¼ ë™ì¼)
            const response = await fetch('/api/subscription/user-dashboard?action=dashboard', {
              method: 'GET',
              headers: {
                'Content-Type': 'application/json',
                'Authorization': `Bearer ${session.access_token}`
              }
            });

            if (!response.ok) {
              console.error('âŒ [í† í° ì¡°íšŒ] API ì‘ë‹µ ì‹¤íŒ¨:', response.status);
              return null;
            }

            const result = await response.json();
            
            if (!result.success || !result.data) {
              console.warn('âš ï¸ [í† í° ì¡°íšŒ] API ì‘ë‹µ ì‹¤íŒ¨:', result.error || 'ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜');
              return null;
            }

            const { profile, cycle } = result.data;
            
            if (cycle) {
              // ë“±ê¸‰ ì •ê·œí™” (mypage.htmlê³¼ ë™ì¼)
              const normalizedLevel = normalizeMembershipLevel(profile?.membership_level);
              const isAdmin = normalizedLevel === 'admin' || profile?.user_type === 'admin';
              
              // í† í° ì‚¬ìš©ëŸ‰ ê³„ì‚°
              const tokensUsed = cycle.tokens_used || 0;
              let tokensLimit = cycle.monthly_token_limit || 100;
              let tokensRemaining = cycle.tokens_remaining || tokensLimit;
              
              // ê´€ë¦¬ì ë“±ê¸‰ ë˜ëŠ” ë§¤ìš° í° ê°’(999999 ì´ìƒ)ì€ ë¬´ì œí•œìœ¼ë¡œ ì²˜ë¦¬
              if (isAdmin || (tokensLimit && tokensLimit >= 999999)) {
                tokensLimit = null;
                tokensRemaining = null;
              }
              
              return {
                remaining: tokensRemaining,
                used: tokensUsed,
                limit: tokensLimit,
                isUnlimited: tokensRemaining === null || tokensLimit === null
              };
            } else {
              // cycleì´ ì—†ì„ ë•Œ ê¸°ë³¸ê°’ ë°˜í™˜
              return {
                remaining: 100,
                used: 0,
                limit: 100,
                isUnlimited: false
              };
            }
          } catch (error) {
            console.error('âŒ [í† í° ì¡°íšŒ] ì˜ˆì™¸ ë°œìƒ:', error);
            return null;
          }
        }

        // í† í° ëª¨ë‹¬ í‘œì‹œ
        async function showTokenModal(showWarning = false) {
          const modal = document.getElementById('tokenModal');
          if (!modal) {
            console.error('âŒ [í† í° ëª¨ë‹¬] ëª¨ë‹¬ ìš”ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤');
            return;
          }

          const estimatedTokens = 500;
          const warningBox = document.getElementById('tokenWarningBox');
          const modalIcon = document.querySelector('.token-modal-icon');
          
          // ê²½ê³  ë©”ì‹œì§€ ì´ˆê¸°í™”
          if (warningBox) {
            warningBox.classList.add('hidden');
          }
          if (modalIcon) {
            modalIcon.classList.remove('warning');
            modalIcon.innerHTML = '<i class="fa-solid fa-coins"></i>';
          }
          
          // ë¡œë”© ìƒíƒœ í‘œì‹œ
          document.getElementById('remainingTokens').textContent = 'ì¡°íšŒ ì¤‘...';
          document.getElementById('afterTokens').textContent = 'ì¡°íšŒ ì¤‘...';
          document.getElementById('estimatedTokens').textContent = estimatedTokens.toLocaleString() + ' í† í°';
          
          modal.classList.add('active');
          
          // í† í° ì •ë³´ ì¡°íšŒ
          const tokenInfo = await fetchTokenInfo();
          
          if (tokenInfo) {
            const isUnlimited = tokenInfo.isUnlimited === true;
            
            if (isUnlimited) {
              // ë¬´ì œí•œ í† í°ì¸ ê²½ìš°
              document.getElementById('remainingTokens').textContent = 'ë¬´ì œí•œ';
              document.getElementById('remainingTokens').className = 'token-info-value success';
              document.getElementById('afterTokens').textContent = 'ë¬´ì œí•œ';
              document.getElementById('afterTokens').className = 'token-info-value success';
            } else {
              // ì œí•œì´ ìˆëŠ” í† í°ì¸ ê²½ìš°
              const remaining = Number(tokenInfo.remaining) || 0;
              const limit = Number(tokenInfo.limit) || 100;
              const afterTokens = remaining - estimatedTokens;
              const isInsufficient = remaining < estimatedTokens || showWarning;
              
              // í† í° ë¶€ì¡± ì‹œ ê²½ê³  í‘œì‹œ
              if (isInsufficient && warningBox) {
                warningBox.classList.remove('hidden');
              }
              if (isInsufficient && modalIcon) {
                modalIcon.classList.add('warning');
                modalIcon.innerHTML = '<i class="fa-solid fa-exclamation-triangle"></i>';
              }
              
              // í˜„ì¬ ë‚¨ì€ í† í° í‘œì‹œ
              const remainingEl = document.getElementById('remainingTokens');
              remainingEl.textContent = remaining.toLocaleString() + ' í† í°';
              remainingEl.className = 'token-info-value ' + (remaining < estimatedTokens ? 'warning' : 'success');
              
              // ì‚¬ìš© í›„ ë‚¨ì€ í† í° í‘œì‹œ
              const afterEl = document.getElementById('afterTokens');
              afterEl.textContent = afterTokens.toLocaleString() + ' í† í°';
              afterEl.className = 'token-info-value ' + (afterTokens < 0 ? 'warning' : 'success');
            }
          } else {
            // ì¡°íšŒ ì‹¤íŒ¨ ì‹œ
            document.getElementById('remainingTokens').textContent = 'ì¡°íšŒ ì‹¤íŒ¨';
            document.getElementById('remainingTokens').className = 'token-info-value warning';
            document.getElementById('afterTokens').textContent = 'í™•ì¸ ë¶ˆê°€';
            document.getElementById('afterTokens').className = 'token-info-value warning';
          }
        }

        // í† í° ëª¨ë‹¬ ë‹«ê¸°
        function closeTokenModal() {
          const modal = document.getElementById('tokenModal');
          if (modal) {
            modal.classList.remove('active');
          }
        }

        // ëª¨ë‹¬ ì™¸ë¶€ í´ë¦­ ì‹œ ë‹«ê¸°
        document.addEventListener('DOMContentLoaded', function() {
          const tokenModal = document.getElementById('tokenModal');
          if (tokenModal) {
            tokenModal.addEventListener('click', function(e) {
              if (e.target === tokenModal) {
                closeTokenModal();
              }
            });
          }
        });

        // ë‹µê¸€ ìƒì„± í™•ì¸ í›„ ì‹¤í–‰
        async function confirmReplyGeneration() {
          // ë°ëª¨ ëª¨ë“œì¼ ë•ŒëŠ” í† í° ì²´í¬ ì™„ì „íˆ ìš°íšŒ
          if (window.isDemoMode && window.isDemoMode()) {
            console.log('âœ… [ë°ëª¨ ëª¨ë“œ] í† í° ì²´í¬ ìš°íšŒ - ë‹µê¸€ ìƒì„± ì§„í–‰');
            closeTokenModal();
            
            if (pendingReplyGeneration) {
              const { style, buttonElement } = pendingReplyGeneration;
              pendingReplyGeneration = null;
              await executeReplyGeneration(style, buttonElement);
            }
            return;
          }
          
          const estimatedTokens = 500;
          const tokenInfo = await fetchTokenInfo();
          
          if (!tokenInfo) {
            alert('í† í° ì •ë³´ë¥¼ í™•ì¸í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.');
            return;
          }
          
          // ë¬´ì œí•œì´ ì•„ë‹Œ ê²½ìš° í† í° ë¶€ì¡± ì²´í¬
          if (!tokenInfo.isUnlimited) {
            const remaining = Number(tokenInfo.remaining) || 0;
            if (remaining < estimatedTokens) {
              // í† í° ë¶€ì¡± ì‹œ ëª¨ë‹¬ì„ ë‹«ì§€ ì•Šê³  ê²½ê³  í‘œì‹œ
              const warningBox = document.getElementById('tokenWarningBox');
              const modalIcon = document.querySelector('.token-modal-icon');
              
              if (warningBox) {
                warningBox.classList.remove('hidden');
              }
              if (modalIcon) {
                modalIcon.classList.add('warning');
                modalIcon.innerHTML = '<i class="fa-solid fa-exclamation-triangle"></i>';
              }
              
              alert(`í† í°ì´ ë¶€ì¡±í•©ë‹ˆë‹¤.\n\ní˜„ì¬ ë‚¨ì€ í† í°: ${remaining.toLocaleString()} í† í°\ní•„ìš”í•œ í† í°: ${estimatedTokens.toLocaleString()} í† í°\n\ní† í°ì„ ì¶©ì „í•˜ê±°ë‚˜ êµ¬ë…ì„ ì—…ê·¸ë ˆì´ë“œí•´ì£¼ì„¸ìš”.`);
              return;
            }
          }
          
          // í† í°ì´ ì¶©ë¶„í•œ ê²½ìš°ì—ë§Œ ì§„í–‰
          closeTokenModal();
          
          if (pendingReplyGeneration) {
            const { style, buttonElement } = pendingReplyGeneration;
            pendingReplyGeneration = null;
            await executeReplyGeneration(style, buttonElement);
          }
        }

        // ê°€ê²Œ ì •ë³´ ë¶ˆëŸ¬ì˜¤ê¸°
        async function loadPlaceInfo() {
          try {
            const userId = await getUserId();
            if (!userId) {
              console.warn('âš ï¸ [ê°€ê²Œ ì •ë³´] ì‚¬ìš©ì IDê°€ ì—†ìŠµë‹ˆë‹¤.');
              return null;
            }

            const response = await fetch(`/api/store-info?userId=${userId}`);
            if (!response.ok) {
              console.warn('âš ï¸ [ê°€ê²Œ ì •ë³´] ì¡°íšŒ ì‹¤íŒ¨:', response.status);
              return null;
            }

            const result = await response.json();
            if (result.success && result.data) {
              const storeData = result.data;
              
              // placeInfo í˜•ì‹ìœ¼ë¡œ ë³€í™˜
              const placeInfo = {
                basic: {
                  name: storeData.store_name || null,
                  category: null,
                },
                contact: {
                  road_address: storeData.store_address || null,
                  phone_display: storeData.store_phone_number || null,
                },
                business: {
                  hours: storeData.store_business_hours || null,
                },
                menu: storeData.store_main_menu || null,
                landmarks: storeData.store_landmarks || null,
                keywords: storeData.store_keywords || null,
              };
              
              return placeInfo;
            }
            return null;
          } catch (error) {
            console.error('âŒ [ê°€ê²Œ ì •ë³´] ì¡°íšŒ ì˜¤ë¥˜:', error);
            return null;
          }
        }

        // ë‹µê¸€ ìƒì„± ì‹¤í–‰ í•¨ìˆ˜
        async function executeReplyGeneration(style, buttonElement) {
          const text = reviewText.value.trim();
          const tips = ownerTips.value.trim();

          if (!text) {
            showError({ message: "ë¦¬ë·° ì›ë¬¸ì„ ì…ë ¥í•˜ì„¸ìš”." });
            return;
          }

          setLoading(buttonElement, true, "ìƒì„± ì¤‘...");
          reviewOutput.textContent = "";
          
          // ë‹µê¸€ ìƒì„± ì‹œì‘ ì‹œ ë³µì‚¬ ë²„íŠ¼ ë¹„í™œì„±í™”
          if (copyReplyBtn) {
            copyReplyBtn.classList.remove("active", "copied");
            copyReplyBtn.style.opacity = "0.6";
            copyReplyBtn.style.pointerEvents = "none";
            copyReplyBtn.innerHTML = '<i class="fas fa-copy"></i> ë³µì‚¬';
          }
          
          showPlaceInfoStatus("ğŸ’­ ë‹µê¸€ ìƒì„± ì¤‘", "loading");

          try {
            // ì‚¬ìš©ì ID ê°€ì ¸ì˜¤ê¸°
            const userId = await getUserId();

            // ê°€ê²Œ ì •ë³´ ë¶ˆëŸ¬ì˜¤ê¸° (ì—†ìœ¼ë©´ null)
            if (!globalPlaceInfo) {
              globalPlaceInfo = await loadPlaceInfo();
            }

            // ë‹µê¸€ ìƒì„± (ìŠ¤íƒ€ì¼ í¬í•¨)
            const requestBody = {
              reviewText: text,
              replyStyle: style, // 'promo', 'professional', 'friendly'
            };

            if (tips) {
              requestBody.ownerTips = tips;
            }

            // ê°€ê²Œ ì •ë³´ ì¶”ê°€
            if (globalPlaceInfo) {
              requestBody.placeInfo = globalPlaceInfo;
            }

            // ì‚¬ìš©ì ID ì¶”ê°€
            if (userId) {
              requestBody.userId = userId;
            }

            // í”„ë¡œëª¨ì…˜ ì •ë³´ ì¶”ê°€
            if (globalHasPromotion && globalPromotionData) {
              requestBody.promotionData = globalPromotionData;
              requestBody.hasPromotion = true;
            }

            const replyController = new AbortController();
            const replyTimeoutId = setTimeout(
              () => replyController.abort(),
              15000
            );

            let res;
            try {
              res = await fetch(`/api/generate-reply`, {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify(requestBody),
                signal: replyController.signal,
              });
              clearTimeout(replyTimeoutId);
            } catch (fetchError) {
              clearTimeout(replyTimeoutId);

              if (fetchError.name === "AbortError") {
                throw new Error(
                  "ë‹µê¸€ ìƒì„± ì‹œê°„ì´ ì´ˆê³¼ë˜ì—ˆìŠµë‹ˆë‹¤. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”."
                );
              }

              throw new Error(
                "ì„œë²„ì— ì—°ê²°í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ì„œë²„ê°€ ì‹¤í–‰ ì¤‘ì¸ì§€ í™•ì¸í•´ì£¼ì„¸ìš”."
              );
            }

            const data = await readJsonSafely(res);

            if (!res.ok || data.success === false) {
              if (res.status === 405) {
                throw new Error("ì„œë²„ê°€ ì‹¤í–‰ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.");
              } else if (res.status === 500) {
                throw new Error(
                  data.error ||
                    "ì„œë²„ ë‚´ë¶€ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”."
                );
              } else if (res.status === 400) {
                throw new Error(
                  data.error || "ì…ë ¥ ë°ì´í„°ê°€ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤."
                );
              } else {
                throw new Error(
                  data.error || data.message || `ì„œë²„ ì˜¤ë¥˜ (${res.status})`
                );
              }
            }

            showOutput(data.data?.reply || data.reply || data);

            // ê¸°ëŠ¥ ì‚¬ìš© ê¸°ë¡ ë‚¨ê¸°ê¸°
            if (window.trackFeatureUsage) {
                window.trackFeatureUsage('review', 'ë¦¬ë·°', 'generate', {
                    replyStyle: style,
                    hasOwnerTips: !!tips
                });
            }

            // ì„±ê³µ ë©”ì‹œì§€ í‘œì‹œ
            const styleNames = {
              promo: "í™ë³´í˜•",
              professional: "ì „ë¬¸ê°€í˜•",
              friendly: "ì¹œê·¼í˜•",
            };
            const styleName = styleNames[style] || style;

            let successMessage = `âœ… ${styleName} ë‹µê¸€ì´ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤!`;

            showPlaceInfoStatus(successMessage, "success");
            setTimeout(() => hidePlaceInfoStatus(), 5000);
          } catch (e) {
            console.error("ë‹µê¸€ ìƒì„± ì˜¤ë¥˜:", e);
            showError(e);
            hidePlaceInfoStatus();
          } finally {
            setLoading(buttonElement, false);
          }
        }

        // ë‹µê¸€ ìƒì„± ê³µí†µ í•¨ìˆ˜ (ìŠ¤íƒ€ì¼ë³„) - í† í° í™•ì¸ í›„ ì‹¤í–‰
        async function generateReply(style, buttonElement) {
          const text = reviewText.value.trim();
          
          if (!text) {
            showError({ message: "ë¦¬ë·° ì›ë¬¸ì„ ì…ë ¥í•˜ì„¸ìš”." });
            return;
          }
          
          // í† í° í™•ì¸ íŒì—… í‘œì‹œ
          pendingReplyGeneration = { style, buttonElement };
          await showTokenModal();
        }

        // 3ê°œì˜ ë‹µê¸€ ìŠ¤íƒ€ì¼ ë²„íŠ¼ ì´ë²¤íŠ¸ (DOMContentLoaded í›„ ì‹¤í–‰)
        function initReplyButtons() {
          if (replyPromoBtn) {
            replyPromoBtn.addEventListener("click", async () => {
              await generateReply("promo", replyPromoBtn);
            });
          }

          if (replyProfessionalBtn) {
            replyProfessionalBtn.addEventListener("click", async () => {
              await generateReply("professional", replyProfessionalBtn);
            });
          }

          if (replyFriendlyBtn) {
            replyFriendlyBtn.addEventListener("click", async () => {
              await generateReply("friendly", replyFriendlyBtn);
            });
          }
        }

        // DOMì´ ë¡œë“œëœ í›„ ë²„íŠ¼ ì´ë²¤íŠ¸ ë“±ë¡
        if (document.readyState === "loading") {
          document.addEventListener("DOMContentLoaded", initReplyButtons);
        } else {
          initReplyButtons();
        }

        // ê°€ê²Œ ì •ë³´ ì €ì¥/ë¶ˆëŸ¬ì˜¤ê¸° ë²„íŠ¼ ì´ë²¤íŠ¸
        if (saveStoreInfoBtn) {
          saveStoreInfoBtn.addEventListener("click", saveStoreInfo);
        }
        if (loadStoreInfoBtn) {
          loadStoreInfoBtn.addEventListener("click", loadStoreInfo);
        }

        // ë³µì‚¬ ë²„íŠ¼ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
        if (copyReplyBtn) {
          copyReplyBtn.addEventListener("click", copyReplyToClipboard);
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸°í™”
        window.addEventListener("load", function () {
          reviewText.focus();
          // ensureAuthenticated(); // ì¹´ì¹´ì˜¤í†¡ ë¡œê·¸ì¸ ì²´í¬ ë¹„í™œì„±í™”
        });

        // ì¸ì¦ UI ì—…ë°ì´íŠ¸ í•¨ìˆ˜
        function getCurrentUser() {
          try {
            const raw = localStorage.getItem("userData");
            return raw ? JSON.parse(raw) : null;
          } catch (error) {
            console.warn("[auth] ì‚¬ìš©ì ì •ë³´ë¥¼ ì½ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤:", error);
            return null;
          }
        }

        async function getActiveSession() {
          if (!window.authState?.supabase) {
            return null;
          }
          try {
            const { data } = await window.authState.supabase.auth.getSession();
            return data?.session ?? null;
          } catch (error) {
            console.error("ì„¸ì…˜ ì¡°íšŒ ì‹¤íŒ¨:", error);
            return null;
          }
        }

        function renderLoggedOut() {
          const loginBtn = document.getElementById("loginBtn");
          const signupBtn = document.getElementById("signupBtn");
          const userEmailSpan = document.getElementById("userEmail");
          const logoutBtn = document.getElementById("logoutBtn");
          const authUser = document.getElementById("authUser");

          if (authUser) authUser.style.display = "none";
          if (loginBtn) loginBtn.style.display = "inline-flex";
          if (signupBtn) signupBtn.style.display = "inline-flex";
          if (userEmailSpan) {
            userEmailSpan.textContent = "";
            userEmailSpan.title = "";
          }
          if (logoutBtn) {
            logoutBtn.style.display = "none";
            logoutBtn.onclick = null;
          }
        }

        function renderLoggedIn(user) {
          const loginBtn = document.getElementById("loginBtn");
          const signupBtn = document.getElementById("signupBtn");
          const userEmailSpan = document.getElementById("userEmail");
          const logoutBtn = document.getElementById("logoutBtn");
          const authUser = document.getElementById("authUser");
          const userAvatar = document.getElementById("userAvatar");

          if (loginBtn) loginBtn.style.display = "none";
          if (signupBtn) signupBtn.style.display = "none";
          if (authUser) authUser.style.display = "flex";

          if (userEmailSpan) {
            const email = user.email || user.displayName || "ë§ˆì´í˜ì´ì§€";
            userEmailSpan.textContent = email;
            userEmailSpan.title = `${email} (ë§ˆì´í˜ì´ì§€ë¡œ ì´ë™)`;
          }

          if (userAvatar) {
            const base =
              user.user_metadata?.full_name ||
              user.displayName ||
              user.email ||
              user.app_metadata?.provider ||
              "U";
            const initial = (base.trim()[0] || "U").toUpperCase();
            userAvatar.textContent = initial;
            userAvatar.setAttribute("aria-label", `${base} í”„ë¡œí•„`);
          }

          if (logoutBtn) {
            logoutBtn.style.display = "inline-flex";
            logoutBtn.onclick = async function () {
              if (!confirm("ë¡œê·¸ì•„ì›ƒ í•˜ì‹œê² ìŠµë‹ˆê¹Œ?")) return;
              try {
                if (window.authState?.signOut) {
                  await window.authState.signOut();
                }
              } finally {
                localStorage.removeItem("isLoggedIn");
                localStorage.removeItem("userData");
                location.href = "login.html";
              }
            };
          }
        }

        let authRenderToken = 0;

        async function updateAuthUI() {
          const currentToken = ++authRenderToken;

          // ë¨¼ì € localStorageì—ì„œ ì‚¬ìš©ì ì •ë³´ í™•ì¸ (ë¹ ë¥¸ ì´ˆê¸° ë Œë”ë§)
          const storedUserData = getCurrentUser();
          if (storedUserData && storedUserData.email) {
            // localStorageì— ì‚¬ìš©ì ì •ë³´ê°€ ìˆìœ¼ë©´ ì¦‰ì‹œ ë¡œê·¸ì¸ ìƒíƒœë¡œ í‘œì‹œ
            if (currentToken === authRenderToken) {
              renderLoggedIn({
                email: storedUserData.email,
                displayName: storedUserData.displayName,
                user_metadata: { full_name: storedUserData.displayName },
                app_metadata: { provider: storedUserData.provider || "kakao" },
              });
            }
          } else {
            // localStorageì— ì‚¬ìš©ì ì •ë³´ê°€ ì—†ìœ¼ë©´ ë¡œê·¸ì•„ì›ƒ ìƒíƒœë¡œ í‘œì‹œ
            if (currentToken === authRenderToken) {
              renderLoggedOut();
            }
          }

          // Supabase ì„¸ì…˜ í™•ì¸ (auth-state.jsê°€ ë¡œë“œëœ ê²½ìš°)
          if (window.authState?.supabase) {
            try {
              const session = await getActiveSession();
              if (currentToken !== authRenderToken) return;

              if (session?.user) {
                renderLoggedIn(session.user);
              } else if (!storedUserData) {
                // ì„¸ì…˜ì´ ì—†ê³  localStorageì—ë„ ì—†ìœ¼ë©´ ë¡œê·¸ì•„ì›ƒ ìƒíƒœ
                renderLoggedOut();
              }
            } catch (error) {
              console.error("ì¸ì¦ ìƒíƒœ í™•ì¸ ì‹¤íŒ¨:", error);
              // ì—ëŸ¬ ë°œìƒ ì‹œ localStorage ê¸°ë°˜ìœ¼ë¡œ í‘œì‹œ
              if (currentToken === authRenderToken && !storedUserData) {
                renderLoggedOut();
              }
            }
          }
        }
      </script>
    </div>

    <!-- ê³µí†µ ì¸ì¦ ìŠ¤í¬ë¦½íŠ¸ -->
    <script
      src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.45.4/dist/umd/supabase.min.js"
      integrity="sha384-GFr3yTh5lJznCbZfpTtXnwboFsxqtTQoeTZCRHhE0579KrRmlCzen5AA8ohaB5ug"
      crossorigin="anonymous"
    ></script>
    <script src="./assets/demo-mode.js?v=20241125"></script>
    <script src="./assets/auth-state.js?v=202410"></script>
    <script src="/assets/feature-usage-tracker.js"></script>
    <script>
      // ì¸ì¦ ìƒíƒœ UI ì—…ë°ì´íŠ¸ (ì¦‰ì‹œ ì‹¤í–‰ ë° auth-state.js ë¡œë“œ í›„ ì¬ì‹¤í–‰)
      async function initAuthUI() {
        // ì¦‰ì‹œ localStorage ê¸°ë°˜ìœ¼ë¡œ UI ì—…ë°ì´íŠ¸ (ë¹ ë¥¸ ì´ˆê¸° ë Œë”ë§)
        if (typeof updateAuthUI === "function") {
          await updateAuthUI();
        }

        // auth-state.jsê°€ ë¡œë“œë  ë•Œê¹Œì§€ ëŒ€ê¸°
        let waitCount = 0;
        const maxWait = 200; // 20ì´ˆ ëŒ€ê¸°
        while (!window.authState && waitCount < maxWait) {
          await new Promise((resolve) => setTimeout(resolve, 100));
          waitCount++;
        }

        if (window.authState) {
          try {
            // Supabase ì„¸ì…˜ ë™ê¸°í™” í›„ UI ì—…ë°ì´íŠ¸
            if (window.authState?.syncSession) {
              await window.authState.syncSession();
            }
            await updateAuthUI();

            // ì¸ì¦ ìƒíƒœ ë³€ê²½ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ë“±ë¡
            window.addEventListener("auth:state-changed", updateAuthUI);
          } catch (error) {
            console.error("[auth] ì¸ì¦ UI ì—…ë°ì´íŠ¸ ì‹¤íŒ¨:", error);
            // ì—ëŸ¬ ë°œìƒ ì‹œì—ë„ localStorage ê¸°ë°˜ìœ¼ë¡œ UI í‘œì‹œ
            if (typeof updateAuthUI === "function") {
              await updateAuthUI();
            }
          }
        } else {
          console.warn(
            "[auth] auth-state.jsë¥¼ ë¡œë“œí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. localStorage ê¸°ë°˜ìœ¼ë¡œ í‘œì‹œí•©ë‹ˆë‹¤."
          );
          // auth-state.jsê°€ ë¡œë“œë˜ì§€ ì•Šì•„ë„ localStorage ê¸°ë°˜ìœ¼ë¡œ UI í‘œì‹œ
          if (typeof updateAuthUI === "function") {
            await updateAuthUI();
          }
        }
      }

      function forceUpdateAuthUI() {
        if (typeof updateAuthUI === "function") {
          updateAuthUI();
        }
      }

      // DOMContentLoaded ì‹œ ì¦‰ì‹œ ì‹¤í–‰
      if (document.readyState === "loading") {
        document.addEventListener("DOMContentLoaded", initAuthUI);
      } else {
        initAuthUI();
      }

      // í˜ì´ì§€ ë¡œë“œ ì™„ë£Œ í›„ ì¬í™•ì¸
      window.addEventListener("load", function () {
        setTimeout(function () {
          initAuthUI();
        }, 100);
      });

      // ì¸ì¦ ìƒíƒœ ë³€ê²½ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
      window.addEventListener("auth:state-changed", function () {
        if (typeof updateAuthUI === "function") {
          updateAuthUI();
        }
      });

      // í•˜ë‹¨ë°” ìŠ¬ë¼ì´ë“œ ì¸ë””ì¼€ì´í„° ì œì–´
      (function () {
        const sideNav = document.querySelector(".side-nav");
        if (!sideNav) return;

        function updateSideNavIndicator() {
          // PC í™”ë©´ì—ì„œëŠ” ì¸ë””ì¼€ì´í„° ìˆ¨ê¸°ê¸° (ì ˆëŒ€ ê±´ë“¤ì§€ ì•ŠìŒ)
          if (window.innerWidth > 992) {
            sideNav.classList.add("hide-indicator");
            return;
          }

          // ëª¨ë°”ì¼ í™”ë©´ì—ì„œë§Œ ë™ì‘
          const scrollLeft = Math.round(sideNav.scrollLeft);
          const scrollWidth = sideNav.scrollWidth;
          const clientWidth = sideNav.clientWidth;

          // ìŠ¤í¬ë¡¤ì´ ëì— ë„ë‹¬í–ˆëŠ”ì§€ í™•ì¸
          const remainingScroll = scrollWidth - scrollLeft - clientWidth;

          if (remainingScroll <= 3 || scrollWidth <= clientWidth) {
            // ìŠ¤í¬ë¡¤ì´ ëì— ë„ë‹¬í•˜ê±°ë‚˜ ìŠ¤í¬ë¡¤ì´ í•„ìš” ì—†ìœ¼ë©´ ì¸ë””ì¼€ì´í„° ìˆ¨ê¸°ê¸°
            sideNav.classList.add("hide-indicator");
          } else {
            // ìŠ¤í¬ë¡¤ ê°€ëŠ¥í•˜ë©´ ì¸ë””ì¼€ì´í„° ë³´ì´ê¸°
            sideNav.classList.remove("hide-indicator");
          }
        }

        // DOMì´ ì™„ì „íˆ ë¡œë“œëœ í›„ ì´ˆê¸° ìƒíƒœ í™•ì¸
        function initIndicator() {
          setTimeout(() => {
            updateSideNavIndicator();
          }, 300);
        }

        // ì´ˆê¸° ìƒíƒœ í™•ì¸
        if (document.readyState === "loading") {
          document.addEventListener("DOMContentLoaded", initIndicator);
        } else {
          initIndicator();
        }

        // ìŠ¤í¬ë¡¤ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
        sideNav.addEventListener("scroll", updateSideNavIndicator, {
          passive: true,
        });

        // ë¦¬ì‚¬ì´ì¦ˆ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
        let resizeTimeout;
        window.addEventListener("resize", () => {
          clearTimeout(resizeTimeout);
          resizeTimeout = setTimeout(updateSideNavIndicator, 150);
        });

        // í˜ì´ì§€ ë¡œë“œ ì™„ë£Œ í›„ ì¬í™•ì¸
        window.addEventListener("load", () => {
          setTimeout(updateSideNavIndicator, 500);
        });

        // MutationObserverë¡œ DOM ë³€ê²½ ê°ì§€ (ë™ì  ì½˜í…ì¸  ëŒ€ì‘)
        const observer = new MutationObserver(() => {
          setTimeout(updateSideNavIndicator, 100);
        });
        observer.observe(sideNav, { childList: true, subtree: true });
      })();
    </script>

    <!-- í† í° í™•ì¸ íŒì—… -->
    <div class="token-modal" id="tokenModal">
      <div class="token-modal-content">
        <div class="token-modal-header">
          <div class="token-modal-icon">
            <i class="fa-solid fa-coins"></i>
          </div>
          <h2 class="token-modal-title">í† í° ì‚¬ìš© í™•ì¸</h2>
          <p class="token-modal-subtitle">ë‹µê¸€ ìƒì„±ì— í•„ìš”í•œ í† í°ì„ í™•ì¸í•´ì£¼ì„¸ìš”</p>
        </div>
        <!-- í† í° ë¶€ì¡± ê²½ê³  ë©”ì‹œì§€ (í† í° ë¶€ì¡± ì‹œì—ë§Œ í‘œì‹œ) -->
        <div class="token-warning-box hidden" id="tokenWarningBox">
          <div class="token-warning-icon">
            <i class="fa-solid fa-exclamation-triangle"></i>
          </div>
          <div class="token-warning-title">í† í°ì´ ë¶€ì¡±í•©ë‹ˆë‹¤</div>
          <div class="token-warning-message">
            ë‹µê¸€ ìƒì„±ì— í•„ìš”í•œ í† í°ì´ ë¶€ì¡±í•©ë‹ˆë‹¤.<br>
            í† í°ì„ ì¶©ì „í•˜ê±°ë‚˜ êµ¬ë…ì„ ì—…ê·¸ë ˆì´ë“œí•´ì£¼ì„¸ìš”.
          </div>
        </div>
        <div class="token-info-box">
          <div class="token-info-item">
            <span class="token-info-label">ì˜ˆìƒ ì‚¬ìš© í† í°</span>
            <span class="token-info-value" id="estimatedTokens">500 í† í°</span>
          </div>
          <div class="token-info-item">
            <span class="token-info-label">í˜„ì¬ ë‚¨ì€ í† í°</span>
            <span class="token-info-value" id="remainingTokens">-</span>
          </div>
          <div class="token-info-item">
            <span class="token-info-label">ì‚¬ìš© í›„ ë‚¨ì€ í† í°</span>
            <span class="token-info-value" id="afterTokens">-</span>
          </div>
        </div>
        <div class="token-modal-actions">
          <button class="btn btn-secondary" onclick="closeTokenModal()">
            ì·¨ì†Œ
          </button>
          <button class="btn btn-primary" onclick="confirmReplyGeneration()">
            <i class="fa-solid fa-check"></i>
            í™•ì¸
          </button>
        </div>
      </div>
    </div>

    <!-- í‘¸í„° -->
    <footer class="site-footer">
      <div class="footer-content">
        <div class="footer-item">
          <div class="footer-label">ìƒí˜¸ëª…</div>
          <div class="footer-value">ì‚¬ì¥í”½</div>
        </div>
        <div class="footer-item">
          <div class="footer-label">ëŒ€í‘œìëª…</div>
          <div class="footer-value">ì˜¤ëŒ€ì¤€</div>
        </div>
        <div class="footer-item">
          <div class="footer-label">ì‚¬ì—…ì¥ ì£¼ì†Œì§€</div>
          <div class="footer-value">ë¶€ì‚°ê´‘ì—­ì‹œ ë¶êµ¬ ë°±ì–‘ëŒ€ë¡œ 1003 5ë™307í˜¸</div>
        </div>
        <div class="footer-item">
          <div class="footer-label">ì‚¬ì—…ì ë²ˆí˜¸</div>
          <div class="footer-value">441-31-01878</div>
        </div>
        <div class="footer-item">
          <div class="footer-label">ì´ë©”ì¼ ì£¼ì†Œ</div>
          <div class="footer-value">
            <a href="mailto:ohdaejun@naver.com">ohdaejun@naver.com</a>
          </div>
        </div>
        <div class="footer-item">
          <div class="footer-label">ì „í™”ë²ˆí˜¸</div>
          <div class="footer-value">
            <a href="tel:010-6664-3744">010-6664-3744</a>
          </div>
        </div>
      </div>
    </footer>
  </body>
</html>
