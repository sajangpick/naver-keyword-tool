<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>사장픽(sajang pick) - 메인 허브</title>
    <link
      rel="icon"
      href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'%3E%3Ccircle cx='32' cy='32' r='30' fill='%2303c75a'/%3E%3Ctext x='32' y='40' text-anchor='middle' font-size='28' font-family='Arial' fill='white'%3ESP%3C/text%3E%3C/svg%3E"
    />
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
      rel="stylesheet"
    />
    <style>
      .is-hidden {
        display: none !important;
      }
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }
      body {
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI",
          "Noto Sans KR", Arial, sans-serif;
        background: var(--bg);
        color: #111827;
      }
      a {
        color: inherit;
        text-decoration: none;
      }

      :root {
        --naver-green: #03c75a;
        --naver-green-dark: #02b14f;
        --naver-green-50: #e6f9f0;
        --bg: #f7f9fb;
        --chatgpt-green: #10a37f;
        /* unified vertical rhythm */
        --section-gap: 12px;
        --section-pad: 14px;
      }

      .container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 24px;
      }
      /* Reduce only main content's top padding to tighten area 2 */
      main.container {
        padding-top: calc(var(--section-gap) / 2);
      }
      .header {
        position: sticky;
        top: 0;
        z-index: 50;
        background: rgba(255, 255, 255, 0.8);
        backdrop-filter: blur(8px);
        border-bottom: 1px solid #e5e7eb;
      }
      .header-inner {
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 16px;
        padding: 14px 24px;
        max-width: 1200px;
        margin: 0 auto;
      }
      .logo {
        font-weight: 800;
        font-size: 24px;
        color: #111827;
        cursor: pointer;
      }
      /* Header on light background: plain text logo */
      .header .logo {
        background: none;
        -webkit-text-fill-color: inherit;
        color: #111827;
      }

      .nav {
        display: flex;
        align-items: center;
        gap: 10px;
        flex-wrap: wrap;
      }
      .nav a {
        font-size: 14px;
        padding: 8px 12px;
        border-radius: 8px;
        color: #374151;
      }
      .nav a:hover {
        background: var(--naver-green-50);
        color: var(--naver-green);
      }

      .grid {
        display: flex;
        flex-direction: column;
        gap: var(--section-gap);
        margin-top: calc(var(--section-gap) / 2); /* slightly tighter area 2 */
      }
      .card {
        width: 100%;
        background: #fff;
        border: 1px solid #e5e7eb;
        border-radius: 16px;
        box-shadow: 0 10px 25px rgba(0, 0, 0, 0.08);
        overflow: hidden;
      }
      @media (min-width: 1024px) {
        .card.half {
          grid-column: span 6;
        }
      }
      .card-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 16px 18px;
        border-bottom: 1px solid #f3f4f6;
        background: #fafafa;
      }
      .card-header .title {
        display: flex;
        align-items: center;
        gap: 10px;
        font-size: 16px;
        font-weight: 700;
        color: #111827;
      }
      .card-body {
        padding: 18px;
        display: grid;
        gap: 14px;
      }

      .row {
        display: grid;
        gap: 10px;
      }
      .row.cols-2 {
        grid-template-columns: 1fr;
      }
      @media (min-width: 768px) {
        .row.cols-2 {
          grid-template-columns: 1fr 1fr;
        }
      }

      label {
        font-size: 13px;
        color: #374151;
        font-weight: 600;
      }
      input[type="text"],
      input[type="number"],
      select,
      textarea {
        width: 100%;
        padding: 10px 12px;
        border: 1px solid #e5e7eb;
        border-radius: 10px;
        outline: none;
        font-size: 14px;
      }
      textarea {
        min-height: 120px;
        resize: vertical;
      }

      .actions {
        display: flex;
        gap: 10px;
        flex-wrap: wrap;
      }
      .btn {
        display: inline-flex;
        align-items: center;
        gap: 8px;
        padding: 10px 14px;
        border-radius: 10px;
        border: 1px solid #e5e7eb;
        background: #fff;
        color: #111827;
        cursor: pointer;
        font-weight: 600;
        font-size: 14px;
      }
      .btn.primary {
        background: var(--naver-green);
        color: #fff;
        border-color: var(--naver-green);
      }
      .btn.primary:hover {
        background: var(--naver-green-dark);
        border-color: var(--naver-green-dark);
      }
      .btn.ghost {
        background: #fff;
      }
      .btn:disabled {
        opacity: 0.6;
        cursor: not-allowed;
      }

      .muted {
        color: #6b7280;
        font-size: 13px;
      }
      .output {
        background: #f9fafb;
        border: 1px solid #e5e7eb;
        border-radius: 10px;
        padding: var(--section-pad);
        white-space: pre-wrap;
        font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas,
          "Liberation Mono", "Courier New", monospace;
        font-size: 13px;
        color: #111827;
      }
      .output.error {
        border-color: #fecaca;
        background: #fff1f2;
        color: #991b1b;
      }

      .table {
        width: 100%;
        border-collapse: collapse;
        border: 1px solid #e5e7eb;
        border-radius: 8px;
        overflow: hidden;
      }
      .table th,
      .table td {
        border-bottom: 1px solid #f3f4f6;
        padding: 10px;
        font-size: 13px;
        text-align: left;
      }
      .table th {
        background: #fafafa;
        font-weight: 700;
        color: #374151;
      }

      .small {
        font-size: 12px;
        color: #6b7280;
      }
      /* Naver-style ChatGPT search bar */
      .naver-search {
        display: grid;
        gap: 10px;
      }
      .ns-box {
        display: flex;
        align-items: center;
        gap: 10px;
        padding: 10px 14px;
        border: 2px solid var(--naver-green);
        border-radius: 999px;
        background: #fff;
        box-shadow: 0 8px 20px rgba(3, 199, 90, 0.08);
      }
      .ns-logo {
        height: 32px;
        border-radius: 6px;
        background: transparent; /* remove background for better visibility */
        color: inherit;
        font-weight: 900;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        gap: 6px;
        padding: 0 2px;
      }
      .openai-icon {
        width: 24px;
        height: 24px;
        filter: none; /* natural logo color on transparent background */
        display: block;
      }
      .ns-logo-text {
        font-size: 20px;
        font-weight: 800;
        color: #111827;
        letter-spacing: -0.3px;
      }
      .ns-input {
        flex: 1;
        border: none;
        outline: none;
        font-size: 16px;
        padding: 6px 4px;
        background: transparent;
      }
      .ns-actions {
        display: flex;
        align-items: center;
        gap: 8px;
      }
      .ns-btn {
        width: 36px;
        height: 36px;
        border: none;
        border-radius: 999px;
        background: var(--naver-green);
        color: #fff;
        cursor: pointer;
        display: inline-flex;
        align-items: center;
        justify-content: center;
      }
      .ns-btn:hover {
        background: var(--naver-green-dark);
      }
      .ns-shortcuts {
        display: flex;
        gap: 8px;
        flex-wrap: wrap;
      }
      .ns-chip {
        display: inline-flex;
        align-items: center;
        gap: 6px;
        padding: 5px 9px;
        border-radius: 999px;
        border: 1px solid #e5e7eb;
        background: #fff;
        font-size: 12px;
        color: #374151;
      }
      /* top search placement and slightly larger scale */
      .top-search {
        background: #fff;
        border-bottom: 1px solid #e5e7eb;
      }
      .top-search .container {
        padding-top: calc(var(--section-gap) / 2);
        padding-bottom: var(
          --section-gap
        ); /* restore visible space above hero (area 1) */
      }
      .top-search .ns-box {
        padding: calc(var(--section-pad) - 8px) 16px;
        max-width: 820px;
        margin: 0 auto;
      }
      .top-search .ns-logo {
        height: 32px;
        font-size: 20px;
        flex-direction: row; /* restore side-by-side */
        gap: 6px;
      }
      .top-search .ns-logo-text {
        font-size: 18px;
      }
      .top-search .ns-input {
        font-size: 18px;
      }
      .top-search .ns-btn {
        width: 40px;
        height: 40px;
      }
      .top-actions-row {
        position: relative;
        display: flex;
        align-items: center;
        justify-content: center; /* center icons block */
        gap: 12px;
        flex-wrap: wrap;
      }
      .top-actions {
        margin-top: var(--section-gap);
      }
      .auth-buttons {
        position: absolute;
        right: 0;
        top: 0;
        bottom: 0;
        margin: auto 0;
        display: flex;
        align-items: center;
        gap: 12px;
      }
      .auth-user {
        display: none;
        align-items: center;
        gap: 12px;
        padding: 6px 12px;
        border-radius: 999px;
        border: 1px solid rgba(17, 24, 39, 0.08);
        background: rgba(255, 255, 255, 0.95);
        box-shadow: 0 16px 28px rgba(15, 23, 42, 0.08);
      }
      .auth-user__avatar {
        width: 36px;
        height: 36px;
        border-radius: 50%;
        background: var(--naver-green-50);
        color: var(--naver-green);
        font-weight: 800;
        display: flex;
        align-items: center;
        justify-content: center;
        letter-spacing: -0.02em;
        text-transform: uppercase;
      }
      .auth-user__meta {
        display: flex;
        flex-direction: column;
        line-height: 1.1;
      }
      .auth-user__label {
        font-size: 11px;
        font-weight: 600;
        color: #9ca3af;
        letter-spacing: 0.08em;
        text-transform: uppercase;
      }
      .auth-user__email {
        font-size: 14px;
        font-weight: 600;
        color: #1f2937;
      }
      .auth-user__logout {
        height: 32px;
        padding: 0 14px;
        border-radius: 999px;
        border: 1px solid rgba(17, 24, 39, 0.08);
        background: #fff;
        color: #374151;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.2s ease;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        gap: 6px;
      }
      .auth-user__logout:hover {
        background: #f3f4f6;
        border-color: rgba(17, 24, 39, 0.15);
      }
      .auth-btn {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        height: 44px;
        padding: 0 18px;
        border-radius: 999px;
        font-weight: 700;
        font-size: 14px;
        gap: 8px;
        border: 1px solid transparent;
        text-decoration: none;
        cursor: pointer;
        transition: all 0.2s ease;
      }
      .auth-btn--primary {
        background: var(--naver-green);
        color: #fff;
        box-shadow: 0 12px 24px rgba(3, 199, 90, 0.25);
      }
      .auth-btn--primary:hover {
        background: var(--naver-green-dark);
      }
      .auth-btn--ghost {
        background: rgba(3, 199, 90, 0.12);
        color: var(--naver-green);
      }
      .auth-btn--ghost:hover {
        background: rgba(3, 199, 90, 0.18);
      }
      @media (max-width: 768px) {
        .top-actions-row {
          flex-direction: column;
          align-items: stretch;
        }
        .auth-buttons {
          position: static;
          width: 100%;
          flex-direction: column;
          align-items: stretch;
          gap: 10px;
        }
        .auth-user {
          width: 100%;
          justify-content: space-between;
          padding: 10px 16px;
        }
        .auth-user__logout {
          height: 36px;
        }
        .auth-btn {
          width: 100%;
        }
      }
      .top-apps {
        display: flex;
        gap: 12px;
        flex-wrap: wrap;
        justify-content: center;
        padding: 12px 4px 6px 4px;
      }
      .top-apps a.app {
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 8px;
        min-width: 64px;
        text-decoration: none;
        color: #374151;
      }
      .app-icon {
        width: 44px;
        height: 44px;
        border-radius: 12px;
        background: #fff;
        border: 1px solid #e5e7eb;
        display: flex;
        align-items: center;
        justify-content: center;
        box-shadow: 0 6px 14px rgba(0, 0, 0, 0.06);
        color: var(--naver-green);
        font-size: 18px;
      }
      .app-label {
        font-size: 15px;
        color: #374151;
      }
      .top-apps a.app:hover .app-icon {
        border-color: var(--naver-green);
        transform: translateY(-2px);
        transition: all 0.2s ease;
      }

      /* Mobile-only layout tweaks */
      @media (max-width: 768px) {
        /* 1) 기능 아이콘: 5개 고정 노출(스크롤 없음, 2줄로 자동 줄바꿈) */
        .top-actions-row .top-apps {
          display: grid !important;
          grid-template-columns: repeat(5, 1fr);
          gap: 12px;
          padding: 8px 12px 10px 12px;
          overflow: hidden;
        }
        .top-actions-row .top-apps a.app {
          min-width: 0 !important; /* 5등분을 막는 최소폭 제약 제거 */
          width: 100% !important;
        }
      }
    </style>
  </head>
  <body>
    <header class="header">
      <div class="header-inner">
        <div class="logo" onclick="location.href='/'">사장픽</div>
      </div>
      <!-- Top Naver-style ChatGPT search (moved under header) -->
      <section class="top-search">
        <div class="container top-row">
          <form id="topNaverChatForm" class="ns-box">
            <div class="ns-logo" aria-label="GPT-5">
              <i
                class="fa-solid fa-comments"
                style="font-size: 22px; color: var(--chatgpt-green)"
              ></i>
              <span class="ns-logo-text">GPT-5</span>
            </div>
            <input
              id="topNaverChatInput"
              class="ns-input"
              type="text"
              placeholder="무엇이든 물어보세요. 예) 손님 불만 리뷰에 공손한 답변 작성"
              autocomplete="off"
            />
            <div class="ns-actions">
              <button
                type="submit"
                id="topNaverChatSubmit"
                class="ns-btn"
                aria-label="검색"
              >
                <i class="fa-solid fa-magnifying-glass"></i>
              </button>
            </div>
          </form>

          <!-- 상단 추천 단축 버튼(추천메뉴/응대/주제) 제거 -->
          <div class="top-actions-row top-actions">
            <div class="top-apps">
              <a class="app" href="/naver_search.html">
                <div class="app-icon">
                  <i class="fa-solid fa-key" style="font-size: 20px"></i>
                </div>
                <div class="app-label" style="font-size: 14px">키워드</div>
              </a>
              <a class="app" href="/review.html">
                <div class="app-icon">
                  <i class="fa-solid fa-pen-nib" style="font-size: 20px"></i>
                </div>
                <div class="app-label" style="font-size: 14px">리뷰작성</div>
              </a>
              <a class="app" href="/Blog-Editor.html">
                <div class="app-icon">
                  <i class="fa-solid fa-blog" style="font-size: 20px"></i>
                </div>
                <div class="app-label" style="font-size: 14px">블로그</div>
              </a>
              <a class="app" href="/ChatGPT.html">
                <div class="app-icon">
                  <i
                    class="fa-solid fa-comments"
                    style="font-size: 20px; color: var(--chatgpt-green)"
                  ></i>
                </div>
                <div class="app-label" style="font-size: 14px">채팅</div>
              </a>
              
            </div>
            <div class="auth-buttons" id="authButtons">
              <div class="auth-user" id="authUser" style="display: none;">
                <div class="auth-user__avatar" id="userAvatar">U</div>
                <div class="auth-user__meta">
                  <span class="auth-user__label">로그인 계정</span>
                  <span class="auth-user__email" id="userEmail"></span>
                </div>
                <button class="auth-user__logout" id="logoutBtn" type="button">
                  <i class="fa-solid fa-right-from-bracket"></i>
                  로그아웃
                </button>
              </div>
              <a href="/login.html" class="auth-btn auth-btn--primary" id="loginBtn">
                <i class="fa-solid fa-arrow-right-to-bracket"></i>
                <span>로그인</span>
              </a>
              <a href="/join.html" class="auth-btn auth-btn--ghost" id="signupBtn">
                <i class="fa-solid fa-user-plus"></i>
                <span>회원가입</span>
              </a>
            </div>
          </div>
          <div
            id="topChatSearchOutput"
            class="output"
            style="display: none"
          ></div>
        </div>
      </section>
    </header>

    <main class="container">
      <div class="grid">
        <!-- 키워드 검색 -->
        <section class="card">
          <div class="card-header">
            <div class="title">
              <i class="fa-solid fa-key"></i> 키워드 검색
            </div>
            <span class="small muted">POST /api/keywords</span>
          </div>
          <div class="card-body">
            <p style="color: #6b7280; margin-bottom: 16px;">
              네이버 광고 API를 활용한 키워드 분석 서비스입니다. 월간 검색수, 클릭수, 경쟁정도 등을 확인할 수 있습니다.
            </p>
            <div class="actions">
              <a href="/naver_search.html" class="btn primary" style="text-decoration: none;">
                <i class="fa-solid fa-arrow-right"></i> 키워드 조회하기
              </a>
            </div>
          </div>
        </section>

        <!-- AI 리뷰작성 -->
        <section class="card">
          <div class="card-header">
            <div class="title">
              <i class="fa-solid fa-pen-nib"></i> AI 리뷰작성
            </div>
            <span class="small muted">POST /api/analyze-review, POST /api/generate-reply</span>
          </div>
          <div class="card-body">
            <p style="color: #6b7280; margin-bottom: 16px;">
              고객 리뷰를 분석하고 전문적인 답글을 자동으로 생성합니다. 긍정/부정 감정 분석과 함께 공손한 답변을 작성해드립니다.
            </p>
            <div class="actions">
              <a href="/review.html" class="btn primary" style="text-decoration: none;">
                <i class="fa-solid fa-arrow-right"></i> 리뷰 관리 시작하기
              </a>
            </div>
          </div>
        </section>

        <!-- AI 블로그 작성 -->
        <section class="card">
          <div class="card-header">
            <div class="title">
              <i class="fa-solid fa-blog"></i> AI 블로그 작성
            </div>
            <span class="small muted">POST /api/generate-blog</span>
          </div>
          <div class="card-body">
            <p style="color: #6b7280; margin-bottom: 16px;">
              ChatGPT, Gemini, Claude 3단계 AI로 완성하는 가게 리뷰 블로그를 생성합니다. 다양한 스타일과 글자 수 조절이 가능합니다.
            </p>
            <div class="actions">
              <a href="/Blog-Editor.html" class="btn primary" style="text-decoration: none;">
                <i class="fa-solid fa-arrow-right"></i> 블로그 생성하기
              </a>
            </div>
          </div>
        </section>

        <!-- ChatGPT 채팅 -->
        <section class="card">
          <div class="card-header">
            <div class="title">
              <i class="fa-solid fa-comments" style="color: var(--chatgpt-green)"></i> ChatGPT 채팅
            </div>
            <span class="small muted">POST /api/chat</span>
          </div>
          <div class="card-body">
            <p style="color: #6b7280; margin-bottom: 16px;">
              AI와 실시간으로 대화하며 궁금한 것들을 물어보세요. 아이디어, 리뷰답글, 홍보문구 등 다양한 도움을 받을 수 있습니다.
            </p>
            <div class="actions">
              <a href="/ChatGPT.html" class="btn primary" style="text-decoration: none;">
                <i class="fa-solid fa-arrow-right"></i> 채팅 시작하기
              </a>
            </div>
          </div>
        </section>
      </div>
    </main>

    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="/assets/auth-state.js?v=202410"></script>
    <script>
      // 강제 적용: 일부 기기에서 캐시/브라우저 이슈로 CSS가 즉시 반영되지 않는 문제 보완
      (function enforceMobileLayout() {
        const isMobile = window.matchMedia("(max-width: 768px)").matches;
        if (!isMobile) return;
        // 기능 아이콘 5등분 그리드 강제(일부 브라우저 캐시 이슈 대응)
        const topApps = document.querySelector(".top-actions-row .top-apps");
        if (topApps) {
          topApps.style.display = "grid";
          topApps.style.gridTemplateColumns = "repeat(5, 1fr)";
          topApps.style.gap = "12px";
          topApps.style.overflow = "hidden";
        }
      })();

      // 로그인 상태 확인 및 UI 업데이트 (즉시 실행)
      function updateAuthUI() {
        const isLoggedIn = localStorage.getItem("isLoggedIn");
        const userData = localStorage.getItem("userData");

        const loginBtn = document.getElementById("loginBtn");
        const signupBtn = document.getElementById("signupBtn");
        const userEmailSpan = document.getElementById("userEmail");
        const logoutBtn = document.getElementById("logoutBtn");
        const authUser = document.getElementById("authUser");
        const userAvatar = document.getElementById("userAvatar");

        if (isLoggedIn === "true" && userData) {
          try {
            const user = JSON.parse(userData);

            // 로그인 버튼 숨기기
            if (loginBtn) loginBtn.style.display = "none";
            if (signupBtn) signupBtn.style.display = "none";

            // 사용자 정보 및 로그아웃 버튼 표시
            if (authUser) authUser.style.display = "flex";
            if (userEmailSpan) {
              const emailText = user.email || user.displayName || user.name || "사용자";
              userEmailSpan.textContent = emailText;
              userEmailSpan.title = emailText;
            }
            if (userAvatar) {
              const base =
                user.displayName ||
                user.user_metadata?.full_name ||
                user.email ||
                "U";
              userAvatar.textContent = (base.trim()[0] || "U").toUpperCase();
            }
            if (logoutBtn) {
              logoutBtn.style.display = "inline-flex";
              logoutBtn.onclick = async function () {
                if (!confirm("로그아웃 하시겠습니까?")) return;
                try {
                  if (window.authState?.signOut) {
                    await window.authState.signOut();
                  } else {
                    localStorage.removeItem("isLoggedIn");
                    localStorage.removeItem("userData");
                  }
                } finally {
                  location.href = "login.html";
                }
              };
            }
          } catch (e) {
            console.error("로그인 정보 파싱 오류:", e);
            // 오류 발생 시 로그인 정보 초기화
            localStorage.removeItem("isLoggedIn");
            localStorage.removeItem("userData");
          }
        } else {
          // 로그인하지 않은 상태 - 로그인/회원가입 버튼 표시
          if (authUser) authUser.style.display = "none";
          if (loginBtn) loginBtn.style.display = "inline-flex";
          if (signupBtn) signupBtn.style.display = "inline-flex";
          if (userEmailSpan) {
            userEmailSpan.textContent = "";
            userEmailSpan.title = "";
          }
          if (logoutBtn) {
            logoutBtn.style.display = "none";
            logoutBtn.onclick = null;
          }
        }
      }

      updateAuthUI();
      window.addEventListener("auth:state-changed", updateAuthUI);
      if (window.authState?.syncSession) {
        window.authState.syncSession();
      }
    </script>
  </body>
</html>
