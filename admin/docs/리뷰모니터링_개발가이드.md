# ë¦¬ë·° ëª¨ë‹ˆí„°ë§ ì‹œìŠ¤í…œ - ê°œë°œ ê°€ì´ë“œ (AIìš©)

> ğŸ¤– **AI ê°œë°œìë¥¼ ìœ„í•œ ì™„ì „ ê°€ì´ë“œ**: ì‹¤ì œ ìš”êµ¬ì‚¬í•­ ë°˜ì˜ ì™„ë£Œ

---

## ğŸ¯ ì‹¤ì œ ìš”êµ¬ì‚¬í•­ (ì¤‘ìš”!)

### **ì‹œìŠ¤í…œ ëª©í‘œ**
1. **íšŒì›ì´ í”Œë ˆì´ìŠ¤ URL ë“±ë¡** â†’ ì¦‰ì‹œ 1ì°¨ ì „ì²´ í¬ë¡¤ë§ â†’ DB ì €ì¥ (ê¸°ì¤€ì  ìƒì„±, ì•Œë¦¼ X)
2. **ì •ê¸° í¬ë¡¤ë§** (í•˜ë£¨ 3íšŒ) â†’ ìƒˆë¡œìš´ ë¦¬ë·°ë§Œ ìˆ˜ì§‘ â†’ DB ì €ì¥ â†’ ì¡°ê±´ë¶€ ì•Œë¦¼ ë°œì†¡
3. **ì•Œë¦¼ ë°œì†¡ ì œì–´** â†’ ì–´ë“œë¯¼ì—ì„œ íšŒì›ë³„ 1ì¼ ë°œì†¡ íšŸìˆ˜ ì œí•œ (0/1/2íšŒ)

### **í¬ë¡¤ë§ ëŒ€ìƒ (4ê°€ì§€ ì „ë¶€)**
- âœ… ë°©ë¬¸ì ë¦¬ë·° (visitor)
- âœ… ë¸”ë¡œê·¸ ë¦¬ë·° (blog)
- âœ… ì˜ìˆ˜ì¦ ë¦¬ë·° (receipt)
- âœ… ìƒˆì†Œì‹ (news)

### **ì•Œë¦¼ ë°œì†¡ ì¡°ê±´**
- ì €í‰ì  ë¦¬ë·° (1-2ì ) â†’ ê¸´ê¸‰ ì•Œë¦¼
- ê³ í‰ì  ë¦¬ë·° (5ì ) â†’ ì¹­ì°¬ ì•Œë¦¼
- **ë‹¨, 1ì¼ ë°œì†¡ íšŸìˆ˜ ì œí•œ ì²´í¬** (ì–´ë“œë¯¼ ì„¤ì •ê°’)

---

## ğŸ“‹ í˜„ì¬ ìƒíƒœ

### âœ… ì´ë¯¸ ì™„ë£Œëœ ê²ƒ
- DB ìŠ¤í‚¤ë§ˆ ê¸°ë³¸ êµ¬ì¡° (3ê°œ í…Œì´ë¸”)
- API ì—”ë“œí¬ì¸íŠ¸ ê¸°ë³¸ êµ¬ì¡°
- ë§ˆì´í˜ì´ì§€/ì–´ë“œë¯¼ UI
- Vercel Cron ì„¤ì • (í•˜ë£¨ 3íšŒ)
- Puppeteer ì´ë¯¸ ì„¤ì¹˜ë¨ (`package.json`ì— ìˆìŒ)

### âš ï¸ ì‘ì—… í•„ìš”
1. **DB ìŠ¤í‚¤ë§ˆ ì¶”ê°€** - ë°œì†¡ ì œí•œ ì»¬ëŸ¼ 3ê°œ
2. **í¬ë¡¤ë§ 4ì¢…** - ë°©ë¬¸ì/ë¸”ë¡œê·¸/ì˜ìˆ˜ì¦/ìƒˆì†Œì‹
3. **1ì°¨ í¬ë¡¤ë§ ë¡œì§** - isFirstCrawl êµ¬ë¶„
4. **ë°œì†¡ ì œí•œ ë¡œì§** - ì¼ì¼ í•œë„ ì²´í¬
5. **ì–´ë“œë¯¼ UI** - ë°œì†¡ ì œì–´ ì„¤ì •

---

# Part 0: DB ìŠ¤í‚¤ë§ˆ ìˆ˜ì • (ìµœìš°ì„ )

## ğŸ“Œ ì‘ì—… ê°œìš”

**ì´ìœ **: ë°œì†¡ íšŸìˆ˜ ì œí•œ ê¸°ëŠ¥ì„ ìœ„í•´ ì»¬ëŸ¼ 3ê°œ ì¶”ê°€ í•„ìš”

**íŒŒì¼**: ìƒˆë¡œ ìƒì„± `database/schemas/features/review/review-monitoring-update.sql`

---

## Step 0-1: SQL íŒŒì¼ ìƒì„±

```sql
-- ============================================
-- ë¦¬ë·° ëª¨ë‹ˆí„°ë§ - ë°œì†¡ ì œí•œ ê¸°ëŠ¥ ì¶”ê°€
-- ì‘ì„±ì¼: 2025-10-30
-- ============================================

-- review_monitoring í…Œì´ë¸”ì— ì»¬ëŸ¼ ì¶”ê°€
ALTER TABLE public.review_monitoring
ADD COLUMN IF NOT EXISTS daily_alert_limit integer DEFAULT 2,  -- 1ì¼ ë°œì†¡ ì œí•œ (0=ë„ê¸°, 1=1íšŒ, 2=2íšŒ)
ADD COLUMN IF NOT EXISTS alert_count_today integer DEFAULT 0,  -- ì˜¤ëŠ˜ ë°œì†¡í•œ íšŸìˆ˜
ADD COLUMN IF NOT EXISTS last_alert_date date;  -- ë§ˆì§€ë§‰ ì•Œë¦¼ ë°œì†¡ ë‚ ì§œ (ìì • ì´ˆê¸°í™”ìš©)

COMMENT ON COLUMN public.review_monitoring.daily_alert_limit IS '1ì¼ ìµœëŒ€ ì•Œë¦¼ ë°œì†¡ íšŸìˆ˜ (0=ì•Œë¦¼ë„ê¸°)';
COMMENT ON COLUMN public.review_monitoring.alert_count_today IS 'ì˜¤ëŠ˜ ë°œì†¡í•œ ì•Œë¦¼ íšŸìˆ˜';
COMMENT ON COLUMN public.review_monitoring.last_alert_date IS 'ë§ˆì§€ë§‰ ì•Œë¦¼ ë°œì†¡ ë‚ ì§œ (ë‚ ì§œ ë³€ê²½ ì‹œ alert_count_today ì´ˆê¸°í™”)';

-- ì¸ë±ìŠ¤ ì¶”ê°€
CREATE INDEX IF NOT EXISTS idx_review_monitoring_alert_limit 
  ON public.review_monitoring(daily_alert_limit) 
  WHERE daily_alert_limit > 0;
```

---

## Step 0-2: Supabaseì— ì ìš©

1. **Supabase Dashboard ì ‘ì†**
2. **SQL Editor ë©”ë‰´ í´ë¦­**
3. **New Query ë²„íŠ¼**
4. **ìœ„ SQL ë¶™ì—¬ë„£ê¸°**
5. **Run ì‹¤í–‰**
6. **í™•ì¸**: `review_monitoring` í…Œì´ë¸”ì— ì»¬ëŸ¼ 3ê°œ ì¶”ê°€ë¨

---

## Step 0-3: ì²´í¬ë¦¬ìŠ¤íŠ¸

- [ ] SQL íŒŒì¼ ìƒì„±
- [ ] Supabaseì— SQL ì‹¤í–‰
- [ ] í…Œì´ë¸”ì— ì»¬ëŸ¼ ì¶”ê°€ í™•ì¸
- [ ] Git ì»¤ë°‹
  ```bash
  git add database/schemas/features/review/review-monitoring-update.sql
  git commit -m "feat: ë°œì†¡ ì œí•œ ê¸°ëŠ¥ì„ ìœ„í•œ DB ìŠ¤í‚¤ë§ˆ ì¶”ê°€

  - daily_alert_limit: 1ì¼ ë°œì†¡ ì œí•œ ì„¤ì •
  - alert_count_today: ì˜¤ëŠ˜ ë°œì†¡ íšŸìˆ˜
  - last_alert_date: ë§ˆì§€ë§‰ ë°œì†¡ ë‚ ì§œ"
  ```

---

# Part 1: ë„¤ì´ë²„ í”Œë ˆì´ìŠ¤ í¬ë¡¤ë§ êµ¬í˜„ (4ì¢… ì „ì²´)

## ğŸ“Œ ì‘ì—… ê°œìš”

**íŒŒì¼**: `api/review-monitoring.js`  
**í˜„ì¬**: ë”ë¯¸ ë°ì´í„°ë§Œ ë°˜í™˜ (49-91ì¤„)  
**ëª©í‘œ**: 4ì¢… í¬ë¡¤ë§ ëª¨ë‘ êµ¬í˜„

**âš ï¸ ì¤‘ìš”**: PuppeteerëŠ” ì´ë¯¸ ì„¤ì¹˜ë˜ì–´ ìˆìŒ! (`package.json`ì— í™•ì¸ë¨)

---

## Step 1-1: ê¸°ì¡´ Puppeteer ì½”ë“œ í™œìš©

**ì´ë¯¸ ìˆëŠ” íŒŒì¼ë“¤:**
- `api/place-detail-crawl.js` - Chromium ì„¤ì • ì°¸ê³  ê°€ëŠ¥
- `api/place-batch-crawl.js` - ë¸Œë¼ìš°ì € ì‹¤í–‰ ë¡œì§ ì°¸ê³  ê°€ëŠ¥

**ì„¤ì • ì¬ì‚¬ìš©:**
```javascript
// Vercel í™˜ê²½ ì²´í¬
const isVercel = process.env.VERCEL || process.env.NODE_ENV === "production";

let chromium, puppeteer;
if (isVercel) {
  chromium = require("@sparticuz/chromium");
  puppeteer = require("puppeteer-core");
} else {
  puppeteer = require("puppeteer");
}
```

---

## Step 1-2: í¬ë¡¤ë§ í•¨ìˆ˜ 4ê°œ ì‘ì„±

**íŒŒì¼ ìˆ˜ì •**: `api/review-monitoring.js` (49-91ì¤„ ì‚­ì œ í›„ êµì²´)

**âš ï¸ ì£¼ì˜ì‚¬í•­:**
1. `isFirstCrawl` íŒŒë¼ë¯¸í„° ì¶”ê°€ â†’ trueë©´ ì•Œë¦¼ ì•ˆ ë³´ëƒ„
2. ê° ë¦¬ë·°ì— `external_id` ìƒì„± â†’ ì¤‘ë³µ ë°©ì§€
3. ì‹¤íŒ¨í•´ë„ ê³„ì† ì§„í–‰ (í•œ ì¢…ë¥˜ ì‹¤íŒ¨í•´ë„ ë‹¤ë¥¸ ê²ƒì€ ìˆ˜ì§‘)

```javascript
// ========== ê¸°ì¡´ 49-91ì¤„ ì‚­ì œí•˜ê³  ì•„ë˜ë¡œ êµì²´ ==========

const isVercel = process.env.VERCEL || process.env.NODE_ENV === "production";

let chromium, puppeteer;
if (isVercel) {
  chromium = require("@sparticuz/chromium");
  puppeteer = require("puppeteer-core");
} else {
  puppeteer = require("puppeteer");
}

/**
 * ë„¤ì´ë²„ í”Œë ˆì´ìŠ¤ ë¦¬ë·° í¬ë¡¤ë§ (4ì¢… ì „ì²´)
 * @param {string} placeUrl - í”Œë ˆì´ìŠ¤ URL
 * @param {boolean} isFirstCrawl - ìµœì´ˆ í¬ë¡¤ë§ ì—¬ë¶€ (trueë©´ ì•Œë¦¼ ì•ˆ ë³´ëƒ„)
 */
async function crawlPlaceReviews(placeUrl, isFirstCrawl = false) {
  let browser = null;
  
  try {
    console.log(`[í¬ë¡¤ë§ ì‹œì‘] ${placeUrl} (ìµœì´ˆ: ${isFirstCrawl})`);
    
    // í”Œë ˆì´ìŠ¤ ID ì¶”ì¶œ
    const placeId = extractPlaceId(placeUrl);
    if (!placeId) {
      throw new Error('ìœ íš¨í•˜ì§€ ì•Šì€ í”Œë ˆì´ìŠ¤ URL');
    }
    
    // ë¸Œë¼ìš°ì € ì‹¤í–‰
    let launchOptions;
    if (isVercel) {
      const executablePath = await chromium.executablePath();
      launchOptions = {
        args: [...chromium.args, "--no-sandbox", "--disable-setuid-sandbox"],
        defaultViewport: { width: 412, height: 915 },
        executablePath,
        headless: chromium.headless,
      };
    } else {
      launchOptions = {
        args: ["--no-sandbox", "--disable-setuid-sandbox"],
        defaultViewport: { width: 412, height: 915 },
        headless: true,
      };
    }
    
    browser = await puppeteer.launch(launchOptions);
    const page = await browser.newPage();
    await page.setUserAgent(
      'Mozilla/5.0 (iPhone; CPU iPhone OS 16_6 like Mac OS X) AppleWebKit/605.1.15'
    );
    
    // 4ì¢… í¬ë¡¤ë§ (ì‹¤íŒ¨í•´ë„ ê³„ì† ì§„í–‰)
    const allReviews = [];
    
    // 1. ë°©ë¬¸ì ë¦¬ë·°
    try {
      const visitorReviews = await crawlVisitorReviews(page, placeId);
      allReviews.push(...visitorReviews);
      console.log(`âœ… ë°©ë¬¸ì ë¦¬ë·°: ${visitorReviews.length}ê°œ`);
    } catch (error) {
      console.error('âŒ ë°©ë¬¸ì ë¦¬ë·° í¬ë¡¤ë§ ì‹¤íŒ¨:', error.message);
    }
    
    // 2. ë¸”ë¡œê·¸ ë¦¬ë·°
    try {
      const blogReviews = await crawlBlogReviews(page, placeId);
      allReviews.push(...blogReviews);
      console.log(`âœ… ë¸”ë¡œê·¸ ë¦¬ë·°: ${blogReviews.length}ê°œ`);
    } catch (error) {
      console.error('âŒ ë¸”ë¡œê·¸ ë¦¬ë·° í¬ë¡¤ë§ ì‹¤íŒ¨:', error.message);
    }
    
    // 3. ì˜ìˆ˜ì¦ ë¦¬ë·°
    try {
      const receiptReviews = await crawlReceiptReviews(page, placeId);
      allReviews.push(...receiptReviews);
      console.log(`âœ… ì˜ìˆ˜ì¦ ë¦¬ë·°: ${receiptReviews.length}ê°œ`);
    } catch (error) {
      console.error('âŒ ì˜ìˆ˜ì¦ ë¦¬ë·° í¬ë¡¤ë§ ì‹¤íŒ¨:', error.message);
    }
    
    // 4. ìƒˆì†Œì‹
    try {
      const news = await crawlPlaceNews(page, placeId);
      allReviews.push(...news);
      console.log(`âœ… ìƒˆì†Œì‹: ${news.length}ê°œ`);
    } catch (error) {
      console.error('âŒ ìƒˆì†Œì‹ í¬ë¡¤ë§ ì‹¤íŒ¨:', error.message);
    }
    
    console.log(`[í¬ë¡¤ë§ ì™„ë£Œ] ì´ ${allReviews.length}ê°œ ìˆ˜ì§‘`);
    
    return {
      success: true,
      reviews: allReviews,
      total: allReviews.length,
      isFirstCrawl
    };
    
  } catch (error) {
    console.error('[í¬ë¡¤ë§ ì‹¤íŒ¨]', error);
    return {
      success: false,
      error: error.message,
      reviews: [],
      isFirstCrawl
    };
  } finally {
    if (browser) {
      await browser.close();
    }
  }
}

/**
 * 1. ë°©ë¬¸ì ë¦¬ë·° í¬ë¡¤ë§
 */
async function crawlVisitorReviews(page, placeId) {
  const url = `https://m.place.naver.com/restaurant/${placeId}/review/visitor`;
  await page.goto(url, { waitUntil: 'domcontentloaded', timeout: 30000 });
  await page.waitForTimeout(2000);
  
  const reviews = await page.evaluate(() => {
    const items = document.querySelectorAll('.list_review > li, .place_section_content li');
    const results = [];
    
    items.forEach((el, index) => {
      try {
        // í‰ì 
        const stars = el.querySelectorAll('.star_score .star_fill, .rating_star .icon_star');
        const rating = stars ? stars.length : 0;
        
        // ë‚´ìš©
        const contentEl = el.querySelector('.review_text, .review_content');
        const content = contentEl ? contentEl.textContent.trim() : '';
        
        // ì‘ì„±ì
        const authorEl = el.querySelector('.reviewer_name, .user_name');
        const reviewer_name = authorEl ? authorEl.textContent.trim() : 'ìµëª…';
        
        // ë‚ ì§œ
        const timeEl = el.querySelector('.review_time, .date');
        const timeText = timeEl ? timeEl.textContent.trim() : '';
        
        if (content) {
          results.push({
            type: 'visitor',
            external_id: `visitor_${placeId}_${Date.now()}_${index}`,
            rating,
            content,
            reviewer_name,
            reviewed_at: new Date().toISOString()
          });
        }
      } catch (err) {
        console.error('íŒŒì‹± ì˜¤ë¥˜:', err);
      }
    });
    
    return results;
  });
  
  return reviews;
}

/**
 * 2. ë¸”ë¡œê·¸ ë¦¬ë·° í¬ë¡¤ë§
 */
async function crawlBlogReviews(page, placeId) {
  const url = `https://m.place.naver.com/restaurant/${placeId}/review/ugc`;
  await page.goto(url, { waitUntil: 'domcontentloaded', timeout: 30000 });
  await page.waitForTimeout(2000);
  
  const reviews = await page.evaluate(() => {
    const items = document.querySelectorAll('.list_review > li, .place_section_content .item');
    const results = [];
    
    items.forEach((el, index) => {
      try {
        // ë¸”ë¡œê·¸ëŠ” í‰ì  ì—†ìŒ
        const rating = 0;
        
        // ë‚´ìš©
        const contentEl = el.querySelector('.review_text, .content');
        const content = contentEl ? contentEl.textContent.trim() : '';
        
        // ì‘ì„±ì (ë¸”ë¡œê·¸ ì œëª©)
        const titleEl = el.querySelector('.title, .blog_title');
        const reviewer_name = titleEl ? titleEl.textContent.trim() : 'ë¸”ë¡œê·¸';
        
        if (content && content.length > 10) {
          results.push({
            type: 'blog',
            external_id: `blog_${placeId}_${Date.now()}_${index}`,
            rating,
            content: content.substring(0, 500),
            reviewer_name,
            reviewed_at: new Date().toISOString()
          });
        }
      } catch (err) {
        console.error('íŒŒì‹± ì˜¤ë¥˜:', err);
      }
    });
    
    return results;
  });
  
  return reviews;
}

/**
 * 3. ì˜ìˆ˜ì¦ ë¦¬ë·° í¬ë¡¤ë§
 */
async function crawlReceiptReviews(page, placeId) {
  const url = `https://m.place.naver.com/restaurant/${placeId}/review/receipt`;
  await page.goto(url, { waitUntil: 'domcontentloaded', timeout: 30000 });
  await page.waitForTimeout(2000);
  
  const reviews = await page.evaluate(() => {
    const items = document.querySelectorAll('.list_review > li, .place_section_content li');
    const results = [];
    
    items.forEach((el, index) => {
      try {
        // í‰ì 
        const stars = el.querySelectorAll('.star_score .star_fill');
        const rating = stars ? stars.length : 0;
        
        // ë‚´ìš©
        const contentEl = el.querySelector('.review_text, .content');
        const content = contentEl ? contentEl.textContent.trim() : '';
        
        // ì‘ì„±ì
        const authorEl = el.querySelector('.reviewer_name, .user');
        const reviewer_name = authorEl ? authorEl.textContent.trim() : 'ì˜ìˆ˜ì¦ë¦¬ë·°';
        
        if (content) {
          results.push({
            type: 'receipt',
            external_id: `receipt_${placeId}_${Date.now()}_${index}`,
            rating,
            content,
            reviewer_name,
            reviewed_at: new Date().toISOString()
          });
        }
      } catch (err) {
        console.error('íŒŒì‹± ì˜¤ë¥˜:', err);
      }
    });
    
    return results;
  });
  
  return reviews;
}

/**
 * 4. ìƒˆì†Œì‹ í¬ë¡¤ë§
 */
async function crawlPlaceNews(page, placeId) {
  const url = `https://m.place.naver.com/restaurant/${placeId}/feed`;
  await page.goto(url, { waitUntil: 'domcontentloaded', timeout: 30000 });
  await page.waitForTimeout(2000);
  
  const news = await page.evaluate(() => {
    const items = document.querySelectorAll('.place_section_content .item, .feed_item');
    const results = [];
    
    items.forEach((el, index) => {
      try {
        // ìƒˆì†Œì‹ì€ í‰ì  ì—†ìŒ
        const rating = 0;
        
        // ë‚´ìš©
        const contentEl = el.querySelector('.text, .content');
        const content = contentEl ? contentEl.textContent.trim() : '';
        
        if (content && content.length > 10) {
          results.push({
            type: 'news',
            external_id: `news_${placeId}_${Date.now()}_${index}`,
            rating,
            content: content.substring(0, 500),
            reviewer_name: 'ì‚¬ì¥ë‹˜',
            reviewed_at: new Date().toISOString()
          });
        }
      } catch (err) {
        console.error('íŒŒì‹± ì˜¤ë¥˜:', err);
      }
    });
    
    return results;
  });
  
  return news;
}
```

---

## Step 1-3: 1ì°¨ í¬ë¡¤ë§ ë¡œì§ ì¶”ê°€

**íŒŒì¼ ìˆ˜ì •**: `api/review-monitoring.js` (241-252ì¤„ ìˆ˜ì •)

**í˜„ì¬ ì½”ë“œ:**
```javascript
// 3. ìƒˆ ë¦¬ë·° ì²˜ë¦¬ (ì €ì¥ + ì•Œë¦¼)
for (const review of newReviews) {
  const result = await processNewReview(...);
}
```

**ìˆ˜ì • í›„:**
```javascript
// 3. ìƒˆ ë¦¬ë·° ì²˜ë¦¬ (ì €ì¥ + ì•Œë¦¼)
let processedCount = 0;
for (const review of newReviews) {
  // âš ï¸ isFirstCrawlì´ë©´ ì•Œë¦¼ ì•ˆ ë³´ëƒ„!
  const skipAlert = crawlResult.isFirstCrawl;
  
  const result = await processNewReview(
    monitoring.user_id,
    monitoring.id,
    monitoring,
    review,
    skipAlert  // ì¶”ê°€!
  );
  
  if (result.success) processedCount++;
}
```

---

## Step 1-4: processNewReview í•¨ìˆ˜ ìˆ˜ì •

**íŒŒì¼ ìˆ˜ì •**: `api/review-monitoring.js` (141-221ì¤„)

**í•¨ìˆ˜ ì‹œê·¸ë‹ˆì²˜ ë³€ê²½:**
```javascript
// ê¸°ì¡´
async function processNewReview(userId, monitoringId, monitoring, review) {

// ë³€ê²½ í›„
async function processNewReview(userId, monitoringId, monitoring, review, skipAlert = false) {
```

**ì•Œë¦¼ ë°œì†¡ ë¶€ë¶„ ìˆ˜ì • (198ì¤„ ê·¼ì²˜):**
```javascript
// ì¹´ì¹´ì˜¤í†¡ ì•Œë¦¼ ë°œì†¡
if (shouldSendAlert && !skipAlert) {  // skipAlert ì²´í¬ ì¶”ê°€!
  const alertData = {
    id: alert.id,
    place_name: monitoring.place_name || 'ë‚´ ê°€ê²Œ',
    place_url: monitoring.place_url,
    rating: review.rating,
    content: review.content,
    reviewer_name: review.reviewer_name,
    reviewed_at: review.reviewed_at
  };
  
  if (isUrgent) {
    await sendUrgentReviewAlert(userId, alertData);
  } else if (isHighRating) {
    await sendHighRatingAlert(userId, alertData);
  }
}

if (skipAlert) {
  console.log('[ì•Œë¦¼ ê±´ë„ˆëœ€] ìµœì´ˆ í¬ë¡¤ë§');
}
```

---

## Step 1-5: ìµœì´ˆ í¬ë¡¤ë§ ì‹¤í–‰ ì‹œì 

**íŒŒì¼ ìˆ˜ì •**: `api/review-monitoring.js` (516ì¤„ ê·¼ì²˜)

**í˜„ì¬:**
```javascript
// ìµœì´ˆ í¬ë¡¤ë§ ì‹¤í–‰
setTimeout(() => crawlSingleMonitoring(data), 1000);
```

**ìˆ˜ì • í›„:**
```javascript
// âœ… ìµœì´ˆ í¬ë¡¤ë§ ì‹¤í–‰ (isFirstCrawl = true)
setTimeout(async () => {
  // monitoring ê°ì²´ì— isFirstCrawl í”Œë˜ê·¸ ì¶”ê°€
  const monitoringWithFlag = { ...data, isFirstCrawl: true };
  await crawlSingleMonitoring(monitoringWithFlag);
}, 1000);
```

**crawlSingleMonitoring í•¨ìˆ˜ ìˆ˜ì • (226ì¤„):**
```javascript
async function crawlSingleMonitoring(monitoring) {
  const startTime = Date.now();
  
  try {
    console.log(`\n[í¬ë¡¤ë§ ì‹œì‘] ${monitoring.place_name || monitoring.place_url}`);
    
    // 1. ë¦¬ë·° í¬ë¡¤ë§ (isFirstCrawl í”Œë˜ê·¸ ì „ë‹¬)
    const isFirstCrawl = monitoring.isFirstCrawl || false;
    const crawlResult = await crawlPlaceReviews(monitoring.place_url, isFirstCrawl);
    
    // ... ë‚˜ë¨¸ì§€ ë¡œì§
```

---

## Step 1-6: í¬ë¡¤ë§ ì²´í¬ë¦¬ìŠ¤íŠ¸

- [ ] `crawlPlaceReviews()` 4ì¢… í¬ë¡¤ë§ êµ¬í˜„
- [ ] `crawlVisitorReviews()` ë°©ë¬¸ì ë¦¬ë·°
- [ ] `crawlBlogReviews()` ë¸”ë¡œê·¸ ë¦¬ë·°
- [ ] `crawlReceiptReviews()` ì˜ìˆ˜ì¦ ë¦¬ë·°
- [ ] `crawlPlaceNews()` ìƒˆì†Œì‹
- [ ] `isFirstCrawl` íŒŒë¼ë¯¸í„° ì¶”ê°€
- [ ] `processNewReview()` skipAlert ì¶”ê°€
- [ ] ìµœì´ˆ í¬ë¡¤ë§ ì‹œì  ìˆ˜ì •
- [ ] ë¡œì»¬ í…ŒìŠ¤íŠ¸ (ì„ íƒ)
- [ ] Git ì»¤ë°‹
  ```bash
  git add api/review-monitoring.js
  git commit -m "feat: 4ì¢… í¬ë¡¤ë§ + 1ì°¨ í¬ë¡¤ë§ ë¡œì§ êµ¬í˜„

  - ë°©ë¬¸ì/ë¸”ë¡œê·¸/ì˜ìˆ˜ì¦/ìƒˆì†Œì‹ í¬ë¡¤ë§
  - isFirstCrawl í”Œë˜ê·¸ë¡œ ìµœì´ˆ í¬ë¡¤ë§ ì‹œ ì•Œë¦¼ ì•ˆ ë³´ëƒ„
  - ì‹¤íŒ¨í•´ë„ ë‹¤ë¥¸ í¬ë¡¤ë§ì€ ê³„ì† ì§„í–‰"
  ```

---

# Part 2: ë°œì†¡ íšŸìˆ˜ ì œí•œ ë¡œì§ ì¶”ê°€

## ğŸ“Œ ì‘ì—… ê°œìš”

**íŒŒì¼**: `api/kakao-alimtalk.js`  
**ëª©í‘œ**: ì•Œë¦¼ ë°œì†¡ ì „ì— 1ì¼ í•œë„ ì²´í¬

**ë¡œì§:**
1. ì˜¤ëŠ˜ ë°œì†¡ íšŸìˆ˜ í™•ì¸
2. ë‚ ì§œ ë°”ë€Œë©´ ì¹´ìš´íŠ¸ ì´ˆê¸°í™”
3. í•œë„ ì´ˆê³¼ ì‹œ ë°œì†¡ ì•ˆ í•¨
4. ë°œì†¡ ì„±ê³µ ì‹œ ì¹´ìš´íŠ¸ +1

---

## Step 2-1: ë°œì†¡ ì œí•œ ì²´í¬ í•¨ìˆ˜ ì¶”ê°€

**íŒŒì¼ ìˆ˜ì •**: `api/kakao-alimtalk.js` (ë§¨ ìœ„ì— ì¶”ê°€)

```javascript
const { createClient } = require('@supabase/supabase-js');

// Supabase í´ë¼ì´ì–¸íŠ¸
const supabase = createClient(
  process.env.NEXT_PUBLIC_SUPABASE_URL,
  process.env.SUPABASE_SERVICE_ROLE_KEY
);

/**
 * ë°œì†¡ ì œí•œ ì²´í¬ ë° ì¹´ìš´íŠ¸ ê´€ë¦¬
 * @returns {object} { canSend: boolean, reason: string }
 */
async function checkAndUpdateAlertLimit(userId) {
  try {
    // 1. í˜„ì¬ ì„¤ì • ì¡°íšŒ
    const { data: monitoring, error } = await supabase
      .from('review_monitoring')
      .select('daily_alert_limit, alert_count_today, last_alert_date')
      .eq('user_id', userId)
      .single();
    
    if (error || !monitoring) {
      console.log('[ë°œì†¡ ì œí•œ] ëª¨ë‹ˆí„°ë§ ì„¤ì • ì—†ìŒ');
      return { canSend: false, reason: 'no_monitoring' };
    }
    
    // 2. ë°œì†¡ ì œí•œì´ 0ì´ë©´ ì•Œë¦¼ ë„ê¸°
    if (monitoring.daily_alert_limit === 0) {
      console.log('[ë°œì†¡ ì œí•œ] ì•Œë¦¼ êº¼ì§ (limit=0)');
      return { canSend: false, reason: 'alert_disabled' };
    }
    
    // 3. ë‚ ì§œ ì²´í¬ (ìì • ì§€ë‚˜ë©´ ì´ˆê¸°í™”)
    const today = new Date().toISOString().split('T')[0];
    const lastDate = monitoring.last_alert_date 
      ? new Date(monitoring.last_alert_date).toISOString().split('T')[0]
      : null;
    
    let currentCount = monitoring.alert_count_today || 0;
    
    if (lastDate !== today) {
      // ë‚ ì§œ ë°”ë€œ â†’ ì´ˆê¸°í™”
      console.log('[ë°œì†¡ ì œí•œ] ë‚ ì§œ ë³€ê²½, ì¹´ìš´íŠ¸ ì´ˆê¸°í™”');
      currentCount = 0;
      
      await supabase
        .from('review_monitoring')
        .update({
          alert_count_today: 0,
          last_alert_date: today
        })
        .eq('user_id', userId);
    }
    
    // 4. í•œë„ ì²´í¬
    if (currentCount >= monitoring.daily_alert_limit) {
      console.log(`[ë°œì†¡ ì œí•œ] ì˜¤ëŠ˜ í•œë„ ì´ˆê³¼ (${currentCount}/${monitoring.daily_alert_limit})`);
      return { canSend: false, reason: 'daily_limit_exceeded' };
    }
    
    // 5. ë°œì†¡ ê°€ëŠ¥ â†’ ì¹´ìš´íŠ¸ +1
    console.log(`[ë°œì†¡ ì œí•œ] ë°œì†¡ ê°€ëŠ¥ (${currentCount + 1}/${monitoring.daily_alert_limit})`);
    
    await supabase
      .from('review_monitoring')
      .update({
        alert_count_today: currentCount + 1,
        last_alert_date: today
      })
      .eq('user_id', userId);
    
    return { canSend: true, reason: 'ok' };
    
  } catch (error) {
    console.error('[ë°œì†¡ ì œí•œ ì²´í¬ ì‹¤íŒ¨]', error);
    return { canSend: false, reason: 'error' };
  }
}
```

---

## Step 2-2: sendUrgentReviewAlert í•¨ìˆ˜ ìˆ˜ì •

**íŒŒì¼ ìˆ˜ì •**: `api/kakao-alimtalk.js` (137-181ì¤„)

**ê¸°ì¡´ í•¨ìˆ˜ ë§¨ ì•ì— ì¶”ê°€:**
```javascript
async function sendUrgentReviewAlert(userId, alertData) {
  try {
    console.log('[ì•Œë¦¼í†¡] ê¸´ê¸‰ ë¦¬ë·° ë°œì†¡ ì‹œë„:', alertData.id);
    
    // âœ… ë°œì†¡ ì œí•œ ì²´í¬ (ë§¨ ì•ì— ì¶”ê°€!)
    const limitCheck = await checkAndUpdateAlertLimit(userId);
    if (!limitCheck.canSend) {
      console.log(`[ì•Œë¦¼í†¡ ê±´ë„ˆëœ€] ${limitCheck.reason}`);
      return { success: false, reason: limitCheck.reason };
    }
    
    // ì‚¬ìš©ì ì „í™”ë²ˆí˜¸ ê°€ì ¸ì˜¤ê¸°
    const { data: profile, error } = await supabase
      .from('profiles')
      .select('phone_number')
      .eq('id', userId)
      .single();
    
    // ... ë‚˜ë¨¸ì§€ ì½”ë“œ ë™ì¼
```

---

## Step 2-3: sendHighRatingAlert í•¨ìˆ˜ ìˆ˜ì •

**íŒŒì¼ ìˆ˜ì •**: `api/kakao-alimtalk.js` (186-225ì¤„)

**ë˜‘ê°™ì´ ë§¨ ì•ì— ì¶”ê°€:**
```javascript
async function sendHighRatingAlert(userId, alertData) {
  try {
    console.log('[ì•Œë¦¼í†¡] ê³ í‰ì  ë¦¬ë·° ë°œì†¡ ì‹œë„:', alertData.id);
    
    // âœ… ë°œì†¡ ì œí•œ ì²´í¬
    const limitCheck = await checkAndUpdateAlertLimit(userId);
    if (!limitCheck.canSend) {
      console.log(`[ì•Œë¦¼í†¡ ê±´ë„ˆëœ€] ${limitCheck.reason}`);
      return { success: false, reason: limitCheck.reason };
    }
    
    // ... ë‚˜ë¨¸ì§€ ì½”ë“œ ë™ì¼
```

---

## Step 2-4: sendDailySummary í•¨ìˆ˜ ìˆ˜ì •

**íŒŒì¼ ìˆ˜ì •**: `api/kakao-alimtalk.js` (230-260ì¤„)

**âš ï¸ ì£¼ì˜**: ì¼ì¼ ìš”ì•½ì€ ë°œì†¡ ì œí•œì—ì„œ ì œì™¸í• ì§€ ê²°ì • í•„ìš”

**ì˜µì…˜ A: ì¼ì¼ ìš”ì•½ë„ ì œí•œ ì ìš©**
```javascript
async function sendDailySummary(userId, summaryData) {
  try {
    // ë°œì†¡ ì œí•œ ì²´í¬
    const limitCheck = await checkAndUpdateAlertLimit(userId);
    if (!limitCheck.canSend) {
      return { success: false, reason: limitCheck.reason };
    }
    // ...
```

**ì˜µì…˜ B: ì¼ì¼ ìš”ì•½ì€ ì œí•œ ì—†ìŒ (ì¶”ì²œ)**
```javascript
async function sendDailySummary(userId, summaryData) {
  try {
    // ë°œì†¡ ì œí•œ ì²´í¬ ì•ˆ í•¨ (ì¼ì¼ ìš”ì•½ì€ í•­ìƒ ë°œì†¡)
    console.log('[ì•Œë¦¼í†¡] ì¼ì¼ ìš”ì•½ ë°œì†¡ (ì œí•œ ì—†ìŒ)');
    // ...
```

---

## Step 2-5: ë°œì†¡ ì œí•œ ì²´í¬ë¦¬ìŠ¤íŠ¸

- [ ] `checkAndUpdateAlertLimit()` í•¨ìˆ˜ ì‘ì„±
- [ ] `sendUrgentReviewAlert()` ìˆ˜ì •
- [ ] `sendHighRatingAlert()` ìˆ˜ì •
- [ ] `sendDailySummary()` ì œí•œ ì—¬ë¶€ ê²°ì •
- [ ] Git ì»¤ë°‹
  ```bash
  git add api/kakao-alimtalk.js
  git commit -m "feat: ì•Œë¦¼í†¡ ë°œì†¡ íšŸìˆ˜ ì œí•œ ê¸°ëŠ¥ ì¶”ê°€

  - checkAndUpdateAlertLimit() í•¨ìˆ˜
  - ë‚ ì§œ ë³€ê²½ ì‹œ ìë™ ì´ˆê¸°í™”
  - 1ì¼ í•œë„ ì´ˆê³¼ ì‹œ ë°œì†¡ ì•ˆ í•¨
  - ë°œì†¡ ì„±ê³µ ì‹œ ì¹´ìš´íŠ¸ ìë™ ì¦ê°€"
  ```

---

# Part 3: ì–´ë“œë¯¼ ë°œì†¡ ì œì–´ UI ì¶”ê°€

## ğŸ“Œ ì‘ì—… ê°œìš”

**íŒŒì¼**: `admin/review-monitoring.html`  
**ëª©í‘œ**: íšŒì›ë³„ ë°œì†¡ íšŸìˆ˜ ì„¤ì • UI ì¶”ê°€

---

## Step 3-1: UI ì¶”ê°€

**íŒŒì¼ ìˆ˜ì •**: `admin/review-monitoring.html` (ì ë‹¹í•œ ìœ„ì¹˜ì— ì¶”ê°€)

**í…Œì´ë¸”ì— ì»¬ëŸ¼ ì¶”ê°€:**
```html
<!-- ê¸°ì¡´ í…Œì´ë¸” <thead> ìˆ˜ì • -->
<thead>
  <tr>
    <th>ì‚¬ìš©ì</th>
    <th>í”Œë ˆì´ìŠ¤</th>
    <th>ìƒíƒœ</th>
    <th>ë§ˆì§€ë§‰ í¬ë¡¤ë§</th>
    <th>ë°œì†¡ ì œí•œ</th> <!-- ì¶”ê°€! -->
    <th>ì˜¤ëŠ˜ ë°œì†¡</th> <!-- ì¶”ê°€! -->
    <th>ì‘ì—…</th>
  </tr>
</thead>
```

**í…Œì´ë¸” í–‰ ë Œë”ë§ ìˆ˜ì •:**
```javascript
// JavaScriptì—ì„œ í…Œì´ë¸” í–‰ ìƒì„± ë¶€ë¶„
function renderMonitoringRow(monitoring) {
  return `
    <tr>
      <td>${monitoring.user_email || monitoring.user_id}</td>
      <td>${monitoring.place_name || '-'}</td>
      <td>${monitoring.monitoring_enabled ? 'í™œì„±' : 'ë¹„í™œì„±'}</td>
      <td>${formatDate(monitoring.last_crawled_at)}</td>
      
      <!-- ë°œì†¡ ì œí•œ ì„¤ì • -->
      <td>
        <select 
          class="alert-limit-select" 
          data-user-id="${monitoring.user_id}"
          onchange="updateAlertLimit(this)"
        >
          <option value="0" ${monitoring.daily_alert_limit === 0 ? 'selected' : ''}>
            ì•Œë¦¼ ë„ê¸°
          </option>
          <option value="1" ${monitoring.daily_alert_limit === 1 ? 'selected' : ''}>
            1ì¼ 1íšŒ
          </option>
          <option value="2" ${monitoring.daily_alert_limit === 2 ? 'selected' : ''}>
            1ì¼ 2íšŒ
          </option>
        </select>
      </td>
      
      <!-- ì˜¤ëŠ˜ ë°œì†¡ íšŸìˆ˜ -->
      <td>
        <span class="alert-count">
          ${monitoring.alert_count_today || 0} / ${monitoring.daily_alert_limit}
        </span>
      </td>
      
      <td>
        <button onclick="manualCrawl('${monitoring.id}')">í¬ë¡¤ë§</button>
      </td>
    </tr>
  `;
}
```

---

## Step 3-2: JavaScript í•¨ìˆ˜ ì¶”ê°€

**íŒŒì¼ ìˆ˜ì •**: `admin/review-monitoring.html` (ìŠ¤í¬ë¦½íŠ¸ ì„¹ì…˜)

```javascript
/**
 * ë°œì†¡ ì œí•œ ì„¤ì • ì—…ë°ì´íŠ¸
 */
async function updateAlertLimit(selectElement) {
  const userId = selectElement.dataset.userId;
  const newLimit = parseInt(selectElement.value);
  
  if (!confirm(`ë°œì†¡ ì œí•œì„ ${newLimit === 0 ? 'ì•Œë¦¼ ë„ê¸°' : `1ì¼ ${newLimit}íšŒ`}ë¡œ ë³€ê²½í•˜ì‹œê² ìŠµë‹ˆê¹Œ?`)) {
    return;
  }
  
  try {
    // Supabase ì—…ë°ì´íŠ¸
    const { error } = await supabase
      .from('review_monitoring')
      .update({
        daily_alert_limit: newLimit
      })
      .eq('user_id', userId);
    
    if (error) throw error;
    
    alert('âœ… ë°œì†¡ ì œí•œì´ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤!');
    
    // í…Œì´ë¸” ìƒˆë¡œê³ ì¹¨
    loadMonitoringList();
    
  } catch (error) {
    console.error('ë°œì†¡ ì œí•œ ë³€ê²½ ì‹¤íŒ¨:', error);
    alert('âŒ ë³€ê²½ ì‹¤íŒ¨: ' + error.message);
  }
}

/**
 * ëª¨ë‹ˆí„°ë§ ëª©ë¡ ë¡œë“œ (ê¸°ì¡´ í•¨ìˆ˜ ìˆ˜ì •)
 */
async function loadMonitoringList() {
  try {
    // âš ï¸ SELECTì— ìƒˆ ì»¬ëŸ¼ 3ê°œ ì¶”ê°€!
    const { data, error } = await supabase
      .from('review_monitoring')
      .select(`
        *,
        daily_alert_limit,
        alert_count_today,
        last_alert_date
      `)
      .order('created_at', { ascending: false });
    
    if (error) throw error;
    
    // í…Œì´ë¸” ë Œë”ë§
    const tbody = document.getElementById('monitoringTableBody');
    tbody.innerHTML = data.map(m => renderMonitoringRow(m)).join('');
    
  } catch (error) {
    console.error('ëª©ë¡ ë¡œë“œ ì‹¤íŒ¨:', error);
  }
}
```

---

## Step 3-3: CSS ìŠ¤íƒ€ì¼ ì¶”ê°€

**íŒŒì¼ ìˆ˜ì •**: `admin/review-monitoring.html` (ìŠ¤íƒ€ì¼ ì„¹ì…˜)

```css
/* ë°œì†¡ ì œí•œ ì…€ë ‰íŠ¸ */
.alert-limit-select {
  padding: 6px 10px;
  border: 1px solid #ddd;
  border-radius: 4px;
  font-size: 14px;
  cursor: pointer;
}

.alert-limit-select:hover {
  border-color: #03c75a;
}

/* ì˜¤ëŠ˜ ë°œì†¡ íšŸìˆ˜ */
.alert-count {
  padding: 4px 8px;
  background: #f0f0f0;
  border-radius: 4px;
  font-size: 13px;
  font-weight: 500;
}
```

---

## Step 3-4: ì–´ë“œë¯¼ UI ì²´í¬ë¦¬ìŠ¤íŠ¸

- [ ] í…Œì´ë¸”ì— "ë°œì†¡ ì œí•œ" ì»¬ëŸ¼ ì¶”ê°€
- [ ] í…Œì´ë¸”ì— "ì˜¤ëŠ˜ ë°œì†¡" ì»¬ëŸ¼ ì¶”ê°€
- [ ] ë°œì†¡ ì œí•œ ì…€ë ‰íŠ¸ ë°•ìŠ¤ ì¶”ê°€
- [ ] `updateAlertLimit()` í•¨ìˆ˜ ì‘ì„±
- [ ] `loadMonitoringList()` SELECT ìˆ˜ì •
- [ ] CSS ìŠ¤íƒ€ì¼ ì¶”ê°€
- [ ] Git ì»¤ë°‹
  ```bash
  git add admin/review-monitoring.html
  git commit -m "feat: ì–´ë“œë¯¼ ë°œì†¡ ì œì–´ UI ì¶”ê°€

  - íšŒì›ë³„ ë°œì†¡ ì œí•œ ì„¤ì • (0/1/2íšŒ)
  - ì˜¤ëŠ˜ ë°œì†¡ íšŸìˆ˜ í‘œì‹œ
  - ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸"
  ```

---

# ğŸ§ª í†µí•© í…ŒìŠ¤íŠ¸ í”Œë¡œìš°

## Test 1: íšŒì› ë“±ë¡ ì‹œ 1ì°¨ í¬ë¡¤ë§

```
1. ë§ˆì´í˜ì´ì§€ ì ‘ì†
2. í”Œë ˆì´ìŠ¤ URL ì…ë ¥
   ì˜ˆ: https://m.place.naver.com/restaurant/1390003666
3. "ì €ì¥" í´ë¦­
4. [ì˜ˆìƒ] ë°±ê·¸ë¼ìš´ë“œì—ì„œ í¬ë¡¤ë§ ì‹œì‘
5. [ì˜ˆìƒ] DBì— ë¦¬ë·° ì €ì¥ë¨ (ì•Œë¦¼ ì•ˆ ì˜´!)
6. [í™•ì¸] Supabase â†’ review_alerts í…Œì´ë¸” í™•ì¸
```

---

## Test 2: ì •ê¸° í¬ë¡¤ë§ ë° ì•Œë¦¼

```
1. ì–´ë“œë¯¼ í˜ì´ì§€ ì ‘ì†
2. "ìˆ˜ë™ í¬ë¡¤ë§ ì‹¤í–‰" í´ë¦­
3. [ì˜ˆìƒ] ìƒˆ ë¦¬ë·°ë§Œ ìˆ˜ì§‘
4. [ì˜ˆìƒ] ì €í‰ì /ê³ í‰ì  ë¦¬ë·°ì— ì•Œë¦¼ ë°œì†¡
5. [í™•ì¸] ì¹´ì¹´ì˜¤í†¡ ìˆ˜ì‹  í™•ì¸
6. [í™•ì¸] ì˜¤ëŠ˜ ë°œì†¡ íšŸìˆ˜ ì¦ê°€
```

---

## Test 3: ë°œì†¡ ì œí•œ í…ŒìŠ¤íŠ¸

```
1. ì–´ë“œë¯¼ì—ì„œ íŠ¹ì • íšŒì› "1ì¼ 1íšŒ"ë¡œ ì„¤ì •
2. ìˆ˜ë™ í¬ë¡¤ë§ ì‹¤í–‰ â†’ ì•Œë¦¼ 1ê°œ ë°œì†¡
3. [ì˜ˆìƒ] alert_count_today = 1
4. ë‹¤ì‹œ í¬ë¡¤ë§ ì‹¤í–‰ â†’ ìƒˆ ë¦¬ë·° ìˆì–´ë„ ì•Œë¦¼ ì•ˆ ì˜´
5. [ë¡œê·¸ í™•ì¸] "ì˜¤ëŠ˜ í•œë„ ì´ˆê³¼" ë©”ì‹œì§€
6. ë‹¤ìŒë‚  00:00 ì´í›„ â†’ ìë™ ì´ˆê¸°í™”
```

---

# ğŸ“Š ì™„ë£Œ ì²´í¬ë¦¬ìŠ¤íŠ¸

## Part 0: DB ìŠ¤í‚¤ë§ˆ
- [ ] SQL íŒŒì¼ ìƒì„±
- [ ] Supabaseì— ì‹¤í–‰
- [ ] ì»¬ëŸ¼ 3ê°œ í™•ì¸
- [ ] Git ì»¤ë°‹

## Part 1: í¬ë¡¤ë§
- [ ] 4ì¢… í¬ë¡¤ë§ í•¨ìˆ˜ ì‘ì„±
- [ ] isFirstCrawl ë¡œì§ ì¶”ê°€
- [ ] processNewReview skipAlert ì¶”ê°€
- [ ] ìµœì´ˆ í¬ë¡¤ë§ ì‹¤í–‰ ìˆ˜ì •
- [ ] Git ì»¤ë°‹

## Part 2: ë°œì†¡ ì œí•œ
- [ ] checkAndUpdateAlertLimit í•¨ìˆ˜
- [ ] sendUrgentReviewAlert ìˆ˜ì •
- [ ] sendHighRatingAlert ìˆ˜ì •
- [ ] sendDailySummary ê²°ì •
- [ ] Git ì»¤ë°‹

## Part 3: ì–´ë“œë¯¼ UI
- [ ] í…Œì´ë¸” ì»¬ëŸ¼ ì¶”ê°€
- [ ] ë°œì†¡ ì œí•œ ì…€ë ‰íŠ¸
- [ ] updateAlertLimit í•¨ìˆ˜
- [ ] CSS ìŠ¤íƒ€ì¼
- [ ] Git ì»¤ë°‹

## í†µí•© í…ŒìŠ¤íŠ¸
- [ ] 1ì°¨ í¬ë¡¤ë§ í…ŒìŠ¤íŠ¸
- [ ] ì •ê¸° í¬ë¡¤ë§ í…ŒìŠ¤íŠ¸
- [ ] ë°œì†¡ ì œí•œ í…ŒìŠ¤íŠ¸
- [ ] ì¹´ì¹´ì˜¤í†¡ ì•Œë¦¼ ìˆ˜ì‹ 
- [ ] Cron ìë™ ì‹¤í–‰ í™•ì¸

---

# ğŸ”— ê´€ë ¨ íŒŒì¼ ìœ„ì¹˜

```
database/schemas/features/review/
â”œâ”€â”€ review-monitoring.sql (ê¸°ì¡´)
â””â”€â”€ review-monitoring-update.sql (ì‹ ê·œ) â† Part 0

api/
â”œâ”€â”€ review-monitoring.js â† Part 1 (í¬ë¡¤ë§)
â””â”€â”€ kakao-alimtalk.js â† Part 2 (ë°œì†¡ ì œí•œ)

admin/
â””â”€â”€ review-monitoring.html â† Part 3 (UI)
```

---

# âš ï¸ ì¤‘ìš” ì£¼ì˜ì‚¬í•­ (AI í•„ë…!)

## 1. Puppeteer ì„¤ì¹˜ ë¶ˆí•„ìš”
- ì´ë¯¸ `package.json`ì— ìˆìŒ
- ì¶”ê°€ ì„¤ì¹˜ ëª…ë ¹ ì‹¤í–‰í•˜ì§€ ë§ˆì„¸ìš”

## 2. ì…€ë ‰í„° ë³€ê²½ ê°€ëŠ¥ì„±
- ë„¤ì´ë²„ í”Œë ˆì´ìŠ¤ HTML êµ¬ì¡°ê°€ ìì£¼ ë°”ë€œ
- í¬ë¡¤ë§ ì‹¤íŒ¨ ì‹œ ì…€ë ‰í„° ì—…ë°ì´íŠ¸ í•„ìš”
- ê°œë°œì ë„êµ¬ë¡œ ìµœì‹  êµ¬ì¡° í™•ì¸

## 3. ë°œì†¡ ì œí•œ ë¡œì§ ìˆœì„œ
- ë°˜ë“œì‹œ checkAndUpdateAlertLimit ë¨¼ì € í˜¸ì¶œ
- ì „í™”ë²ˆí˜¸ ì¡°íšŒë³´ë‹¤ ë¨¼ì € ì²´í¬í•´ì•¼ í•¨
- ìˆœì„œ ë°”ë€Œë©´ ì¹´ìš´íŠ¸ê°€ ì˜ëª» ì¦ê°€í•¨

## 4. 1ì°¨ í¬ë¡¤ë§ í”Œë˜ê·¸
- isFirstCrawlì€ monitoring ê°ì²´ì—ë§Œ ì¶”ê°€
- DBì— ì €ì¥í•˜ì§€ ì•ŠìŒ (ì„ì‹œ í”Œë˜ê·¸)
- crawlSingleMonitoring í•¨ìˆ˜ ë‚´ë¶€ì—ì„œë§Œ ì‚¬ìš©

## 5. ë‚ ì§œ ì´ˆê¸°í™” íƒ€ì´ë°
- last_alert_dateëŠ” ë‚ ì§œë§Œ ë¹„êµ (ì‹œê°„ ì œì™¸)
- toISOString().split('T')[0] ì‚¬ìš©
- ìì • ê¸°ì¤€ìœ¼ë¡œ ìë™ ì´ˆê¸°í™”ë¨

---

**ì‘ì„±ì¼**: 2025-10-30  
**ìµœì¢… ìˆ˜ì •**: 2025-10-30  
**ì‘ì„±ì**: ì‹¤ì œ ìš”êµ¬ì‚¬í•­ ë°˜ì˜ ì™„ë£Œ  
**AI**: ì´ ê°€ì´ë“œë¥¼ ìˆœì„œëŒ€ë¡œ ë”°ë¼í•˜ì„¸ìš”. ëª¨ë“  í•¨ì • í¬ì¸íŠ¸ê°€ í‘œì‹œë˜ì–´ ìˆìŠµë‹ˆë‹¤.
